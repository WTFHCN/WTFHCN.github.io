<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>NaCNer</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2020-11-29T10:20:12.169Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>HCN</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>About me</title>
    <link href="http://yoursite.com/2021/12/31/%E6%9D%BF%E5%AD%90/"/>
    <id>http://yoursite.com/2021/12/31/%E6%9D%BF%E5%AD%90/</id>
    <published>2021-12-31T02:47:00.000Z</published>
    <updated>2020-11-29T10:20:12.169Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://cfrating.ihcr.top/?user=WaluntOvO" alt=""></p><p><img src="https://cfrating.ihcr.top/?user=NaCNerer" alt=""></p><p><img src="https://cfrating.ihcr.top/?user=misakicoca" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;https://cfrating.ihcr.top/?user=WaluntOvO&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://cfrating.ihcr.top/?user=NaCNerer&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;i
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>æ•°å­¦å…¬å¼</title>
    <link href="http://yoursite.com/2020/12/31/%E4%B8%80%E4%BA%9B%E6%95%B0%E5%AD%A6%E5%85%AC%E5%BC%8F/"/>
    <id>http://yoursite.com/2020/12/31/%E4%B8%80%E4%BA%9B%E6%95%B0%E5%AD%A6%E5%85%AC%E5%BC%8F/</id>
    <published>2020-12-31T02:47:00.000Z</published>
    <updated>2020-11-01T08:12:25.743Z</updated>
    
    <content type="html"><![CDATA[<p>å¿˜è®°å¤ªå¤šäº†..<br><a id="more"></a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¿˜è®°å¤ªå¤šäº†..&lt;br&gt;
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>è®­ç»ƒè®°å½•</title>
    <link href="http://yoursite.com/2020/12/31/%E8%AE%AD%E7%BB%83%E8%AE%B0%E5%BD%95/"/>
    <id>http://yoursite.com/2020/12/31/%E8%AE%AD%E7%BB%83%E8%AE%B0%E5%BD%95/</id>
    <published>2020-12-31T02:47:00.000Z</published>
    <updated>2020-11-12T14:12:08.159Z</updated>
    
    <content type="html"><![CDATA[<p><details><br>  <summary>è„‘ç˜«é—®é¢˜é¦–å‘</summary></p><ul><li>$s.earse(åœ°å€)$</li><li>é€’å½’æ˜¯ç”¨å…¨å±€$vetor$</li><li>çº¿æ®µæ ‘$if(!tag[pos])$</li><li>å¯æ’¤é”€å¹¶æŸ¥é›†å¯ä»¥é‡‡ç”¨<strong>ä¿æŒåˆå¹¶å‰æ‰€æœ‰ä¿¡æ¯</strong></li><li>å¤šé¡¹å¼ $å¦‚æœ while(ML&lt;n+m-1)$ ,$n,mä¸ºé¡¹æ•°$ï¼Œå¦‚æœ$ML\leq n+m$<br>$n,m$ä¸ºæœ€é«˜é¡¹ç³»æ•°ï¼Œ$sqrt,Invâ€¦.$ç­‰å€’å…¥çš„æ˜¯é¡¹æ•°ï¼ˆæœ‰å¤šå°‘é¡¹ï¼‰ã€‚</li><li>å¤šé¡¹å¼åˆå¹¶æ—¶æ³¨æ„é™åˆ¶é¡¹æ•°ã€‚</li><li>çº¿æ®µæ ‘æ³¨æ„$lazy$çš„åˆå§‹åŒ–</li><li>å…¬å¼åŒ–çš„ç¦»æ•£åŒ–çº¿æ®µå˜æˆå·¦å¼€å³é—­  </li><li>ç›´å¾„çœ‹æ¸…æ¥šæ˜¯å¦éœ€è¦$-1$</li><li>è™šæ ‘æ³¨æ„æ¸…ç©ºè¯¥æ¸…ç©ºçš„</li><li>å¤šç»´$dp$è½¬ç§»æ³¨æ„è¾¹ç•Œ</li><li>åç¼€æ ‘ä¸Š$lcp(i,j)=len(lca(i,j))$</li><li>å…¨æ’åˆ—äºŒé¡¹å¼å®šç†ï¼Œä¹Ÿè¦è€ƒè™‘å•ç‹¬æ¦‚ç‡è€ƒè™‘</li><li>éšæœºåŒ–ä½¿ç”¨std::mt19937 rnd(std::chrono::steady_clock::now().time_since_epoch().count())</li><li>æ ‘é“¾å‰–åˆ†æ³¨æ„$top[rt]$ï¼Œæ³¨æ„$w[dfn[x]]$</li><li>$KruskalTreeé‡æ„æ ‘$å¼€ä¸¤å€ç©ºé—´ã€‚</li><li>è´Ÿæ•°å‘ä¸‹å–æ•´$&gt;&gt;1$</li><li>$KruskalTreeé‡æ„æ ‘$æ˜¯ç‰¹èƒ–å¶å­èŠ‚ç‚¹$g[x].size()\leq 1$!!,å¯ä»¥å‡å°‘ç‰¹èƒ–</li><li>å­—å…¸åºè¡¨ç¤ºå…ˆå­—æ¯å¤§å°å†é•¿åº¦</li><li>äºŒåˆ†å›¾çš„æœ€å¤§å›¢=è¡¥å›¾çš„æœ€å¤§ç‹¬ç«‹é›†ã€‚ï¼Œæœ€å¤§ç‹¬ç«‹é›†=æ‰€æœ‰é¡¶ç‚¹æ•°-æœ€å°é¡¶ç‚¹è¦†ç›–ï¼Œæœ€å°é¡¶ç‚¹è¦†ç›–ç­‰äºäºŒåˆ†å›¾çš„æœ€å¤§åŒ¹é…ã€‚</li><li>Boruvkaç®—æ³•å¿«ã€‚</li><li>æè¶…çº¿æ®µæ ‘$\max,\min$ é‡Œé¢éƒ½è¦ä»”ç»†æ”¹</li><li>ç‚¹åˆ†æ²»çš„æ—¶å€™è®°ä½æƒ…å†µåº”è¯¥æ¸…ç©ºçš„æ•°æ®ç»“æ„ï¼Œè¦è®°ä½æœ‰$a[rt]$è¿™ä¸ªç‚¹ä¹Ÿè¦åŠ å…¥ã€‚</li></ul><details><a id="more"></a><h3 id="ç‰›å®¢å¤šæ ¡"><a href="#ç‰›å®¢å¤šæ ¡" class="headerlink" title="ç‰›å®¢å¤šæ ¡"></a>ç‰›å®¢å¤šæ ¡</h3><ul><li><a href="https://ac.nowcoder.com/acm/contest/5666" target="_blank" rel="noopener">2020ç‰›å®¢æš‘æœŸå¤šæ ¡è®­ç»ƒè¥ï¼ˆç¬¬ä¸€åœºï¼‰</a>  $solve(2/10)$,$upsolve(2/10)$</li><li><a href="https://ac.nowcoder.com/acm/contest/5667" target="_blank" rel="noopener">2020ç‰›å®¢æš‘æœŸå¤šæ ¡è®­ç»ƒè¥ï¼ˆç¬¬äºŒåœºï¼‰</a> $solve(1/11)$,$upsolve(9/11)$</li><li><a href="https://ac.nowcoder.com/acm/contest/5668" target="_blank" rel="noopener">2020ç‰›å®¢æš‘æœŸå¤šæ ¡è®­ç»ƒè¥ï¼ˆç¬¬ä¸‰åœºï¼‰</a> $solve(5/12)$,$upsolve(9/12)$</li><li><a href="https://ac.nowcoder.com/acm/contest/5669" target="_blank" rel="noopener">2020ç‰›å®¢æš‘æœŸå¤šæ ¡è®­ç»ƒè¥ï¼ˆç¬¬å››åœºï¼‰</a> $solve(3/10)$,$upsolve(4/10)$</li><li><a href="https://ac.nowcoder.com/acm/contest/5670" target="_blank" rel="noopener">2020ç‰›å®¢æš‘æœŸå¤šæ ¡è®­ç»ƒè¥ï¼ˆç¬¬äº”åœºï¼‰</a> $solve(4/11)$,$upsolve(8/10)$</li><li><a href="https://ac.nowcoder.com/acm/contest/5671" target="_blank" rel="noopener">2020ç‰›å®¢æš‘æœŸå¤šæ ¡è®­ç»ƒè¥ï¼ˆç¬¬å…­åœºï¼‰</a> $solve(2/11)$,$upsolve(6/11)$</li><li><a href="https://ac.nowcoder.com/acm/contest/5672" target="_blank" rel="noopener">2020ç‰›å®¢æš‘æœŸå¤šæ ¡è®­ç»ƒè¥ï¼ˆç¬¬ä¸ƒåœºï¼‰</a> </li><li><a href="https://ac.nowcoder.com/acm/contest/5673" target="_blank" rel="noopener">2020ç‰›å®¢æš‘æœŸå¤šæ ¡è®­ç»ƒè¥ï¼ˆç¬¬å…«åœºï¼‰</a> $solve(3/11)$,$upsolve(5/11)$</li><li><a href="https://ac.nowcoder.com/acm/contest/5673" target="_blank" rel="noopener">2020ç‰›å®¢æš‘æœŸå¤šæ ¡è®­ç»ƒè¥ï¼ˆç¬¬ä¹åœºï¼‰</a> $solve(3/11)$,$upsolve(10/12)$</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;details&gt;&lt;br&gt;  &lt;summary&gt;è„‘ç˜«é—®é¢˜é¦–å‘&lt;/summary&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$s.earse(åœ°å€)$&lt;/li&gt;
&lt;li&gt;é€’å½’æ˜¯ç”¨å…¨å±€$vetor$&lt;/li&gt;
&lt;li&gt;çº¿æ®µæ ‘$if(!tag[pos])$&lt;/li&gt;
&lt;li&gt;å¯æ’¤é”€å¹¶æŸ¥é›†å¯ä»¥é‡‡ç”¨&lt;strong&gt;ä¿æŒåˆå¹¶å‰æ‰€æœ‰ä¿¡æ¯&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;å¤šé¡¹å¼ $å¦‚æœ while(ML&amp;lt;n+m-1)$ ,$n,mä¸ºé¡¹æ•°$ï¼Œå¦‚æœ$ML\leq n+m$&lt;br&gt;$n,m$ä¸ºæœ€é«˜é¡¹ç³»æ•°ï¼Œ$sqrt,Invâ€¦.$ç­‰å€’å…¥çš„æ˜¯é¡¹æ•°ï¼ˆæœ‰å¤šå°‘é¡¹ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¤šé¡¹å¼åˆå¹¶æ—¶æ³¨æ„é™åˆ¶é¡¹æ•°ã€‚&lt;/li&gt;
&lt;li&gt;çº¿æ®µæ ‘æ³¨æ„$lazy$çš„åˆå§‹åŒ–&lt;/li&gt;
&lt;li&gt;å…¬å¼åŒ–çš„ç¦»æ•£åŒ–çº¿æ®µå˜æˆå·¦å¼€å³é—­  &lt;/li&gt;
&lt;li&gt;ç›´å¾„çœ‹æ¸…æ¥šæ˜¯å¦éœ€è¦$-1$&lt;/li&gt;
&lt;li&gt;è™šæ ‘æ³¨æ„æ¸…ç©ºè¯¥æ¸…ç©ºçš„&lt;/li&gt;
&lt;li&gt;å¤šç»´$dp$è½¬ç§»æ³¨æ„è¾¹ç•Œ&lt;/li&gt;
&lt;li&gt;åç¼€æ ‘ä¸Š$lcp(i,j)=len(lca(i,j))$&lt;/li&gt;
&lt;li&gt;å…¨æ’åˆ—äºŒé¡¹å¼å®šç†ï¼Œä¹Ÿè¦è€ƒè™‘å•ç‹¬æ¦‚ç‡è€ƒè™‘&lt;/li&gt;
&lt;li&gt;éšæœºåŒ–ä½¿ç”¨std::mt19937 rnd(std::chrono::steady_clock::now().time_since_epoch().count())&lt;/li&gt;
&lt;li&gt;æ ‘é“¾å‰–åˆ†æ³¨æ„$top[rt]$ï¼Œæ³¨æ„$w[dfn[x]]$&lt;/li&gt;
&lt;li&gt;$KruskalTreeé‡æ„æ ‘$å¼€ä¸¤å€ç©ºé—´ã€‚&lt;/li&gt;
&lt;li&gt;è´Ÿæ•°å‘ä¸‹å–æ•´$&amp;gt;&amp;gt;1$&lt;/li&gt;
&lt;li&gt;$KruskalTreeé‡æ„æ ‘$æ˜¯ç‰¹èƒ–å¶å­èŠ‚ç‚¹$g[x].size()\leq 1$!!,å¯ä»¥å‡å°‘ç‰¹èƒ–&lt;/li&gt;
&lt;li&gt;å­—å…¸åºè¡¨ç¤ºå…ˆå­—æ¯å¤§å°å†é•¿åº¦&lt;/li&gt;
&lt;li&gt;äºŒåˆ†å›¾çš„æœ€å¤§å›¢=è¡¥å›¾çš„æœ€å¤§ç‹¬ç«‹é›†ã€‚ï¼Œæœ€å¤§ç‹¬ç«‹é›†=æ‰€æœ‰é¡¶ç‚¹æ•°-æœ€å°é¡¶ç‚¹è¦†ç›–ï¼Œæœ€å°é¡¶ç‚¹è¦†ç›–ç­‰äºäºŒåˆ†å›¾çš„æœ€å¤§åŒ¹é…ã€‚&lt;/li&gt;
&lt;li&gt;Boruvkaç®—æ³•å¿«ã€‚&lt;/li&gt;
&lt;li&gt;æè¶…çº¿æ®µæ ‘$\max,\min$ é‡Œé¢éƒ½è¦ä»”ç»†æ”¹&lt;/li&gt;
&lt;li&gt;ç‚¹åˆ†æ²»çš„æ—¶å€™è®°ä½æƒ…å†µåº”è¯¥æ¸…ç©ºçš„æ•°æ®ç»“æ„ï¼Œè¦è®°ä½æœ‰$a[rt]$è¿™ä¸ªç‚¹ä¹Ÿè¦åŠ å…¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>ä¹±ä¸ƒå…«ç³Ÿé¢˜è§£</title>
    <link href="http://yoursite.com/2020/12/31/%E4%B9%B1%E4%B8%83%E5%85%AB%E7%B3%9F%E9%A2%98%E8%A7%A3/"/>
    <id>http://yoursite.com/2020/12/31/%E4%B9%B1%E4%B8%83%E5%85%AB%E7%B3%9F%E9%A2%98%E8%A7%A3/</id>
    <published>2020-12-31T02:47:00.000Z</published>
    <updated>2020-12-06T04:13:07.625Z</updated>
    
    <content type="html"><![CDATA[<p>é¸½å­çš„é¢˜è§£å¤ªå¤šäº†ã€‚åªå¥½ç›´æ¥å†™ã€‚<br><!-- TOC --></p><ul><li><a href="#gym">GYM</a><ul><li><a href="#2019-ccpc-å“ˆå°”æ»¨">2019-CCPC-å“ˆå°”æ»¨</a><ul><li><a href="#b-binary-numbers">B. Binary Numbers</a></li><li><a href="#e-exchanging-gifts">E. Exchanging Gifts</a></li><li><a href="#i-interesting-permutation">I. Interesting Permutation</a></li><li><a href="#l-lru-algorithm">L. LRU Algorithm</a></li></ul></li><li><a href="#300iq-contest-1">300iq Contest 1</a><ul><li><a href="#bbest-subsequence">B.Best Subsequence</a></li><li><a href="#ccool-pairs">C.Cool Pairs</a></li><li><a href="#d-dates">D. Dates</a></li><li><a href="#f-free-edges">F. Free Edges</a></li><li><a href="#k-knowledge">K. Knowledge</a></li></ul></li><li><a href="#icpc-asia-east-continent-final">ICPC Asia-East Continent Final</a><ul><li><a href="#hking">H.King</a></li></ul></li></ul></li><li><a href="#é›…ç¤¼é›†è®­">é›…ç¤¼é›†è®­</a><ul><li><a href="#loj6029-é›…ç¤¼é›†è®­-2017-day1å¸‚åœº">LOJ6029. ã€Œé›…ç¤¼é›†è®­ 2017 Day1ã€å¸‚åœº</a></li><li><a href="#loj6030-é›…ç¤¼é›†è®­-2017-day1çŸ©é˜µ">LOJ6030. ã€Œé›…ç¤¼é›†è®­ 2017 Day1ã€çŸ©é˜µ</a></li><li><a href="#loj6031-é›…ç¤¼é›†è®­-2017-day1å­—ç¬¦ä¸²">LOJ6031. ã€Œé›…ç¤¼é›†è®­ 2017 Day1ã€å­—ç¬¦ä¸²</a></li><li><a href="#loj6032-é›…ç¤¼é›†è®­-2017-day2æ°´ç®±">LOJ6032. ã€Œé›…ç¤¼é›†è®­ 2017 Day2ã€æ°´ç®±</a></li><li><a href="#loj6033-é›…ç¤¼é›†è®­-2017-day2æ£‹ç›˜æ¸¸æˆ">LOJ6033. ã€Œé›…ç¤¼é›†è®­ 2017 Day2ã€æ£‹ç›˜æ¸¸æˆ</a></li><li><a href="#loj6034-é›…ç¤¼é›†è®­-2017-day2çº¿æ®µæ¸¸æˆ">LOJ6034. ã€Œé›…ç¤¼é›†è®­ 2017 Day2ã€çº¿æ®µæ¸¸æˆ</a></li><li><a href="#loj6035-é›…ç¤¼é›†è®­-2017-day4æ´—è¡£æœ">LOJ6035. ã€Œé›…ç¤¼é›†è®­ 2017 Day4ã€æ´—è¡£æœ</a></li><li><a href="#loj6036-é›…ç¤¼é›†è®­-2017-day4ç¼–ç ">LOJ6036. ã€Œé›…ç¤¼é›†è®­ 2017 Day4ã€ç¼–ç </a></li></ul></li><li><a href="#codeforces">Codeforces</a><ul><li><a href="#cf1358f-tasty-cookie">CF1358F Tasty Cookie</a></li><li><a href="#cf1367f2-flying-sort-hard-version">CF1367F2 Flying Sort (Hard Version)</a></li><li><a href="#cf1368e-ski-accidents">CF1368E Ski Accidents</a></li><li><a href="#cf1374e2-reading-books-hard-version">CF1374E2 Reading Books (hard version)</a></li><li><a href="#cf1380g-circular-dungeon">CF1380G Circular Dungeon</a></li><li><a href="#cf1384d-gamegame">CF1384D. GameGame</a></li><li><a href="#cf1387b1-village-minimum">CF1387B1 Village (Minimum)</a></li><li><a href="#cf1387b2-village-maximum">CF1387B2 Village (Maximum)</a></li><li><a href="#cf1399e2-weights-division-hard-version">CF1399E2 Weights Division (hard version)</a></li><li><a href="#cf1354c2-not-so-simple-polygon-embedding">CF1354C2. Not So Simple Polygon Embedding</a></li><li><a href="#cf1354f-summoning-minions">CF1354F. Summoning Minions</a></li><li><a href="#cf1354g-find-a-gift">CF1354G. Find a Gift</a></li><li><a href="#cf1421e-swedish-heroes">CF1421E. Swedish Heroes</a></li><li><a href="#cf1353f-decreasing-heights">CF1353F. Decreasing Heights</a></li><li><a href="#cf1353e-k-periodic-garland">CF1353E. K-periodic Garland</a></li><li><a href="#cf1427e--xum">CF1427E . Xum</a></li><li><a href="#cf1344drÃ©sumÃ©-review">CF1344D.RÃ©sumÃ© Review</a></li><li><a href="#cf1344c-quantifier-question">CF1344C Quantifier Question</a></li><li><a href="#cf1363f-rotating-substrings">CF1363F Rotating Substrings</a></li><li><a href="#cf1408e-avoid-rainbow-cycles">CF1408E Avoid Rainbow Cycles</a></li><li><a href="#cf1408f-two-different">CF1408F Two Different</a></li><li><a href="#cf1422f-boring-queries">CF1422F Boring Queries</a></li><li><a href="#cf1437g---death-dbms">CF1437G - Death DBMS</a></li><li><a href="#cf1436f-sum-over-subsets">CF1436F. Sum Over Subsets</a></li><li><a href="#cf1443f---identify-the-operations">CF1443F - Identify the Operations</a></li><li><a href="#cf1443e---long-permutation">CF1443E - Long Permutation</a></li><li><a href="#cf19d">CF19D</a></li><li><a href="#cf204e-little-elephant-and-strings">CF204E Little Elephant and Strings</a></li></ul></li><li><a href="#æ´›è°·">æ´›è°·</a><ul><li><a href="#p4103-heoi2014å¤§å·¥ç¨‹">P4103 [HEOI2014]å¤§å·¥ç¨‹</a></li><li><a href="#p5504-jsoi2011æŸ æª¬">P5504 [JSOI2011]æŸ æª¬</a></li></ul></li><li><a href="#atcoder">Atcoder</a><ul><li><a href="#atcoder-grand-contest-048">AtCoder Grand Contest 048</a></li><li><a href="#acl-beginner-contest">ACL Beginner Contest</a><ul><li><a href="#f---heights-and-pairs">F - Heights and Pairs</a></li></ul></li></ul></li><li><a href="#ç‰›å®¢">ç‰›å®¢</a><ul><li><a href="#icpcå°ç±³é‚€è¯·èµ›2">ICPCå°ç±³é‚€è¯·èµ›2</a><ul><li><a href="#a2020">A.2020</a></li><li><a href="#isubsequence-pair">I.Subsequence Pair</a></li></ul></li></ul></li></ul><!-- /TOC --><a id="more"></a><h1 id="GYM"><a href="#GYM" class="headerlink" title="GYM"></a>GYM</h1><h2 id="2019-CCPC-å“ˆå°”æ»¨"><a href="#2019-CCPC-å“ˆå°”æ»¨" class="headerlink" title="2019-CCPC-å“ˆå°”æ»¨"></a>2019-CCPC-å“ˆå°”æ»¨</h2><h3 id="B-Binary-Numbers"><a href="#B-Binary-Numbers" class="headerlink" title="B. Binary Numbers"></a>B. Binary Numbers</h3><p>$f(a,b)$å³$a,b$çš„æœ€é•¿å…¬å…±å‰ç¼€é•¿åº¦ï¼Œç„¶åæš´åŠ›æ‰“è¡¨ï¼Œå¯ä»¥çŸ¥é“$a,b$è¶Šç›¸è¿‘ï¼Œ$f(a,b)è¶Šå¤§$ï¼Œä»æ¯ä¸ªåŒºé—´é‡Œé€‰å‡ºä¸€ä¸ªä»£è¡¨æ•°å­—$A i$ï¼Œå¦‚æœå¯¹äºæ‰€æœ‰åŒºé—´$i$ï¼Œæ»¡è¶³$f ( A_i , k ) â‰¥ f ( A_j , k )$,$L_iâ‰¤kâ‰¤R_i$ã€‚</p><p>æ˜¾ç„¶æ ¹æ®å•è°ƒæ€§</p><ul><li>$f ( A_{i-1} , R_{i-1} ) â‰¥ f ( A_{i} , R_{i-1})$</li></ul><ul><li>$f ( A_i , L_i ) â‰¥ f ( A_{i-1} , L_i )$</li></ul><p>$f ( A_{i-1} , L_i ),f ( A_{i-1} , R_{i-1} )$å½“ä½œ$dp[i-1][][]$çš„çŠ¶æ€å»è½¬ç§»ï¼Œæ ¹æ®ä¸¤ä¸ªæ¡ä»¶çœ‹æ˜¯å¦è½¬ç§»ï¼Œä»¥åŠæ›´æ–°çŠ¶æ€å³å¯ã€‚</p><h3 id="E-Exchanging-Gifts"><a href="#E-Exchanging-Gifts" class="headerlink" title="E. Exchanging Gifts"></a>E. Exchanging Gifts</h3><p><strong>è¯·å…ˆææ¸…æ¥šï¼ŒåŸºæœ¬æœ€å¤§å¿«ä¹å€¼å¦‚ä½•æ±‚</strong>ã€‚</p><p>ä¸¤ä¸ªæ“ä½œå¯ä»¥æƒ³æˆä¸€é¢—æ ‘ï¼Œç„¶åæ ¹æ®æœ€åéœ€è¦çš„å‘ä¸‹ç±»ä¼¼$dp$,æœ€åå¾—åˆ°æŸäº›æ•°çš„æ•°é‡ã€‚</p><p>å°±æ˜¯æ¯”è¾ƒæœ€å¤§å€¼å’Œæ€»å’Œä¹‹é—´å¤§å°çš„åˆ†ç±»è®¨è®ºã€‚</p><h3 id="I-Interesting-Permutation"><a href="#I-Interesting-Permutation" class="headerlink" title="I. Interesting Permutation"></a>I. Interesting Permutation</h3><p>è€ƒè™‘æ¯æ¬¡å°±ç›¸å½“äºä¸€ä¸ªåŒºé—´é•¿åº¦ï¼Œ$tmp=$å¯æ’ç©ºä½</p><ul><li>$h_{i+1}=h_i$,$ans=ans\times tmp,tmp-1$</li><li>$h_{i+1}&gt;h_i$,$ans=2\times ans,tmp=tmp+h_{i+1}-h_i-1$,è¡¨ç¤ºæ–°çš„æ•°å¯ä»¥æ’å‰é¢å’Œåé¢ã€‚å¹¶ä¸”æ›´æ–°å¯æ’ç©ºä½ã€‚</li></ul><h3 id="L-LRU-Algorithm"><a href="#L-LRU-Algorithm" class="headerlink" title="L. LRU Algorithm"></a>L. LRU Algorithm</h3><p>æ‰¾åˆ°è§„å¾‹å‘ç°ï¼Œå†…å­˜å…¶å®æ— æ‰€è°“ï¼Œå‡è®¾å†…å­˜æ— é™å¤§ï¼Œé‚£ä¹ˆå¯¹äºæœ‰å†…å­˜å»å‰é¢$k$ä¸ªå³å¯ï¼Œè½»æ¾å¯ä»¥é¢„å¤„ç†$hash[n][k]$ï¼Œç„¶åæ¯æ¬¡æš´åŠ›æŸ¥æ‰¾å³å¯ã€‚æ³¨æ„$0$ã€‚</p><h2 id="300iq-Contest-1"><a href="#300iq-Contest-1" class="headerlink" title="300iq Contest 1"></a>300iq Contest 1</h2><h3 id="B-Best-Subsequence"><a href="#B-Best-Subsequence" class="headerlink" title="B.Best Subsequence"></a>B.Best Subsequence</h3><p>é€†å‘æ€ç»´å–åˆ å‡ºç›¸é‚»æœ€å¤§çš„ä¸€å®šæœ€ä¼˜ã€‚ç”¨$set$æ¨¡æ‹Ÿå³å¯ã€‚</p><h3 id="C-Cool-Pairs"><a href="#C-Cool-Pairs" class="headerlink" title="C.Cool Pairs"></a>C.Cool Pairs</h3><p>è½¬åŒ–æˆ$a_i&lt; -b_j=z_j$ï¼Œè¿™ç±»æ„é€ å…ˆè€ƒè™‘$k=0$,ç›´æ¥$z_j=-n$ï¼Œå†å°†$a_i$æŒ‰ç…§é¡ºåºå˜$[-n,-1]$ã€‚ç„¶åæ…¢æ…¢è°ƒæ•´$z_j$å¤§å°ã€‚</p><ul><li>å¦‚æœä¸å¤Ÿï¼Œç›´æ¥è®¾$z_j=1$,å°±å¯ä»¥è¦†ç›–$j-1$ä¸ª$a_i$ã€‚</li><li>å¦‚æœå¤Ÿäº†ï¼Œå°†$i&lt;j$çš„$a_i$ï¼Œæ’ä¸ªåºæ‰¾åˆ°ç¬¬$k$å°çš„$a$,$z_j$ç›´æ¥ç­‰äºå°±å¥½äº†ï¼Œå¹¶ä¸”ç»“æŸï¼Œç”±äº$a_i$æ˜¯è´Ÿçš„ï¼Œä¿è¯$z_j$å•è°ƒé€’å‡ã€‚</li></ul><h3 id="D-Dates"><a href="#D-Dates" class="headerlink" title="D. Dates"></a>D. Dates</h3><p>æ¯ä¸ªå¦¹å­åŒ¹é…ä¸€ä¸ªæ—¶é—´åŒºé—´ï¼Œæ¯ä¸ªæ—¶é—´æœ€å¤šé€‰æ‹©ğ‘ğ‘–ä¸ªå¦¹å­ï¼Œæ¯ä¸ªå¦¹å­æœ‰ä¸€ä¸ªå¿«ä¹å€¼ï¼Œæœ€å¤§åŒ–æ€»å¿«ä¹å€¼ã€‚</p><p>ç”±äºä¸€ä¸ªå¦¹å­æœ€å¤šåªä¼šå ç”¨å…¶ä»–å¦¹å­çš„çº¦ä¼šæ—¶é—´ï¼Œæ‰€ä»¥è´ªå¿ƒçš„é€‰æ‹©å¿«ä¹å€¼æ€»æ²¡é”™ã€‚</p><p>é‚£ä¹ˆé¢˜æ„å°±å˜æˆé€‰æ‹©å¦¹å­æ˜¯å¦å¯ä»¥ä¿è¯èƒ½æˆåŠŸè¿‡åŒ¹é…ã€‚</p><p>å¯¹äºä»»æ„åŒºé—´$[i,j]$ï¼ŒåŒºé—´$[i,j]$ä¸­é€‰ä¸­å¦¹å­çš„æ•°é‡éœ€è¦å°äºç­‰äºè¿™ä¸ªåŒºé—´å’Œã€‚</p><p>æ­¤æ—¶ç›¸å½“äºåˆ¤æ–­æ˜¯å¦æ‰€æœ‰å­é›†çš„é‚»åŸŸï¼ˆå³ä¸å…¶ç›¸é‚»çš„ç‚¹æ„æˆçš„é›†åˆï¼‰å¤§å°éƒ½æ¯”å­é›†æœ¬èº«å¤§ã€‚ç”±äº$L_i\leq L_{i+1},R_i\leq R_{i+1}$ï¼Œå·¦ä¾§çš„åŒºé—´çš„æƒ…å†µåªæœ‰$n^2$ç§ã€‚</p><p>$c[j]-c[i-1]\leq s[r_j]-s[l_i-1]$</p><p>$c[j]-s[r_j]\leq c[i-1]-s[l_i-1]$</p><p>è€ƒè™‘æˆ‘åŠ å…¥ä¸€ä¸ªé€‰ä¸­ä¸€ä¸ªå¦¹å­çš„æ—¶å€™å·¦ä¾§$[j,n]$ä¼šå‘ç”Ÿå˜åŒ–ã€‚å³ä¾§$[j+1,n]$ä¼šå‘ç”Ÿå˜åŒ–ã€‚åˆ¤æ–­å˜åŒ–çš„é‚£ç«¯æ˜¯å¦å‘ç”Ÿå·¦ä¾§æœ€å¤§å€¼$[j,n]$æ˜¯å¦å¤§äºå³ä¾§æœ€å°å€¼$[1,j]$äº†ã€‚</p><p>ä¸ç„¶æ’¤å›æ“ä½œã€‚</p><h3 id="F-Free-Edges"><a href="#F-Free-Edges" class="headerlink" title="F. Free Edges"></a>F. Free Edges</h3><p>é—®è‡³å°‘åˆ æ‰å¤šå°‘æ¡è¾¹åå›¾ä¸­ä¸å­˜åœ¨ç¯ã€‚å¹¶èŒ¶å‡ çå‡ æŠŠæ‰¾ä¸€æ‰¾å°±å¥½äº†</p><h3 id="K-Knowledge"><a href="#K-Knowledge" class="headerlink" title="K. Knowledge"></a>K. Knowledge</h3><p>æ¯æ¬¡å¯ä»¥åˆ åŠ æ‰$aa$,$bb$,$ababab$ã€‚</p><p>å‘ç°ä»»ä½•å­—ç¬¦ä¸²éƒ½å¯ä»¥å˜æˆä¸€ä¸ªæœ€çŸ­æ— æ³•å˜çŸ­å­—ç¬¦ä¸²<br>æ‰¾åˆ°å…³é”®çš„å‡ ä¸ªå˜åŒ–</p><ul><li>$aa\rightarrow$</li><li>$bbb\rightarrow$</li><li>$abba \rightarrow bab$</li><li>$ababa\rightarrow bb$</li><li>$abba\rightarrow bab$</li><li>$baba\rightarrow abb$</li></ul><p>å¤šå†™ä¸€ç‚¹å°±å¥½äº†ï¼Œç„¶åå‘ç°å°±$12$ä¸ªä¸ºåŸºåº•çš„å­—ç¬¦ä¸²ã€‚</p><p>ç„¶åå³ä»$k$é•¿åº¦çš„å­—ç¬¦ä¸²å˜æˆ$s$,è€ƒè™‘$12$ä¸ªçš„äº’ç›¸å˜æ¢å…³ç³»ï¼Œç›¸å½“ä¸èµ°è·¯å¾„ä¸€æ ·ï¼ŒæŸ¥çœ‹ä»$x$èµ°åˆ°$y$æœ‰å‡ ç§èµ°æ³•ï¼Œè¿™é‡Œå°±æ˜¯ä»ç©ºå­—ç¬¦ä¸²èµ°$k$æ­¥ï¼Œæœ‰å¤šå°‘ç§å˜æˆ$s$çš„è·¯å¾„ç§ç±»ï¼ŒçŸ©é˜µå¿«é€Ÿå¹‚å³å¯ã€‚</p><h2 id="ICPC-Asia-East-Continent-Final"><a href="#ICPC-Asia-East-Continent-Final" class="headerlink" title="ICPC Asia-East Continent Final"></a>ICPC Asia-East Continent Final</h2><h3 id="H-King"><a href="#H-King" class="headerlink" title="H.King"></a>H.King</h3><p>æ‰¾åˆ°$qa_i \equiv a_{i+1} \pmod p$,$\geq n/2$çš„æœ€é•¿å­åºåˆ—ã€‚<br>$q\equiv a_{i+1}a^{-1}_i \pmod p$</p><p>$\geq n/2$çš„æœ€é•¿å­åºåˆ—ã€‚å¿…å®šå­˜åœ¨ç›¸é‚»çš„$a_i$ã€‚</p><p>éšæœºåŒ–æšä¸¾å³å¯ã€‚</p><h1 id="é›…ç¤¼é›†è®­"><a href="#é›…ç¤¼é›†è®­" class="headerlink" title="é›…ç¤¼é›†è®­"></a>é›…ç¤¼é›†è®­</h1><h2 id="LOJ6029-ã€Œé›…ç¤¼é›†è®­-2017-Day1ã€å¸‚åœº"><a href="#LOJ6029-ã€Œé›…ç¤¼é›†è®­-2017-Day1ã€å¸‚åœº" class="headerlink" title="LOJ6029. ã€Œé›…ç¤¼é›†è®­ 2017 Day1ã€å¸‚åœº"></a>LOJ6029. ã€Œé›…ç¤¼é›†è®­ 2017 Day1ã€å¸‚åœº</h2><p>å½“çº¿æ®µæ ‘ä¸Šçš„ç‚¹$max[pos]-min[pos]&lt; d$å°±ä¼šå˜æˆå‡æ³•ï¼Œè€Œ$\sum a_i+d$ï¼Œåªä¼šæ”¹å˜ä¸¤ä¸ª$max-min$ã€‚å³æˆ‘æœ€å¤šéœ€è¦é™¤$qlog(q\times 10^4)$ã€‚<br>éœ€è¦ä¸€ä¸ªæ”¯æŒæœ€å¤§å€¼ï¼Œæœ€å°å€¼ï¼ŒåŒºé—´å’Œçš„çº¿æ®µæ ‘å³å¯ã€‚</p><h2 id="LOJ6030-ã€Œé›…ç¤¼é›†è®­-2017-Day1ã€çŸ©é˜µ"><a href="#LOJ6030-ã€Œé›…ç¤¼é›†è®­-2017-Day1ã€çŸ©é˜µ" class="headerlink" title="LOJ6030. ã€Œé›…ç¤¼é›†è®­ 2017 Day1ã€çŸ©é˜µ"></a>LOJ6030. ã€Œé›…ç¤¼é›†è®­ 2017 Day1ã€çŸ©é˜µ</h2><p>å…ˆæ„é€ ä¸€è¡Œéƒ½æ˜¯#,ç„¶åå¡«å……ç«–å³å¯ã€‚ï¼ˆæ³¨æ„éœ€è¦æ³¨æ„å·²ç»$ok$çš„ç«–ï¼Œä»¥åŠå¡«å……æ­¤è¡Œåªéœ€è¦æœ‰è¿™è¡Œçš„ç«–ï¼Œæˆ–è€…<strong>èŠ±è´¹ä¸€æ¬¡æ„é€ è¿™ä¸ªç«–</strong></p><h2 id="LOJ6031-ã€Œé›…ç¤¼é›†è®­-2017-Day1ã€å­—ç¬¦ä¸²"><a href="#LOJ6031-ã€Œé›…ç¤¼é›†è®­-2017-Day1ã€å­—ç¬¦ä¸²" class="headerlink" title="LOJ6031. ã€Œé›…ç¤¼é›†è®­ 2017 Day1ã€å­—ç¬¦ä¸²"></a>LOJ6031. ã€Œé›…ç¤¼é›†è®­ 2017 Day1ã€å­—ç¬¦ä¸²</h2><p>$qk\leq 10^5$</p><ul><li><p>$k\leq 300$ï¼Œæš´åŠ›è·³æ‰€æœ‰å­ä¸²ï¼Œç„¶åæš´åŠ›äºŒåˆ†è¯¢é—®$mp[l][r]ï¼Œåœ¨[a,b]$ä¸­æœ‰å‡ ä¸ª,å¯ä»¥ç¦»çº¿åšåˆ°$O(qk^2)$ï¼Œåœ¨çº¿å°±æ˜¯$O(qk^2\log n)$</p></li><li><p>$q\leq300$,ä»$1$èµ°å­ä¸²ä¿è¯åç¼€é‚£ç§ï¼Œæ¯èµ°åˆ°$r$ï¼Œéœ€æœ‰æ‰€æœ‰çš„$l$,è¿™ä¸ªæ—¶å€™å€å¢å¾€ä¸Šè·³å¯»æ‰¾$siz$æœ€å¤§ã€‚$O(qm\log n)$</p></li></ul><h2 id="LOJ6032-ã€Œé›…ç¤¼é›†è®­-2017-Day2ã€æ°´ç®±"><a href="#LOJ6032-ã€Œé›…ç¤¼é›†è®­-2017-Day2ã€æ°´ç®±" class="headerlink" title="LOJ6032. ã€Œé›…ç¤¼é›†è®­ 2017 Day2ã€æ°´ç®±"></a>LOJ6032. ã€Œé›…ç¤¼é›†è®­ 2017 Day2ã€æ°´ç®±</h2><p>æŒ‰ç…§é«˜åº¦æ’åºï¼Œï¼ˆæ³¨æ„è¿™é‡Œéœ€è¦å…ˆåˆå¹¶å†å¤„ç†é‚£äº›æ¡ä»¶),$ans[x]$è¡¨ç¤º$x$ä¸ªå—çš„ç­”æ¡ˆï¼Œ$f[x]$è¡¨ç¤ºç›®å‰ä¸ºæ­¢æœ‰æ°´éœ€æ±‚çš„æ•°é‡ã€‚</p><ul><li>è€ƒè™‘åˆå¹¶ï¼Œåˆå¹¶ç­”æ¡ˆå³å¯ã€‚</li><li>è€ƒè™‘æœ‰æ°´ï¼Œåˆ™$f[find(x)]$++,æ›´æ–°ç­”æ¡ˆ$ans[x]$</li><li>è€ƒè™‘æ— æ°´ï¼Œåˆ™ç›´æ¥æ›´æ–°$ans[x]$</li></ul><h2 id="LOJ6033-ã€Œé›…ç¤¼é›†è®­-2017-Day2ã€æ£‹ç›˜æ¸¸æˆ"><a href="#LOJ6033-ã€Œé›…ç¤¼é›†è®­-2017-Day2ã€æ£‹ç›˜æ¸¸æˆ" class="headerlink" title="LOJ6033. ã€Œé›…ç¤¼é›†è®­ 2017 Day2ã€æ£‹ç›˜æ¸¸æˆ"></a>LOJ6033. ã€Œé›…ç¤¼é›†è®­ 2017 Day2ã€æ£‹ç›˜æ¸¸æˆ</h2><p>äºŒåˆ†å›¾åšå¼ˆï¼Œå³æ‰¾åˆ°é‚£äº›ç‚¹æ˜¯éå¿…é¡»ç‚¹ã€‚å³åˆ é™¤äº†ä¹‹åå¯¹æœ€å¤§åŒ¹é…æ²¡å½±å“ã€‚è€ƒè™‘ä¸€ä¸ªéåŒ¹é…ç‚¹ğ‘¥ï¼Œå‡å¦‚å®ƒè¿å‘äº†ä¸€ä¸ªåŒ¹é…ç‚¹ğ‘¦ï¼Œé‚£ä¹ˆå®ƒå°±èƒ½æ›¿æ¢æ‰å½“å‰å½“å‰å’Œè¿™ä¸ªåŒ¹é…ç‚¹åŒ¹é…çš„ç‚¹ğ‘§ï¼Œè€Œè¿™æ—¶ğ‘§ä¹Ÿå¯ä»¥è¿›è¡ŒåŒæ ·çš„æ“ä½œã€‚</p><p>é¦–å…ˆæ ¹æ®æ—¶é—´æˆ³çš„åŒˆç‰™åˆ©ç®—æ³•å¯ä»¥æ‰¾åˆ°æ‰€æœ‰å¯èƒ½çš„åŒ¹é…ç‚¹ï¼Œç„¶åæ‰¾éåŒ¹é…ç‚¹ã€‚</p><p>äºæ˜¯æˆ‘ä»¬ä»æ¯ä¸ªéåŒ¹é…ğ‘¥å‡ºå‘è¿›è¡Œğ‘‘ğ‘“ğ‘ ï¼Œé€”ç»çš„å’Œğ‘¥åŒä¸€é›†åˆçš„ç‚¹éƒ½æ»¡è¶³è¦æ±‚ã€‚</p><h2 id="LOJ6034-ã€Œé›…ç¤¼é›†è®­-2017-Day2ã€çº¿æ®µæ¸¸æˆ"><a href="#LOJ6034-ã€Œé›…ç¤¼é›†è®­-2017-Day2ã€çº¿æ®µæ¸¸æˆ" class="headerlink" title="LOJ6034. ã€Œé›…ç¤¼é›†è®­ 2017 Day2ã€çº¿æ®µæ¸¸æˆ"></a>LOJ6034. ã€Œé›…ç¤¼é›†è®­ 2017 Day2ã€çº¿æ®µæ¸¸æˆ</h2><p>æè¶…çº¿æ®µæ ‘æ¨¡ç‰ˆé¢˜ã€‚</p><h2 id="LOJ6035-ã€Œé›…ç¤¼é›†è®­-2017-Day4ã€æ´—è¡£æœ"><a href="#LOJ6035-ã€Œé›…ç¤¼é›†è®­-2017-Day4ã€æ´—è¡£æœ" class="headerlink" title="LOJ6035. ã€Œé›…ç¤¼é›†è®­ 2017 Day4ã€æ´—è¡£æœ"></a>LOJ6035. ã€Œé›…ç¤¼é›†è®­ 2017 Day4ã€æ´—è¡£æœ</h2><p>è€ƒè™‘åªæ´—è¡£æœï¼Œåˆ™ç”¨ä¼˜å…ˆé˜Ÿåˆ—ç»´æŠ¤å½“å‰æœ€å°æ´—è¡£æ—¶é—´ã€‚å°±å¯ä»¥å¾—åˆ°æ´—$k$é—´è¡£æœéœ€è¦çš„æœ€çŸ­æ—¶é—´ã€‚åŒæ ·å¤„ç†çƒ˜å¹²è¡£æœçš„æ—¶é—´ã€‚</p><p>è€ƒè™‘åˆ°æ‰€æœ‰è¡£æœéƒ½è¢«çƒ˜å¹²åçƒ˜å¹²æœºå…¨éƒ¨æ˜¯ç©ºçš„ï¼Œå¯ä»¥æŠŠè¿™ä¸ªè¿‡ç¨‹å€’è¿‡æ¥ï¼Œè¿™æ ·å­å°±å’Œæ´—è¡£æœä¸€æ ·ã€‚å³å½“$i$è¡£æœæ´—å®Œåï¼Œé€‰å¦‚æœå½“ç¬¬$p_i$çƒ˜å¹²çš„åˆ™æ—¶é—´</p><script type="math/tex; mode=display">\max(a_1+b_{p_1},a_2+b_{p_2}....a_n+b_{p_n})</script><p>é¡ºåºå’Œå¤§äºç­‰äºä¹±åºå’Œå¤§äºç­‰äºé€†åºå’Œ,æ±‚ä¸ªé€†åºå’Œå³å¯ã€‚</p><h2 id="LOJ6036-ã€Œé›…ç¤¼é›†è®­-2017-Day4ã€ç¼–ç "><a href="#LOJ6036-ã€Œé›…ç¤¼é›†è®­-2017-Day4ã€ç¼–ç " class="headerlink" title="LOJ6036. ã€Œé›…ç¤¼é›†è®­ 2017 Day4ã€ç¼–ç "></a>LOJ6036. ã€Œé›…ç¤¼é›†è®­ 2017 Day4ã€ç¼–ç </h2><p>å¯ä»¥å¾—åˆ°ä¸€ä¸ª$O(n^2)$çš„2-SATã€‚<br>è€ƒè™‘å¦‚ä½•ä¼˜åŒ–</p><p>é¦–å…ˆæŒ‰ç…§é•¿åº¦æ’åºï¼Œå°±å¯ä»¥å‡å°‘ä¸å¿…è¦çš„åˆ†ç±»è®¨è®ºã€‚</p><p>å¦‚æœæœ‰éå†åˆ°å‰ç¼€ï¼Œé‚£ä¹ˆè¿æ¥ä¸¤ä¸ªç‚¹è¡¨ç¤ºä¸èƒ½åŒæ—¶æˆç«‹ã€‚</p><p>åœ¨æœ€åä¸èƒ½æŠŠè¿™ä¸ªæƒ…å†µç›´æ¥å‹å…¥ç»ˆæ­¢èŠ‚ç‚¹ï¼Œä¼šå¯¼è‡´æŸä¸ªèŠ‚ç‚¹å¤ªå¤šç‚¹ã€‚è€ƒè™‘æ¯æ¬¡æ–°å»ºç‚¹ï¼Œ$new$ä¸èƒ½ä¸$old$åŒæ—¶æˆç«‹ï¼Œä½†éœ€è¦å’Œ$tmp$åŒæ—¶æˆç«‹ã€‚</p><hr><h1 id="Codeforces"><a href="#Codeforces" class="headerlink" title="Codeforces"></a>Codeforces</h1><h2 id="CF1358F-Tasty-Cookie"><a href="#CF1358F-Tasty-Cookie" class="headerlink" title="CF1358F Tasty Cookie"></a>CF1358F Tasty Cookie</h2><ul><li>ç¿»è½¬$a$æ•°åˆ—</li><li>å°†$a$æ•°åˆ—å˜æˆä»–çš„å‰ç¼€å’Œ</li></ul><p>å‰ç¼€å’Œä¸æ–­å¢å¤§å¾—å¾ˆå¿«ã€‚$n\geq 3$æ¨¡æ‹Ÿå³å¯ï¼Œä½ é—®æˆ‘å’‹æ¨¡æ‹Ÿï¼Œ$std$,æ»¡è¶³å•è°ƒå¢å°±å·®åˆ†ï¼Œä¸æ»¡è¶³å°±å€’ç½®ï¼Œå¦åˆ™å°±$-1$ã€‚</p><p>$n=2$,å°±ç‰¹åˆ«éº»çƒ¦ã€‚</p><ul><li>æ ¹æ®ä¸Šé¢˜ï¼Œæˆ‘ä»¬éœ€è¦æŠŠæœ¬æ¥å·®åˆ†çš„éƒ¨åˆ†å¿«é€Ÿå·®åˆ†ï¼Œ</li><li>å¦‚æœå¿«é€Ÿå·®åˆ†è¿‡ç¨‹ä¸­å‡ºç°$a$æ•°ç»„ï¼Œä¸¤ä¸¤ç‰¹åˆ¤ã€‚</li><li>ä»¥ä¸Šæƒ…å†µéƒ½æ²¡æœ‰å¹¶ä¸”è¢«å·®åˆ†åˆ°æŸä¸ªæ•°$=0$,$-1$</li></ul><p>ä¹‹åå°±æ˜¯çœ‹æ¸…é¢˜æ„å†™æ•´é½</p><h2 id="CF1367F2-Flying-Sort-Hard-Version"><a href="#CF1367F2-Flying-Sort-Hard-Version" class="headerlink" title="CF1367F2 Flying Sort (Hard Version)"></a>CF1367F2 Flying Sort (Hard Version)</h2><p>æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œä¸­é—´çš„æ•°å­—æ˜¯ä¸èƒ½æ’è¿›å»çš„ï¼Œæ‰€ä»¥è¿™ç»„æ•°æ˜¯åœ¨æ’åºåä»ç›¸é‚»çš„æ•°ï¼Œåˆ™è¦æ‰¾åˆ°æœ€é•¿çš„å­åºåˆ—ã€‚</p><p>å¯¹äºç›¸åŒæ•°å­—çš„è€ƒç©¶ã€‚</p><ul><li>å¦‚æœä¸€ä¸ªæ•°å½“ç¬¬ä¸€ä½ä»¥åŠæœ€åä¸€ä½ï¼Œæ•°é‡æ˜¯å¯ä»¥ä»»æ„ã€‚</li><li>å¦åˆ™å¿…é¡»å…¨éƒ¨æ•°å­—åŠ è¿›å»ã€‚</li></ul><p>å…ˆç¦»æ•£åŒ–ä¸€ä¸‹ã€‚<br>æˆ‘ä»¬å¯ä»¥è¿™æ ·$dp$,$dp[i]$ï¼Œè¡¨ç¤º$[1,i]$æœ€é•¿çš„ä¸ä¸¥æ ¼å¢åºåˆ—</p><ul><li>æŠŠ$a[i]-1$å½“ä¸­é—´çš„æ•°å­—ï¼Œåˆ™$dp[i]=dp[l[a[i]-1]+cnt[a[i]-1]$</li><li>æŠŠ$a[i]-1$å½“ç¬¬ä¸€çš„æ•°å­—ï¼Œåˆ™$dp[i]=cnt[a[i]-1]+1$</li><li>æŠŠ$a[i]$å½“æœ€åä¸€ä½çš„æ•°å­—ï¼Œåˆ™$dp[i]=dp[pre[a[i]]]+1$</li></ul><h2 id="CF1368E-Ski-Accidents"><a href="#CF1368E-Ski-Accidents" class="headerlink" title="CF1368E Ski Accidents"></a>CF1368E Ski Accidents</h2><p>æœ‰ $n$ ä¸ªé¡¶ç‚¹ï¼Œä»¥åŠ $m$æ¡æœ‰å‘è¾¹ï¼Œæ‰€æœ‰æœ‰å‘è¾¹$(u,v)$ å‡æ»¡è¶³ $u&lt;v$ ï¼Œä¸”æ‰€æœ‰é¡¶ç‚¹çš„å‡ºåº¦éƒ½ä¸è¶…è¿‡ $2$ ï¼Œè¦æ±‚ä»ä¸­åˆ å»ä¸è¶…è¿‡ $\frac{4}{7}$ä¸ªé¡¶ç‚¹ï¼Œä½¿å¾—å›¾ä¸­ä¸å­˜åœ¨é•¿åº¦è¶…è¿‡$1$ çš„è·¯å¾„ã€‚</p><p>å¦‚æœæ˜¯å®Œå…¨äºŒå‰æ ‘æ˜¾ç„¶å¯ä»¥çš„$4/7$ã€‚è€ƒè™‘åå‘å»ºè¾¹ï¼Œå¦‚æœæ‰¾åˆ°é•¿åº¦ä¸º $2$çš„è·¯å¾„çš„é¡¶ç‚¹æ—¶ï¼Œå°†é¡¶ç‚¹ $i$ åˆ æ‰å³å¯,å¹¶ä¸”ç”±äºé¢˜ç›®æ‰€ç»™$u&lt;v$ï¼Œå°±ä¸ä¼šæœ‰åæ•ˆæ€§äº†ã€‚</p><h2 id="CF1374E2-Reading-Books-hard-version"><a href="#CF1374E2-Reading-Books-hard-version" class="headerlink" title="CF1374E2 Reading Books (hard version)"></a>CF1374E2 Reading Books (hard version)</h2><p>æ€è·¯å¾ˆæ˜æ˜¾ï¼Œå…ˆç¦»æ•£åŒ–ç¦»çº¿ï¼Œåé¢åšæƒå€¼çº¿æ®µæ ‘ç¬¬$k$å¤§ã€‚åˆ«æŠŠçº¿æ®µæ ‘å†™é”™äº†ã€‚</p><h2 id="CF1380G-Circular-Dungeon"><a href="#CF1380G-Circular-Dungeon" class="headerlink" title="CF1380G Circular Dungeon"></a>CF1380G Circular Dungeon</h2><p>è‡ªå·±åšå‡ºæ¥çš„ï¼ŒæŒ‰ç…§å®ç®±å¤§å°å»åˆ†é…é‡åˆ°$k$ä¸ªä¹‹å‰çš„ä»·å€¼ã€‚è¿™é‡Œå¯ä»¥æå‰é¢„å¤„ç†ï¼Œå‰ç¼€å’Œå³å¯ã€‚æ³¨æ„ä¸‹æ— æ³•$(n-i)\mod i \not = 0$å³å¯ã€‚</p><h2 id="CF1384D-GameGame"><a href="#CF1384D-GameGame" class="headerlink" title="CF1384D. GameGame"></a>CF1384D. GameGame</h2><p>å¯¹äºæ¯ä½æ¥è¯´å¦‚æœå¼‚æˆ–ä½$0$,åˆ™è¿™ä½æ²¡å½±å“ã€‚</p><p>è€ƒè™‘æœ€é«˜ä½å¼‚æˆ–ä¸ä¸º$0$,å¿…å®šåœ¨æ­¤æœ‰å†³æˆ˜ï¼Œä¸”å¿…å®šæœ‰å¥‡æ•°ä¸ª$1$ã€‚è§‚å¯Ÿä¸‹å¯å¾—å¦‚æœéƒ½æ˜¯$1$,åˆ™$cnt\mod 4=1$ã€‚æˆ–è€…$cnt\mod 4=2,(n-cnt)\mod 2=1$ï¼Œæ‹¿åˆ°å¥‡æ•°ä¸ª$1$ä¹‹åæœ‰$0$æ‹¿ã€‚</p><h2 id="CF1387B1-Village-Minimum"><a href="#CF1387B1-Village-Minimum" class="headerlink" title="CF1387B1 Village (Minimum)"></a>CF1387B1 Village (Minimum)</h2><p>ç®€å•çš„æ ‘å½¢$dp$ã€‚</p><h2 id="CF1387B2-Village-Maximum"><a href="#CF1387B2-Village-Maximum" class="headerlink" title="CF1387B2 Village (Maximum)"></a>CF1387B2 Village (Maximum)</h2><p>ç­”æ¡ˆæ˜¾è€Œæ˜“è§$\sum min(n - siz[i], siz[i])$ã€‚</p><p>çœ‹æ€ä¹ˆåˆç†åˆ†é…ã€‚$min(n - siz[i], siz[i])\leq n/2$ï¼Œä¹Ÿå°±æ˜¯è·¯å¾„å¿…é¡»ç»è¿‡é‡å¿ƒ</p><p>åˆ™ç­”æ¡ˆä¸€å®šäº§ç”Ÿåœ¨é‡å¿ƒçš„å­æ ‘é‡Œï¼Œ$siz[i]\leq n/2$,ä¹Ÿä¸€å®šæ˜¯é‡å¿ƒçš„æ¯ä¸ªå­æ ‘é‡Œçš„ç‚¹äº’ç›¸åŒ¹é…ã€‚</p><p>è¿™ä¸ªåºåˆ—çš„ç¬¬$i$é¡¹å’Œç¬¬$i+\lfloor\frac{n}{2}\rfloor$ï¼ŒåŒ¹é…ï¼Œæ³¨æ„$n\&amp;1$ï¼Œæœ‰ä¸ªç‚¹ä¼šä¿æŒä¸å˜ï¼Œå…¶å®æ­¤æ—¶äº¤æ¢ä¸ä¼šå‘ç”Ÿå˜åŒ–ï¼Œéšä¾¿æ‰¾ä¸ªç‚¹äº’æ¢å³å¯ã€‚</p><h2 id="CF1399E2-Weights-Division-hard-version"><a href="#CF1399E2-Weights-Division-hard-version" class="headerlink" title="CF1399E2 Weights Division (hard version)"></a>CF1399E2 Weights Division (hard version)</h2><p>åˆ†ç±»èŠ±è´¹ç¡¬å¸çš„ä»·å€¼æ¯ä¸ªè¾¹æƒè®¡ç®—$/2$ç»™äºˆçš„ä»·å€¼ã€‚å¯ä»¥æå‰$n\log$å¤„ç†ï¼Œåæ­£é™¤æˆ‘ä¹‹å‰ä¸€å®šè¦é™¤æˆ‘ä¹‹å‰çš„ã€‚</p><p>å°±å˜æˆèŠ±è´¹ç¡¬å¸$1$ï¼Œæ‰€ä»¥ç›´æ¥æšä¸¾ä¸€ä¸ªçš„ç§ç±»ä½¿ç”¨çš„æ•°é‡ï¼Œå†äºŒåˆ†æˆ–è€…å•è°ƒé˜Ÿåˆ—å¦ä¸€ä¸ªã€‚</p><h2 id="CF1354C2-Not-So-Simple-Polygon-Embedding"><a href="#CF1354C2-Not-So-Simple-Polygon-Embedding" class="headerlink" title="CF1354C2. Not So Simple Polygon Embedding"></a>CF1354C2. Not So Simple Polygon Embedding</h2><p>æ±‚$n$ä¸ºå¥‡æ•°ï¼Œ$n$ä¸ºå¶æ•°</p><ul><li>å¯ä»¥å˜æˆæ‰©å¤§å˜æˆå¶æ•°ï¼Œå¶æ•°å°±æ˜¯éå¸¸ç®€å•ã€‚</li><li>é€‰æ‹©$\frac{pi}{2n}$ï¼Œ<strong>ä¸è¦è¢«å…­è¾¹å½¢è¿·æƒ‘è®¡ç®—</strong>ã€‚</li></ul><h2 id="CF1354F-Summoning-Minions"><a href="#CF1354F-Summoning-Minions" class="headerlink" title="CF1354F. Summoning Minions"></a>CF1354F. Summoning Minions</h2><p>è§£é‡Šä¸€ä¸‹ä¸ºå•¥æ˜¯ä¸€å®šæ˜¯å‰$k-1$å¼ æ”¾ä¸‹ï¼Œç„¶å$n-k$å¼ æ”¾äº†å°±æ‹¿èµ°ï¼Œæœ€åä¸€å¼ å†æ”¾ä¸‹ã€‚</p><p>é¦–å…ˆæ— è®ºæ€ä¹ˆæ”¾ç»ˆç©¶æ˜¯$\sum a_i+(k-1)\sum b_i+\sum (j-1)b_j$ã€‚</p><p>è¿™æ ·è‚¯å®šæ˜¯æœ€ä¼˜çš„ï¼Œç„¶åå…¶å®å°±æ˜¯æšä¸¾æ‰€æœ‰æœ€åç•™åœ¨æ¡Œå­ä¸Šçš„$C_n^k$å¼ æƒå€¼å°±å®šäº†ã€‚ä¸€å®šä¸ä¼šé”™è¿‡æœ€ä¼˜è§£ï¼Œç„¶åçŸ¥é“äº†å°±ç®€å•çš„äºŒç»´$dp$ã€‚</p><h2 id="CF1354G-Find-a-Gift"><a href="#CF1354G-Find-a-Gift" class="headerlink" title="CF1354G. Find a Gift"></a>CF1354G. Find a Gift</h2><p>æ³¨æ„$k\leq \frac{n}{2}$ï¼Œå°±å¯ä»¥éšæœºåŒ–ç¡®å®š$1$æ˜¯å¦ä¸ºç¤¼ç‰©äº†ã€‚åªè¦å‡ºç°å°çš„ä¸€å®šæ˜¯ç¤¼ç‰©ã€‚æ˜¾ç„¶éšæœºåŒ–$k$,å¦‚æœæ˜¯ç¤¼ç‰©ä¸€å®šä¼šå‡ºç°$2$ã€‚å¦åˆ™æ˜¯çŸ³å¤´æ˜¯ä¸ä¼šå‡ºç°$2$çš„ã€‚</p><p>ç„¶åå°±å¯ä»¥é€šè¿‡ä¸€æ¬¡æ¬¡å€å¢ç¡®å®š$[1,2^k]$æ˜¯å¦ä¸ºçŸ³å­ï¼Œ ä¹Ÿå¯ä»¥å‘ç°$(2^k,<br>2^{k+1}]$ï¼Œç„¶åæ—¢ç„¶æˆ‘çŸ¥é“æœ‰å¯ä»¥å¯¹æ¯”çš„ä»»ä½•å°äºåŒºé—´çš„çŸ³å¤´,å°±å¯ä»¥è½»æ¾ç”¨äºŒåˆ†æ‰¾åˆ°æœ€å·¦ç«¯çš„ç¤¼ç‰©åœ¨å“ªäº†ã€‚</p><h2 id="CF1421E-Swedish-Heroes"><a href="#CF1421E-Swedish-Heroes" class="headerlink" title="CF1421E. Swedish Heroes"></a>CF1421E. Swedish Heroes</h2><p>æ‰¾åˆ°è§„å¾‹ä¸€å®šæ˜¯æ­£è´Ÿäº¤æ›¿ï¼Œå¹¶ä¸”å‘ç°åªéœ€è¦$(n+\sum [p_i=-1])\mod 3=1$ã€‚å¹¶ä¸”ä¸èƒ½ä¸º$+-+-+$è¿™æ ·æ˜¾ç„¶ä¸å¯èƒ½ã€‚è®¾$m=\sum [p_i=-1]$,$dp[n][m][last][flag]$,$last=$æœ€åä¸€ä¸ª$a_i$çš„æ­£è´Ÿï¼Œæ˜¯å¦å½“å‰ä¸º$+-+-$</p><h2 id="CF1353F-Decreasing-Heights"><a href="#CF1353F-Decreasing-Heights" class="headerlink" title="CF1353F. Decreasing Heights"></a>CF1353F. Decreasing Heights</h2><p>ä¸€å®šæœ‰å…ƒç´ ä¸å˜ï¼Œç›´æ¥æšä¸¾ä¸å˜çš„$O(n^4)dp$</p><h2 id="CF1353E-K-periodic-Garland"><a href="#CF1353E-K-periodic-Garland" class="headerlink" title="CF1353E. K-periodic Garland"></a>CF1353E. K-periodic Garland</h2><p>çœ‹é”™é¢˜æ„+å¤±è¯¯ï¼Œç±»ä¼¼äºæ±‚å­æ®µæœ€å¤§å’Œä¸€æ ·å³å¯ã€‚æ³¨æ„$dp$å¯ä»¥é‡å¤´å¼€å§‹ï¼Œä¹Ÿå¯ä»¥æ¥åé¢çš„ã€‚</p><h2 id="CF1427E-Xum"><a href="#CF1427E-Xum" class="headerlink" title="CF1427E . Xum"></a>CF1427E . Xum</h2><p>é€šè¿‡ç»™å®šçš„$a$,$a$ä¸ºå¥‡æ•°ï¼Œæ“ä½œ$\oplus, +$æ„é€ å‡ºä¸€ä¸ª$1$,æ˜¾ç„¶$ax-by=1$å³å¯ã€‚æ„é€ ä¸€ä¸ªäº’è´¨çš„$y$å³å¯ï¼Œæš´åŠ›æšä¸¾$(a\times(2k+1)\oplus a)$ï¼Œç„¶åæ³¨æ„èŒƒå›´$ax\leq 10^{12}$ï¼Œ$x\times t$è¿™ä¸ªå¥½æ„é€ ã€‚æ³¨æ„æ§åˆ¶å¤§å°ã€‚</p><h2 id="CF1344D-Resume-Review"><a href="#CF1344D-Resume-Review" class="headerlink" title="CF1344D.RÃ©sumÃ© Review"></a>CF1344D.RÃ©sumÃ© Review</h2><p>æš´åŠ›å¾ˆå¥½æƒ³ï¼ŒæŠŠ$a_i-3x^2+3x-1$ï¼Œæ”¾åˆ°ä¼˜å…ˆé˜Ÿåˆ—é‡Œé¢ä¸€ä¸ªä¸€ä¸ªå–ã€‚</p><p>è€Œè¿™é‡Œå·§å¦™æšä¸¾äº†æœ€åç»“æŸçš„$\Delta f(i,x)$ï¼Œå¯ä»¥åˆ¤æ–­æ¯ä¸ªæœ€å¤šå¯ä»¥å–å¤šå°‘ã€‚ï¼ˆè¿™é‡Œå†ç”¨äºŒåˆ†ï¼‰ã€‚</p><p>ç„¶åç»†èŠ‚å°±éœ€è¦ï¼Œå› ä¸ºå¯èƒ½æœ‰å¥½å‡ ä¸ªç›¸åŒçš„å€¼ï¼Œæ‰€ä»¥äºŒåˆ†æ—¶å€™å¾€å¤§çš„æ–¹å‘å–ç­”æ¡ˆï¼Œå³æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„å°½å¯èƒ½å°çš„å€¼ï¼Œç„¶åç”±äºå¯èƒ½å¤šäº†ä½¿ç”¨æ¬¡æ•°ï¼Œæ‰¾åˆ°$=ans$,â€”ã€‚</p><h2 id="CF1344C-Quantifier-Question"><a href="#CF1344C-Quantifier-Question" class="headerlink" title="CF1344C Quantifier Question"></a>CF1344C Quantifier Question</h2><p>é¢˜æ„å¾ˆæ¶å¿ƒï¼Œæ³¨æ„$x$æˆç«‹æ˜¯æœ‰é¡ºåºçš„ï¼Œæ˜¾ç„¶æœ‰ç¯ä¸å¯èƒ½ã€‚ç„¶åæ‰€æœ‰å­˜åœ¨ä¸€å®šå¯èƒ½ï¼Œç„¶åå‘ç°å¦‚æœå‡ºç°ä¸€ä¸ªä»»æ„ï¼Œé€’æ¨åˆ°æˆ‘çš„å’Œæˆ‘é€’æ¨çš„éƒ½è¦å˜æˆå­˜åœ¨ï¼Œåˆå› ä¸º$a&lt;b,b&lt;c,a&lt;c$,å…·æœ‰ä¼ é€’æ€§ï¼Œå°±æ˜¯è¯´è·‘è¿™ä¸ªæœ‰å‘å›¾è·‘åˆ°çš„ç‚¹éƒ½è¦å˜æˆå­˜åœ¨ï¼ˆåˆ«å¿˜è®°è·‘åå›¾ã€‚ç„¶åæˆ‘ä»¬å‘ç°åªè¦è¢«ä»»æ„ä¸€ä¸ªå›¾è·‘åˆ°çš„èŠ‚ç‚¹ï¼Œä»–çš„å€¼ä¹Ÿç¡®å®šäº†ï¼Œæˆ‘çš„åå›¾å’Œæ­£å›¾é‚£äº›ä¹Ÿä¸èƒ½ä»»æ„äº†ï¼Œè¦åšä¸€æ ·çš„æ“ä½œã€‚</p><h2 id="CF1363F-Rotating-Substrings"><a href="#CF1363F-Rotating-Substrings" class="headerlink" title="CF1363F Rotating Substrings"></a>CF1363F Rotating Substrings</h2><p>ç»™å®šä¸¤ä¸ªé•¿åº¦ä¸º $n$ çš„å­—ç¬¦ä¸² $s$ï¼Œ$t$ã€‚å®šä¹‰ä¸€æ¬¡æ“ä½œä¸ºé€‰æ‹© $s$ çš„ä¸€ä¸ªå­ä¸² $s_{l, l +1, \dots, r}$<br>â€‹<br> ï¼Œç„¶åå°†ä¹‹ä¿®æ”¹ä¸º $s_{r, l, l + 1, l + 2, \dots, r - 1 }$s<br>è¯·æ±‚åŠ©ä½¿ $s$ ä¸ $t$ ç›¸ç­‰çš„æœ€å°æ“ä½œæ¬¡æ•°ã€‚æ— è§£è¾“å‡º $-1$ã€‚</p><p>$S$çš„å‰$i$ä¸ªå­—ç¬¦å’Œ$T$çš„å‰$j$ä¸ªå­—ç¬¦åŒ¹é…çš„æœ€å°èŠ±è´¹</p><p>æ¯ä¸€ä¸ªæ“ä½œå¯ä»¥è®©ä¸€ä¸ªå­—ç¬¦æåˆ°å‰é¢çš„ä»»ä½•ä½ç½®ï¼Œå¹¶ä¸èƒ½æåˆ°åˆ°åé¢ï¼Œæœ€å°‘çš„æ“ä½œæ¬¡æ•°æ˜¯$n$ - ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿å…¬å…±å­åºåˆ—ã€‚</p><p>ä½†æ˜¯å¯¹äº$acbd,adbc$ã€‚åŒ¹é…åˆ°ç¬¬ä¸‰ä¸ªå­—ç¬¦çš„æ—¶å€™ï¼Œæ˜¾ç„¶ä¸èƒ½æŠŠ$c$æ”¾åˆ°åé¢å»ã€‚è¿™ä¸ªæ—¶å€™åœ¨åšæœ€é•¿å…¬å…±å­åºåˆ—ã€‚æˆ‘ä»¬éœ€è¦åŠ ä¸Šä¸€ä¸ªæ¡ä»¶ï¼Œ$s$çš„æ¯ä¸ªå­—æ¯åç¼€æ•°é‡å¿…é¡»æ¯”$t$å¤šå³å¯ã€‚</p><h2 id="CF1408E-Avoid-Rainbow-Cycles"><a href="#CF1408E-Avoid-Rainbow-Cycles" class="headerlink" title="CF1408E Avoid Rainbow Cycles"></a>CF1408E Avoid Rainbow Cycles</h2><p>å¦‚æœæˆ‘ä¿ç•™æŸä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆè¿™ä¸ªé›†åˆå°±ä¼šå’Œæ‰€æœ‰æœ‰è¿™ä¸ªå…ƒç´ çš„ç‚¹è¿è¾¹ã€‚æˆ‘ä»¬æŠŠé›†åˆå½“æˆä¸€ä¸ªç‚¹ï¼Œé‚£ä¹ˆå½“ä¸¤ä¸ªé›†åˆåŒæ—¶é€‰æ‹©ä¸€ä¸ª$x$ï¼Œ$x$è¿é›†åˆ$A$,é›†åˆ$B$è¿$x$,$A-B$ï¼Œå³æœ€åè¦æä¸€ä¸ªæœ€å¤§ç”Ÿæˆæ ‘å³å¯ã€‚</p><h2 id="CF1408F-Two-Different"><a href="#CF1408F-Two-Different" class="headerlink" title="CF1408F Two Different"></a>CF1408F Two Different</h2><p>æ¨¡æ‹Ÿæ—¶ï¼Œæ˜¾ç„¶$2^n$çš„é•¿åº¦æš´åŠ›æ¨¡æ‹Ÿï¼Œå°±ä¼šå…¨éƒ¨å˜æˆä¸€ä¸ªã€‚ç„¶åå¯¹å‰©ä¸‹çš„è´ªå¿ƒåˆ†é…ã€‚</p><p>ä½†æ˜¯ç›´æ¥æ­£åšä¸€éï¼Œååšä¸€éå°±å¥½äº†ã€‚(æˆ‘æ˜¯å‚»é€¼)</p><h2 id="CF1422F-Boring-Queries"><a href="#CF1422F-Boring-Queries" class="headerlink" title="CF1422F Boring Queries"></a>CF1422F Boring Queries</h2><p>åœ¨çº¿åŒºé—´$lcm$</p><p>  è§£1</p><ul><li><p>å¯¹äºå°äºç­‰$\sqrt{2\cdot 10^5}$çš„è´¨å› å­ï¼Œç›´æ¥å„å¼€ä¸€ä¸ªçº¿æ®µæ ‘æš´åŠ›ç»´æŠ¤ï¼Œéœ€è¦åŠ¨æ€ä»¥åŠå¸¸æ•°ä¼˜åŒ–</p></li><li><p>å¯¹äºå¤§äº $\sqrt{2\cdot 10^5}$<br>çš„è´¨å› å­ï¼Œæ¯ä¸ªå…ƒç´ è‡³å¤šæœ‰ä¸€ä¸ªã€‚è¿™æœ‰ç‚¹åƒç»´æŠ¤åŒºé—´ä¸åŒé¢œè‰²ä¸ªæ•°ï¼Œ$\sum [last_x&lt;l]$åªä¸è¿‡æ¯ä¸ªé¢œè‰²è¿˜å¸¦äº†æƒå€¼ï¼ˆå¼ºåˆ¶åœ¨çº¿ï¼‰</p></li><li><p>ç‰ˆæœ¬$r$è¿™ä¸ªçº¿æ®µæ ‘ç»´æŠ¤çš„æ˜¯ç‚¹$x$ï¼Œç»´æŠ¤çš„æ˜¯$last[t]=x$,çš„$t$çš„æ‰€æœ‰ä¹˜ç§¯ã€‚</p><p>è§£2</p></li></ul><p>æ ¹æ®è§£$1$å»åšé¢„å¤„ç†ç¬¬ $i$ç‰ˆæœ¬çš„çº¿æ®µæ ‘æ—¶ï¼Œå°† $i$ ä½ç½®çš„æƒå€¼ä¹˜ä¸Š $a_i$çš„å¤§è´¨å› å­ï¼Œä¸ºäº†é˜²æ­¢äºŒæ¬¡è®¡ç®—ï¼Œå¹¶å°†$a_i$ä¸Šæ¬¡å‡ºç°çš„ä½ç½®é™¤æ‰è¯¥è´¨å› å­ã€‚</p><ul><li>ç‰ˆæœ¬$r$è¿™ä¸ªçº¿æ®µæ ‘ç»´æŠ¤çš„æ˜¯ä½ç½®$x$,åœ¨$[1,r]$ä¸Šçš„ä¹˜ç§¯ã€‚</li></ul><h2 id="CF1437G-Death-DBMS"><a href="#CF1437G-Death-DBMS" class="headerlink" title="CF1437G - Death DBMS"></a>CF1437G - Death DBMS</h2><p>$AC$è‡ªåŠ¨æœºä¸Šæ ‘é“¾å‰–åˆ†æœ€å¤§å€¼ï¼Œæˆ–è€…æ ‡è®°æ°¸ä¹…åŒ–çº¿æ®µæ ‘ç»´æŠ¤å­æ ‘ç‚¹çš„æœ€å¤§å€¼ã€‚</p><h2 id="CF1436F-Sum-Over-Subsets"><a href="#CF1436F-Sum-Over-Subsets" class="headerlink" title="CF1436F. Sum Over Subsets"></a>CF1436F. Sum Over Subsets</h2><p>ç”¨$jiangly$çš„è¯è¯´çœ‹åˆ°$\gcd=1$,ä¸€å®šæƒ³åˆ°è«æ¯”ä¹Œæ–¯å®¹æ–¥è¿™ç§ä¸œè¥¿ã€‚</p><p>ç„¶åæƒ³æƒ³æ²¡æœ‰é™åˆ¶å’‹åšã€‚</p><ul><li>$a_i\times a_i$äº§ç”Ÿè´¡çŒ®ã€‚é€‰æ‹©ä¸€ä¸ª$(k-1)$æ˜¯è¢«è¸¢æ‰çš„ï¼Œç„¶åéšä¾¿é€‰$2^{k-2}$</li><li>$a_i\times a_j$äº§ç”Ÿè´¡çŒ®ã€‚ï¼ˆæ˜¯æœ‰é¡ºåºçš„é‚£ç§ï¼‰ï¼Œ$2^{k-3}(k-2)[a_i,a_j\in A]+^{k-3}(k-2)[a_j\in A,a_i\in B]$ã€‚</li></ul><p>ç»´æŠ¤ä¸€ä¸‹ä¸¤ä¸ªä¹˜ç§¯çš„$\sum$å³å¯ã€‚</p><h2 id="CF1443F-Identify-the-Operations"><a href="#CF1443F-Identify-the-Operations" class="headerlink" title="CF1443F - Identify the Operations"></a>CF1443F - Identify the Operations</h2><p>å…ˆè€ƒè™‘å¦‚ä½•å¤„ç†ä¸åˆæ³•çš„æƒ…å†µã€‚æ¯æ¬¡åˆ è§‚å¯Ÿæ˜¯å¦ä¸¤è¾¹éƒ½æ˜¯ä¸éœ€è¦çš„æ•°ã€‚</p><p>æ­£è§£å…¶å®å¾ˆç®€å•ï¼Œè§‚å¯Ÿæ‹¿å‡ºæŸä¸ªæ•°ä¹‹åï¼Œæ­¤æ—¶è¿™ä¸ªæ•°å°±æˆäº†ä¸å¿…è¦çš„æ•°ã€‚å¦‚æœä¸‹æ¬¡æƒ³æ‹¿è¢«ç§»èµ°çš„æ•°ï¼Œå…¶å®é—´æ¥åœ¨æ‹¿$pos_{b_i}$ï¼Œå¹¶ä¸”ä¸€å®šæ‹¿çš„åˆ°ï¼Œç„¶åæ¨¡æ‹Ÿä¸€ä¸‹å°±æ²¡äº†ã€‚</p><h2 id="CF1443E-Long-Permutation"><a href="#CF1443E-Long-Permutation" class="headerlink" title="CF1443E - Long Permutation"></a>CF1443E - Long Permutation</h2><p>å¤§æ°´é¢˜ï¼Œé€†åº·æ‰˜å±•å¼€å¾—ç»´æŠ¤å$14$ä¸ªæ•°å°±å¥½äº†ã€‚</p><ul><li>æé†’æˆ‘è¦å‡†å¤‡ä»–ä¸¤æ¿å­äº†ã€‚ä¸¤è€…éƒ½å¯ä»¥åšåˆ°$n\log n$ã€‚</li></ul><h2 id="CF19D"><a href="#CF19D" class="headerlink" title="CF19D"></a>CF19D</h2><p>è¿™é¢˜å‘Šè¯‰æˆ‘ä»¬çº¿æ®µæ ‘ä¸ŠåŒºé—´äºŒåˆ†æ—¶é—´å¤æ‚åº¦ä¸å¤§ã€‚</p><h2 id="CF204E-Little-Elephant-and-Strings"><a href="#CF204E-Little-Elephant-and-Strings" class="headerlink" title="CF204E Little Elephant and Strings"></a>CF204E Little Elephant and Strings</h2><p>é”å®šå­—ç¬¦ä¸²çš„æ¯ä¸ª$r$,å°±å¯ä»¥çŸ¥é“è¿™ä¸ªåç¼€æ˜¯å¦å­˜åœ¨$k$ä¸ªé‡å¤ã€‚</p><p>ç„¶åæ ‡è®°ä¸‹ï¼ŒæŸä¸ªç»“ç‚¹å¯ä»¥è´¡çŒ®çš„å°±æ˜¯ç»“ç‚¹åˆ°æ ¹æœ€å¤§æœ‰æ ‡è®°çš„$len$ï¼Œçå‡ æŠŠç»´æŠ¤å³å¯ã€‚</p><hr><h1 id="æ´›è°·"><a href="#æ´›è°·" class="headerlink" title="æ´›è°·"></a>æ´›è°·</h1><h2 id="P4103-HEOI2014-å¤§å·¥ç¨‹"><a href="#P4103-HEOI2014-å¤§å·¥ç¨‹" class="headerlink" title="P4103 [HEOI2014]å¤§å·¥ç¨‹"></a>P4103 [HEOI2014]å¤§å·¥ç¨‹</h2><p>è®°å½•ä¸‹æœ€é•¿è¾¹ï¼Œæœ€å°è¾¹ï¼Œæ¬¡å°è¾¹ï¼Œæ¬¡å¤§è¾¹å³å¯,è™šæ ‘æ¨¡ç‰ˆé¢˜ã€‚</p><h2 id="P5504-JSOI2011-æŸ æª¬"><a href="#P5504-JSOI2011-æŸ æª¬" class="headerlink" title="P5504 [JSOI2011]æŸ æª¬"></a>P5504 [JSOI2011]æŸ æª¬</h2><p>ä¸€ç•ªè¯æ˜å°±å¯ä»¥å‘ç°æœ€ä¼˜çš„ä¸¤ç«¯ä¸€å®šæ˜¯ç›¸åŒæ•°ï¼Œå¦‚æœå·¦å³ç«¯ç‚¹è´å£³å¤§å°ä¸ç›¸ç­‰çš„è¯ï¼Œå¿…ç„¶æœ‰ä¸€ä¸ªç«¯ç‚¹å¯¹ç­”æ¡ˆæ²¡æœ‰è´¡çŒ®ã€‚å¹²å˜›ä¸ç›´æ¥åˆ†å¼€å‘¢ï¼Ÿ</p><p>ä¸Šå‡¸åŒ…ç»´æŠ¤å¯¹äºæ¯ä¸ª$a_i$ã€‚ç„¶åæ–œç‡ä¼˜åŒ–å³å¯å•è°ƒæ ˆï¼ˆPS:å¥½åƒæ²¡å•¥éº»çƒ¦çš„ï¼Œç”šè‡³ç›´æ¥äºŒåˆ†ä¸Šå‡¸åŒ…ä¹Ÿå¯ä»¥ï¼‰ã€‚</p><hr><h1 id="Atcoder"><a href="#Atcoder" class="headerlink" title="Atcoder"></a>Atcoder</h1><h2 id="AtCoder-Grand-Contest-048"><a href="#AtCoder-Grand-Contest-048" class="headerlink" title="AtCoder Grand Contest 048"></a>AtCoder Grand Contest 048</h2><h2 id="ACL-Beginner-Contest"><a href="#ACL-Beginner-Contest" class="headerlink" title="ACL Beginner Contest"></a>ACL Beginner Contest</h2><h3 id="F-Heights-and-Pairs"><a href="#F-Heights-and-Pairs" class="headerlink" title="F - Heights and Pairs"></a>F - Heights and Pairs</h3><p>å®¹æ–¥æ˜¯æ˜¾ç„¶çš„ã€‚$f(i)$è¡¨ç¤ºä¿è¯$i$å¯¹ç›¸åŒçš„ç­”æ¡ˆã€‚$g(i)$è¡¨ç¤ºéšä¾¿é€‰$i$äººæˆå¯¹çš„æ•°é‡ã€‚$z(i)$è¡¨ç¤ºé€‰$i$å¯¹æƒ…ä¾£çš„æ–¹æ³•ã€‚</p><p>å¯¹äºæ¯ç§$h_i$æˆ‘ä»¬å¯ä»¥è®¡ç®—å‡ºé€‰å‡º$i$å¯¹çš„æ–¹æ³•,å˜æˆå¤šé¡¹å¼å°±æ˜¯$(k_0x^0+k_1x_1+k_2x^2â€¦)$ï¼Œå¯å‘å¼$NTT$å³å¯ã€‚</p><p>$g(i)=g(i-2)\times C_{i-2}^2/(i/2)$</p><p>$f(i)=g(2n-2i)z(i)$</p><p>$ans=f(0)-f(1)+f(2)-f(3)â€¦$</p><p>å½“ç„¶æƒ³è¦æƒ³çš„æ›´å¿«ï¼ŒäºŒé¡¹å¼åæ¼”å°±ä¸ç”¨æ€è€ƒäº†ã€‚ï¼ˆæ˜¾ç„¶æˆ‘è¦å¤ä¹ ä¸‹ï¼‰</p><hr><h1 id="ç‰›å®¢"><a href="#ç‰›å®¢" class="headerlink" title="ç‰›å®¢"></a>ç‰›å®¢</h1><h2 id="ICPCå°ç±³é‚€è¯·èµ›2"><a href="#ICPCå°ç±³é‚€è¯·èµ›2" class="headerlink" title="ICPCå°ç±³é‚€è¯·èµ›2"></a>ICPCå°ç±³é‚€è¯·èµ›2</h2><h3 id="A-2020"><a href="#A-2020" class="headerlink" title="A.2020"></a>A.2020</h3><p>èµ›æ—¶æ²¡åšï¼Œè€ƒè™‘äºŒåˆ†ï¼Œå…ˆå®‰æ’å‰$k$ä¸ªå†å®‰æ’å$k$ä¸ªï¼Œå°±æ²¡äº†ã€‚</p><h3 id="I-Subsequence-Pair"><a href="#I-Subsequence-Pair" class="headerlink" title="I.Subsequence Pair"></a>I.Subsequence Pair</h3><p>è„‘å­è¿›æ°´é¢˜ï¼Œæƒ³åˆ°$lcs$ç„¶åï¼Œé—®é©¬è€å¸ˆï¼šè¯´ä¸éœ€è¦$LCS$ã€‚</p><p>å…¶å®å°±æ˜¯$lcs$è£¸é¢˜ã€‚</p><ul><li>$\max(dp_{i,j}+m-j)$,å…¬å…±ä¸€æ ·ç›´æ¥è´ªå¿ƒæŸ“$t$å–æœ€é•¿ã€‚</li><li>$\max(dp_{i-1,j-1}+m-j-1+n-j-1)$ï¼Œå¦‚æœå‘ç°$s_i&lt;t_j$,å‘ç°å–å®Œä¹‹åå°±éšä¾¿å–äº†ã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;é¸½å­çš„é¢˜è§£å¤ªå¤šäº†ã€‚åªå¥½ç›´æ¥å†™ã€‚&lt;br&gt;&lt;!-- TOC --&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#gym&quot;&gt;GYM&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#2019-ccpc-å“ˆå°”æ»¨&quot;&gt;2019-CCPC-å“ˆå°”æ»¨&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#b-binary-numbers&quot;&gt;B. Binary Numbers&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#e-exchanging-gifts&quot;&gt;E. Exchanging Gifts&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#i-interesting-permutation&quot;&gt;I. Interesting Permutation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#l-lru-algorithm&quot;&gt;L. LRU Algorithm&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#300iq-contest-1&quot;&gt;300iq Contest 1&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#bbest-subsequence&quot;&gt;B.Best Subsequence&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#ccool-pairs&quot;&gt;C.Cool Pairs&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#d-dates&quot;&gt;D. Dates&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#f-free-edges&quot;&gt;F. Free Edges&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#k-knowledge&quot;&gt;K. Knowledge&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#icpc-asia-east-continent-final&quot;&gt;ICPC Asia-East Continent Final&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#hking&quot;&gt;H.King&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#é›…ç¤¼é›†è®­&quot;&gt;é›…ç¤¼é›†è®­&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#loj6029-é›…ç¤¼é›†è®­-2017-day1å¸‚åœº&quot;&gt;LOJ6029. ã€Œé›…ç¤¼é›†è®­ 2017 Day1ã€å¸‚åœº&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#loj6030-é›…ç¤¼é›†è®­-2017-day1çŸ©é˜µ&quot;&gt;LOJ6030. ã€Œé›…ç¤¼é›†è®­ 2017 Day1ã€çŸ©é˜µ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#loj6031-é›…ç¤¼é›†è®­-2017-day1å­—ç¬¦ä¸²&quot;&gt;LOJ6031. ã€Œé›…ç¤¼é›†è®­ 2017 Day1ã€å­—ç¬¦ä¸²&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#loj6032-é›…ç¤¼é›†è®­-2017-day2æ°´ç®±&quot;&gt;LOJ6032. ã€Œé›…ç¤¼é›†è®­ 2017 Day2ã€æ°´ç®±&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#loj6033-é›…ç¤¼é›†è®­-2017-day2æ£‹ç›˜æ¸¸æˆ&quot;&gt;LOJ6033. ã€Œé›…ç¤¼é›†è®­ 2017 Day2ã€æ£‹ç›˜æ¸¸æˆ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#loj6034-é›…ç¤¼é›†è®­-2017-day2çº¿æ®µæ¸¸æˆ&quot;&gt;LOJ6034. ã€Œé›…ç¤¼é›†è®­ 2017 Day2ã€çº¿æ®µæ¸¸æˆ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#loj6035-é›…ç¤¼é›†è®­-2017-day4æ´—è¡£æœ&quot;&gt;LOJ6035. ã€Œé›…ç¤¼é›†è®­ 2017 Day4ã€æ´—è¡£æœ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#loj6036-é›…ç¤¼é›†è®­-2017-day4ç¼–ç &quot;&gt;LOJ6036. ã€Œé›…ç¤¼é›†è®­ 2017 Day4ã€ç¼–ç &lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#codeforces&quot;&gt;Codeforces&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#cf1358f-tasty-cookie&quot;&gt;CF1358F Tasty Cookie&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#cf1367f2-flying-sort-hard-version&quot;&gt;CF1367F2 Flying Sort (Hard Version)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#cf1368e-ski-accidents&quot;&gt;CF1368E Ski Accidents&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#cf1374e2-reading-books-hard-version&quot;&gt;CF1374E2 Reading Books (hard version)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#cf1380g-circular-dungeon&quot;&gt;CF1380G Circular Dungeon&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#cf1384d-gamegame&quot;&gt;CF1384D. GameGame&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#cf1387b1-village-minimum&quot;&gt;CF1387B1 Village (Minimum)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#cf1387b2-village-maximum&quot;&gt;CF1387B2 Village (Maximum)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#cf1399e2-weights-division-hard-version&quot;&gt;CF1399E2 Weights Division (hard version)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#cf1354c2-not-so-simple-polygon-embedding&quot;&gt;CF1354C2. Not So Simple Polygon Embedding&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#cf1354f-summoning-minions&quot;&gt;CF1354F. Summoning Minions&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#cf1354g-find-a-gift&quot;&gt;CF1354G. Find a Gift&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#cf1421e-swedish-heroes&quot;&gt;CF1421E. Swedish Heroes&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#cf1353f-decreasing-heights&quot;&gt;CF1353F. Decreasing Heights&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#cf1353e-k-periodic-garland&quot;&gt;CF1353E. K-periodic Garland&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#cf1427e--xum&quot;&gt;CF1427E . Xum&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#cf1344drÃ©sumÃ©-review&quot;&gt;CF1344D.RÃ©sumÃ© Review&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#cf1344c-quantifier-question&quot;&gt;CF1344C Quantifier Question&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#cf1363f-rotating-substrings&quot;&gt;CF1363F Rotating Substrings&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#cf1408e-avoid-rainbow-cycles&quot;&gt;CF1408E Avoid Rainbow Cycles&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#cf1408f-two-different&quot;&gt;CF1408F Two Different&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#cf1422f-boring-queries&quot;&gt;CF1422F Boring Queries&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#cf1437g---death-dbms&quot;&gt;CF1437G - Death DBMS&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#cf1436f-sum-over-subsets&quot;&gt;CF1436F. Sum Over Subsets&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#cf1443f---identify-the-operations&quot;&gt;CF1443F - Identify the Operations&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#cf1443e---long-permutation&quot;&gt;CF1443E - Long Permutation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#cf19d&quot;&gt;CF19D&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#cf204e-little-elephant-and-strings&quot;&gt;CF204E Little Elephant and Strings&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#æ´›è°·&quot;&gt;æ´›è°·&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#p4103-heoi2014å¤§å·¥ç¨‹&quot;&gt;P4103 [HEOI2014]å¤§å·¥ç¨‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#p5504-jsoi2011æŸ æª¬&quot;&gt;P5504 [JSOI2011]æŸ æª¬&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#atcoder&quot;&gt;Atcoder&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#atcoder-grand-contest-048&quot;&gt;AtCoder Grand Contest 048&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#acl-beginner-contest&quot;&gt;ACL Beginner Contest&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#f---heights-and-pairs&quot;&gt;F - Heights and Pairs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#ç‰›å®¢&quot;&gt;ç‰›å®¢&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#icpcå°ç±³é‚€è¯·èµ›2&quot;&gt;ICPCå°ç±³é‚€è¯·èµ›2&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#a2020&quot;&gt;A.2020&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#isubsequence-pair&quot;&gt;I.Subsequence Pair&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- /TOC --&gt;
    
    </summary>
    
    
    
      <category term="è®­ç»ƒè®°å½•" scheme="http://yoursite.com/tags/%E8%AE%AD%E7%BB%83%E8%AE%B0%E5%BD%95/"/>
    
  </entry>
  
  <entry>
    <title>AT4132 [ARC097C] Sorted and Sorted</title>
    <link href="http://yoursite.com/2020/12/06/ARC097C/"/>
    <id>http://yoursite.com/2020/12/06/ARC097C/</id>
    <published>2020-12-06T02:47:00.000Z</published>
    <updated>2020-12-06T04:09:12.203Z</updated>
    
    <content type="html"><![CDATA[<p>æœ‰ $2N$ä¸ªçƒæ’æˆä¸€åˆ—ï¼Œå…¶ä¸­æœ‰$N$ä¸ªé»‘çƒä¸ $N$ ä¸ªç™½çƒã€‚æŠŠ $1$ åˆ° $N$ è¿™ $N$ä¸ªæ•°å­—åˆ†åˆ«å†™åˆ° $N$ ä¸ªé»‘çƒä¸Šï¼›ç™½çƒäº¦ç„¶ã€‚å·¦èµ·ç¬¬ $i$ ä¸ªçƒä¸Šçš„å†™çš„æ•°å­—æ˜¯ $a_i$ï¼Œé¢œè‰²æ˜¯ $c_i$ã€‚</p><p> $B$ æ˜¯é»‘çƒï¼Œä¸º $W$ æ˜¯ç™½çƒã€‚</p><p>å®šä¹‰ä¸€æ¬¡æ“ä½œä¸ºäº¤æ¢ä¸¤ä¸ªç›¸é‚»çš„çƒã€‚ä½ éœ€è¦æ±‚å‡ºæœ€å°‘çš„æ“ä½œä½¿å¾—åºåˆ—ä¸­</p><a id="more"></a><p>è€ƒè™‘ä¸€ä¸ªæ•°çš„äº¤æ¢æ¬¡æ•°å°±æ˜¯ä»–çš„é€†åºå¯¹ï¼Œä½†æ˜¯è¿™é‡Œå¹¶æ²¡æœ‰ç¡®å®šæ¯”ä»–å°çš„æ•°ã€‚æ— æ³•ç›´æ¥è®¡ç®—å¯å¾—</p><p>é‚£ä¹ˆæ˜¾ç„¶å¯ä»¥è®¾$dp[i][j]$è¡¨ç¤ºæŠŠå‰$i$ä¸ªç™½çƒæ”¾å¥½ï¼Œå‰$j$ä¸ªé»‘çƒï¼Œé‚£ä¹ˆåŠ å…¥æˆ‘æ”¾$i$è¿™ä¸ªç™½çƒï¼Œé‚£ä¹ˆ$i-1$ä¸ªç™½çƒä»¥åŠ$j$ä¸ªé»‘çƒå°±æ˜¯æ¯”ä»–å°çš„ï¼Œè¿™æ ·å°±å¯ä»¥è®¡ç®—å‡ºé€†åºå¯¹äº†ã€‚åŒç†é»‘çƒä¹Ÿæ˜¯ã€‚</p><ul><li>$i-1$ä¸ªç™½çƒä»¥åŠ$j$ä¸ªé»‘çƒå°±æ˜¯æ¯”ä»–å°çš„å¯ä»¥é¢„å¤„ç†å°±è§£å†³äº†ã€‚</li></ul><details>  <summary>ä»£ç </summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    vector&lt;pair&lt;char, int&gt;&gt; a(2 * n + 1);</span><br><span class="line">    vector&lt;int&gt; pw(n + 1), pb(n + 1);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">2</span> * n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; a[i].first &gt;&gt; a[i].second;</span><br><span class="line">        <span class="keyword">if</span> (a[i].first == <span class="string">'W'</span>)</span><br><span class="line">            pw[a[i].second] = i;</span><br><span class="line">        <span class="keyword">if</span> (a[i].first == <span class="string">'B'</span>)</span><br><span class="line">            pb[a[i].second] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; <span class="title">cw</span><span class="params">(<span class="number">2</span> * n + <span class="number">1</span>, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(n + <span class="number">1</span>))</span></span>;</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; <span class="title">cb</span><span class="params">(<span class="number">2</span> * n + <span class="number">1</span>, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(n + <span class="number">1</span>))</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">2</span> * n; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            cw[i][j] = cw[i - <span class="number">1</span>][j] + (a[i - <span class="number">1</span>].second &gt; j &amp;&amp; a[i - <span class="number">1</span>].first == <span class="string">'W'</span>);</span><br><span class="line">            cb[i][j] = cb[i - <span class="number">1</span>][j] + (a[i - <span class="number">1</span>].second &gt; j &amp;&amp; a[i - <span class="number">1</span>].first == <span class="string">'B'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; <span class="title">dp</span><span class="params">(n + <span class="number">1</span>, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(n + <span class="number">1</span>, <span class="number">1e9</span>))</span></span>;</span><br><span class="line">    dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> x = pw[i], y = pb[j];</span><br><span class="line">            <span class="keyword">if</span> (i)</span><br><span class="line">                dp[i][j] = <span class="built_in">min</span>(dp[i][j], dp[i - <span class="number">1</span>][j] + cw[x][i] + cb[x][j]);</span><br><span class="line">            <span class="keyword">if</span> (j)</span><br><span class="line">                dp[i][j] = <span class="built_in">min</span>(dp[i][j], dp[i][j - <span class="number">1</span>] + cw[y][i] + cb[y][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; dp[n][n] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>  </details>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ‰ $2N$ä¸ªçƒæ’æˆä¸€åˆ—ï¼Œå…¶ä¸­æœ‰$N$ä¸ªé»‘çƒä¸ $N$ ä¸ªç™½çƒã€‚æŠŠ $1$ åˆ° $N$ è¿™ $N$ä¸ªæ•°å­—åˆ†åˆ«å†™åˆ° $N$ ä¸ªé»‘çƒä¸Šï¼›ç™½çƒäº¦ç„¶ã€‚å·¦èµ·ç¬¬ $i$ ä¸ªçƒä¸Šçš„å†™çš„æ•°å­—æ˜¯ $a_i$ï¼Œé¢œè‰²æ˜¯ $c_i$ã€‚&lt;/p&gt;
&lt;p&gt; $B$ æ˜¯é»‘çƒï¼Œä¸º $W$ æ˜¯ç™½çƒã€‚&lt;/p&gt;
&lt;p&gt;å®šä¹‰ä¸€æ¬¡æ“ä½œä¸ºäº¤æ¢ä¸¤ä¸ªç›¸é‚»çš„çƒã€‚ä½ éœ€è¦æ±‚å‡ºæœ€å°‘çš„æ“ä½œä½¿å¾—åºåˆ—ä¸­&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="dp" scheme="http://yoursite.com/tags/dp/"/>
    
  </entry>
  
  <entry>
    <title>CF603E - Pastoral Oddities</title>
    <link href="http://yoursite.com/2020/12/06/CF603E/"/>
    <id>http://yoursite.com/2020/12/06/CF603E/</id>
    <published>2020-12-06T02:47:00.000Z</published>
    <updated>2020-12-06T04:09:11.847Z</updated>
    
    <content type="html"><![CDATA[<ul><li>ç»™å®šä¸€å¼  $n$ä¸ªç‚¹çš„æ— å‘å›¾ï¼Œåˆå§‹æ²¡æœ‰è¾¹ã€‚</li><li>ä¾æ¬¡åŠ å…¥$m$æ¡å¸¦æƒçš„è¾¹ï¼Œæ¯æ¬¡åŠ å…¥åè¯¢é—®æ˜¯å¦å­˜åœ¨ä¸€ä¸ªè¾¹é›†ï¼Œæ»¡è¶³æ¯ä¸ªç‚¹çš„åº¦æ•°å‡ä¸ºå¥‡æ•°ã€‚</li><li>è‹¥å­˜åœ¨ï¼Œåˆ™è¿˜éœ€è¦æœ€å°åŒ–è¾¹é›†ä¸­çš„æœ€å¤§è¾¹æƒã€‚</li><li>$n \le 10^5,m\leq 3\times 10^5 $</li></ul><a id="more"></a><p>è€ƒè™‘é™æ€å›¾ï¼Œæ˜¾ç„¶é¦–å…ˆæ»¡è¶³è”é€šå—ç‚¹æ•°ä¸ºå¶æ•°ã€‚</p><p>è€ƒè™‘å½“å‰å›¾ä¹Ÿå¿…é¡»è”é€šå—æ˜¯å¶æ•°ç‚¹ï¼Œï¼ˆå› ä¸ºå»è¾¹ä¹‹ååˆ†è£‚æˆè”é€šä¹Ÿè¦æ»¡è¶³å¶æ•°ç‚¹)ã€‚</p><p>æœ€å°åŒ–è¾¹é›†ä¸­çš„æœ€å¤§è¾¹æƒï¼Œè€ƒè™‘ç»´æŠ¤æœ€å°ç”Ÿæˆæ ‘ã€‚</p><p>å¦‚æœçº¯é™æ€ï¼Œæˆ‘ä»¬å¯ä»¥ä»å¶å­èŠ‚ç‚¹ç±»ä¼¼é€’æ¨é€‰æ‹©å°½é‡å°‘çš„è¾¹ã€‚è¿™æ ·æ˜¾ç„¶æ˜¯å¯ä»¥æœ‰è§£.</p><p>ä½†æ˜¯è¿™ä¸ªæ—¶å€™æˆ‘ä»¬ä»ç„¶æ²¡æœ‰é€‰å‡ºæœ€ä¼˜è§£ã€‚</p><p>ç$JB$ä¹±ç”»å‘ç°ï¼Œåˆ æ‰çš„è¾¹éƒ½æ˜¯åˆ†è£‚æˆ$å¥‡+å¥‡$çš„ï¼Œæˆ‘ä»¬ä¸æ–­åœ°å°è¯•åˆ é™¤å½“å‰æ£®æ—ä¸­è¾¹æƒæœ€å¤§çš„è¾¹ï¼Œè”é€šå—å°±ä¼šåˆ†è£‚ï¼Œå¦‚æœäº§ç”Ÿåˆ†è£‚æˆ$å¥‡+å¥‡$ï¼Œè¡¨ç¤ºè¿™ä¸ªè¾¹ä¸èƒ½åˆ ï¼Œè¿™é‡Œçš„æ“ä½œç”¨å¤§æ ¹å †ä»¥åŠæ‡’æƒ°è®°å·è¡¨ç¤ºã€‚</p><p>ç„¶åç”¨$LCT$å­æ ‘ç»´æŠ¤ä¸€ä¸‹å¥‡æ•°çš„è”é€šå—æœ‰å¤šå°‘ã€‚</p><details>  <summary>ä»£ç </summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4e5</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> u, v, w;</span><br><span class="line">    Edge()&#123;&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LCT</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ls son[pos][0]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rs son[pos][1]</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> fa[N], root, tcnt;</span><br><span class="line">    <span class="keyword">int</span> son[N][<span class="number">2</span>];</span><br><span class="line">    pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; mx[N], val[N];</span><br><span class="line">    <span class="keyword">int</span> exsiz[N], si[N], siz[N];</span><br><span class="line">    <span class="keyword">int</span> rev[N];</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> pos)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        mx[pos] = <span class="built_in">max</span>(val[pos], <span class="built_in">max</span>(mx[ls], mx[rs]));</span><br><span class="line">        siz[pos] = siz[ls] + siz[rs] + exsiz[pos] + si[pos];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isroot</span><span class="params">(<span class="keyword">int</span> pos)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> pos != son[fa[pos]][<span class="number">0</span>] &amp;&amp; pos != son[fa[pos]][<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addrev</span><span class="params">(<span class="keyword">int</span> pos)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        rev[pos] ^= <span class="number">1</span>;</span><br><span class="line">        swap(son[pos][<span class="number">0</span>], son[pos][<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">int</span> pos)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (rev[pos])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (son[pos][<span class="number">1</span>])</span><br><span class="line">                addrev(son[pos][<span class="number">1</span>]);</span><br><span class="line">            <span class="keyword">if</span> (son[pos][<span class="number">0</span>])</span><br><span class="line">                addrev(son[pos][<span class="number">0</span>]);</span><br><span class="line">            rev[pos] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isson</span><span class="params">(<span class="keyword">int</span> pos)</span> </span>&#123; <span class="keyword">return</span> pos == son[fa[pos]][<span class="number">1</span>]; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">conect</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> d, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        son[x][d] = y;</span><br><span class="line">        fa[y] = x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">rorate</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> y = fa[x], z = fa[y], dx = isson(x), dy = isson(y);</span><br><span class="line"></span><br><span class="line">        fa[x] = z;</span><br><span class="line">        <span class="keyword">if</span> (!isroot(y))</span><br><span class="line">            son[z][dy] = x;</span><br><span class="line">        <span class="comment">//conect(z, dy, x);</span></span><br><span class="line">        conect(y, dx, son[x][dx ^ <span class="number">1</span>]);</span><br><span class="line">        conect(x, dx ^ <span class="number">1</span>, y);</span><br><span class="line">        pushup(y), pushup(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> st[N];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> top;</span><br><span class="line">        st[top = <span class="number">1</span>] = x;</span><br><span class="line">        <span class="keyword">int</span> u = x;</span><br><span class="line">        <span class="keyword">while</span> (!isroot(u))</span><br><span class="line">            u = fa[u], st[++top] = u;</span><br><span class="line">        <span class="keyword">while</span> (top)</span><br><span class="line">            pushdown(st[top--]);</span><br><span class="line">        <span class="keyword">while</span> (!isroot(x))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> y = fa[x];</span><br><span class="line">            <span class="keyword">if</span> (isroot(y))</span><br><span class="line">            &#123;</span><br><span class="line">                rorate(x);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (isson(x) == isson(y))</span><br><span class="line">                rorate(y), rorate(x);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                rorate(x), rorate(x);</span><br><span class="line">        &#125;</span><br><span class="line">        pushup(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">access</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; x; i = x, x = fa[x])</span><br><span class="line">        &#123;</span><br><span class="line">            splay(x), exsiz[x] -= siz[i], exsiz[x] += siz[son[x][<span class="number">1</span>]], son[x][<span class="number">1</span>] = i, pushup(x);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">makeroot</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        access(x), splay(x), addrev(x); <span class="comment">// access ä¹‹åå°†æ²¡æœ‰å³å­æ ‘ã€‚ç„¶åæŠŠxå˜æˆæ ¹ï¼ŒæŠŠä¸‹é¢éƒ½ç¿»è½¬ï¼Œè¿™æ ·xå°±æ˜¯æœ€å°çš„å…ƒç´ äº†ã€‚</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">findroot</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        access(x), splay(x);</span><br><span class="line">        <span class="keyword">while</span> (son[x][<span class="number">0</span>])</span><br><span class="line">            pushdown(x), x = son[x][<span class="number">0</span>];</span><br><span class="line">        splay(x);</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">split</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        makeroot(x);</span><br><span class="line">        access(y);</span><br><span class="line">        splay(y);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">link</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        split(x, y);</span><br><span class="line">        cnt -= siz[x] &amp; <span class="number">1</span>;</span><br><span class="line">        cnt -= siz[y] &amp; <span class="number">1</span>;</span><br><span class="line">        fa[x] = y;</span><br><span class="line">        exsiz[y] += siz[x];</span><br><span class="line">        pushup(y);</span><br><span class="line">        cnt += siz[y] &amp; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">cut</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        split(x, y);</span><br><span class="line">        fa[x] = <span class="number">0</span>;</span><br><span class="line">        son[y][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        cnt -= siz[y] &amp; <span class="number">1</span>;</span><br><span class="line">        pushup(y);</span><br><span class="line">        cnt += siz[x] &amp; <span class="number">1</span>;</span><br><span class="line">        cnt += siz[y] &amp; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m, <span class="built_in">vector</span>&lt;Edge&gt; tmp)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            si[i] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">            val[i + n] = mx[i + n] = &#123;tmp[i].w, i&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m, <span class="built_in">vector</span>&lt;Edge&gt; tmp)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cnt = n;</span><br><span class="line">        <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">vis</span><span class="params">(m + <span class="number">1</span>)</span></span>;</span><br><span class="line">        priority_queue&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; q;</span><br><span class="line">        <span class="keyword">auto</span> add = [&amp;](<span class="keyword">int</span> i) &#123;</span><br><span class="line">            <span class="keyword">int</span> u = tmp[i].u, v = tmp[i].v, w = tmp[i].w;</span><br><span class="line">            <span class="keyword">bool</span> flag = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (findroot(u) == findroot(v))</span><br><span class="line">            &#123;</span><br><span class="line">                split(u, v);</span><br><span class="line">                <span class="keyword">auto</span> o = mx[v];</span><br><span class="line">                <span class="keyword">if</span> (o.first &gt; w)</span><br><span class="line">                &#123;</span><br><span class="line">                    cut(n + o.second, tmp[o.second].u);</span><br><span class="line">                    cut(n + o.second, tmp[o.second].v);</span><br><span class="line">                    vis[o.second] = <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    flag = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (flag)</span><br><span class="line">            &#123;</span><br><span class="line">                link(i + n, u), link(i + n, v);</span><br><span class="line">                q.push(&#123;tmp[i].w, i&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//  cout &lt;&lt; cnt &lt;&lt; "!!!" &lt;&lt; endl;</span></span><br><span class="line">            <span class="keyword">if</span> (cnt)</span><br><span class="line">                <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (q.<span class="built_in">size</span>())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">int</span> o = q.top().second;</span><br><span class="line">                q.pop();</span><br><span class="line">                <span class="keyword">if</span> (vis[o])</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                cut(tmp[o].u, o + n);</span><br><span class="line">                cut(tmp[o].v, o + n);</span><br><span class="line">                <span class="comment">// cout &lt;&lt; o &lt;&lt; " " &lt;&lt; cnt &lt;&lt; endl;</span></span><br><span class="line">                <span class="keyword">if</span> (cnt)</span><br><span class="line">                &#123;</span><br><span class="line">                    link(tmp[o].u, o + n), link(tmp[o].v, o + n);</span><br><span class="line">                    q.push(&#123;tmp[o].w, o&#125;);</span><br><span class="line">                    <span class="keyword">return</span> tmp[o].w;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; add(i) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; t;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;Edge&gt; <span class="title">e</span><span class="params">(m + <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; e[i].u &gt;&gt; e[i].v &gt;&gt; e[i].w;</span><br><span class="line">    t.init(n, m, e);</span><br><span class="line">    t.solve(n, m, e);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>  </details>]]></content>
    
    <summary type="html">
    
      &lt;ul&gt;
&lt;li&gt;ç»™å®šä¸€å¼  $n$ä¸ªç‚¹çš„æ— å‘å›¾ï¼Œåˆå§‹æ²¡æœ‰è¾¹ã€‚&lt;/li&gt;
&lt;li&gt;ä¾æ¬¡åŠ å…¥$m$æ¡å¸¦æƒçš„è¾¹ï¼Œæ¯æ¬¡åŠ å…¥åè¯¢é—®æ˜¯å¦å­˜åœ¨ä¸€ä¸ªè¾¹é›†ï¼Œæ»¡è¶³æ¯ä¸ªç‚¹çš„åº¦æ•°å‡ä¸ºå¥‡æ•°ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥å­˜åœ¨ï¼Œåˆ™è¿˜éœ€è¦æœ€å°åŒ–è¾¹é›†ä¸­çš„æœ€å¤§è¾¹æƒã€‚&lt;/li&gt;
&lt;li&gt;$n \le 10^5,m\leq 3\times 10^5 $&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
    
      <category term="LCT" scheme="http://yoursite.com/tags/LCT/"/>
    
  </entry>
  
  <entry>
    <title>SP11470 TTM - To the moon</title>
    <link href="http://yoursite.com/2020/11/01/SP11470/"/>
    <id>http://yoursite.com/2020/11/01/SP11470/</id>
    <published>2020-11-01T02:47:00.000Z</published>
    <updated>2020-11-04T05:10:09.187Z</updated>
    
    <content type="html"><![CDATA[<p>å¯æŒç»­åŒ–çº¿æ®µæ ‘çš„åŒºé—´åŠ å‡ã€‚</p><a id="more"></a><p>å¦‚æœç”¨<strong>lazy</strong>æ ‡è®°çš„åŒ–ï¼Œå‘ç°ä¸¤ä¸ªç‰ˆæœ¬çš„çº¿æ®µæ ‘å…±ç”¨çš„èŠ‚ç‚¹ä¸èƒ½ä¿®æ”¹å€¼ã€‚</p><p>è¿™æ—¶å€™æ ‡è®°æ°¸ä¹…åŒ–å°±ä¸Šåœºäº†ã€‚</p><p>æ ‡è®°æ°¸ä¹…åŒ–æ—¢ä¸éœ€è¦ä¸‹ä¼ æ ‡è®°ï¼Œä¹Ÿä¸éœ€è¦é€šè¿‡å­èŠ‚ç‚¹æ›´æ–°è‡ªå·±ã€‚</p><ul><li>å¯¹äºæ›´æ–°ï¼Œæ›´æ–°ä¸€è·¯ä¸Šçš„<strong>å€¼</strong>ã€‚ç„¶ååœ¨æœ€åº•å±‚å®Œå…¨è¦†ç›–çš„èŠ‚ç‚¹ä¸Šæ‰“ä¸Šæ ‡è®°ã€‚</li><li>å¯¹äºæŸ¥è¯¢ï¼Œæ›´æ–°ä¸€è·¯çš„<strong>æ ‡è®°</strong>,æœ€ååŠ ä¸Šæœ€åº•å±‚çš„å€¼ã€‚</li></ul><p>æ³¨æ„å¤šæ€è€ƒç»†èŠ‚å°±å¥½äº†ã€‚</p><details>  <summary>ä»£ç </summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pii pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk make_pair</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SustainedTree</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> scnt;</span><br><span class="line">    ll sum[N &lt;&lt; <span class="number">5</span>], tag[N &lt;&lt; <span class="number">5</span>];</span><br><span class="line">    <span class="keyword">int</span> ls[N &lt;&lt; <span class="number">5</span>], rs[N &lt;&lt; <span class="number">5</span>];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> &amp;pos, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        pos = ++scnt;</span><br><span class="line">        <span class="keyword">if</span> (l == r)</span><br><span class="line">        &#123;</span><br><span class="line">            sum[pos] = a[l];</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        build(ls[pos], l, mid), build(rs[pos], mid + <span class="number">1</span>, r);</span><br><span class="line">        sum[pos] = sum[ls[pos]] + sum[rs[pos]];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> &amp;pos, <span class="keyword">int</span> pre, <span class="keyword">int</span> ql, <span class="keyword">int</span> qr, <span class="keyword">int</span> v, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        pos = ++scnt;</span><br><span class="line">        sum[pos] = sum[pre], tag[pos] = tag[pre], ls[pos] = ls[pre], rs[pos] = rs[pre];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr)</span><br><span class="line">        &#123;</span><br><span class="line">            tag[pos] += v;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        sum[pos] += <span class="number">1l</span>l * v * (<span class="built_in">min</span>(qr, r) - <span class="built_in">max</span>(ql, l) + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (ql &lt;= mid)</span><br><span class="line">            update(ls[pos], ls[pre], ql, qr, v, l, mid);</span><br><span class="line">        <span class="keyword">if</span> (qr &gt; mid)</span><br><span class="line">            update(rs[pos], rs[pre], ql, qr, v, mid + <span class="number">1</span>, r);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> pos, <span class="keyword">int</span> ql, <span class="keyword">int</span> qr, <span class="keyword">int</span> l, <span class="keyword">int</span> r, ll &amp;res)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        res += <span class="number">1l</span>l * tag[pos] * (<span class="built_in">min</span>(qr, r) - <span class="built_in">max</span>(ql, l) + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr)</span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            res += sum[pos];</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (ql &lt;= mid)</span><br><span class="line">            query(ls[pos], ql, qr, l, mid, res);</span><br><span class="line">        <span class="keyword">if</span> (qr &gt; mid)</span><br><span class="line">            query(rs[pos], ql, qr, mid + <span class="number">1</span>, r, res);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; t;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">0</span>, f = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">char</span> c = getchar();</span><br><span class="line">    <span class="keyword">while</span> (c &lt; <span class="string">'0'</span> || c &gt; <span class="string">'9'</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="string">'-'</span>)</span><br><span class="line">            f = <span class="number">-1</span>;</span><br><span class="line">        c = getchar();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>)</span><br><span class="line">        x = (x &lt;&lt; <span class="number">1</span>) + (x &lt;&lt; <span class="number">3</span>) + c - <span class="string">'0'</span>, c = getchar();</span><br><span class="line">    <span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> rt[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = <span class="built_in">read</span>(), m = <span class="built_in">read</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        a[i] = <span class="built_in">read</span>();</span><br><span class="line">    t.build(rt[<span class="number">0</span>], <span class="number">1</span>, n);</span><br><span class="line">    <span class="keyword">int</span> now = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">char</span> s[<span class="number">5</span>];</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);</span><br><span class="line">        <span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'B'</span>)</span><br><span class="line">            now = <span class="built_in">read</span>();</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'C'</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> l = <span class="built_in">read</span>(), r = <span class="built_in">read</span>(), d = <span class="built_in">read</span>();</span><br><span class="line">            t.update(rt[now + <span class="number">1</span>], rt[now], l, r, d, <span class="number">1</span>, n);</span><br><span class="line">            now++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'Q'</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> l = <span class="built_in">read</span>(), r = <span class="built_in">read</span>();</span><br><span class="line">            ll res = <span class="number">0</span>;</span><br><span class="line">            t.query(rt[now], l, r, <span class="number">1</span>, n, res);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, res);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'H'</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> l = <span class="built_in">read</span>(), r = <span class="built_in">read</span>(), z = <span class="built_in">read</span>();</span><br><span class="line">            ll res = <span class="number">0</span>;</span><br><span class="line">            t.query(rt[z], l, r, <span class="number">1</span>, n, res);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, res);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>  </details>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¯æŒç»­åŒ–çº¿æ®µæ ‘çš„åŒºé—´åŠ å‡ã€‚&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="æ ‡è®°æ°¸ä¹…åŒ–" scheme="http://yoursite.com/tags/%E6%A0%87%E8%AE%B0%E6%B0%B8%E4%B9%85%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>CF1430F Realistic Gameplay</title>
    <link href="http://yoursite.com/2020/10/31/CF1430F/"/>
    <id>http://yoursite.com/2020/10/31/CF1430F/</id>
    <published>2020-10-31T02:47:00.000Z</published>
    <updated>2020-11-04T05:54:53.851Z</updated>
    
    <content type="html"><![CDATA[<p>æœ‰$n$æ³¢æ€ªç‰©ï¼Œä½ æœ‰ä¸€æŠŠæªï¼Œæªçš„å¼¹å¤¹é‡ä¸º$k$ï¼Œç¬¬$i,[l_i,r_i]$æ³¢æ€ªç‰©æ•°é‡ä¸º$a_i$ï¼Œä½¿ç”¨å­å¼¹ä¸è´¹æ—¶é—´ï¼Œä½†æ˜¯ä½ æ¯æ¬¡æ¢å¼¹éƒ½éœ€è¦å°†å¼¹å¤¹ï¼ˆåŒ…æ‹¬é‡Œé¢çš„å­å¼¹ï¼‰æ‰”æ‰ï¼Œåœ¨å°½é‡ä¿è¯é€šå…³çš„æƒ…å†µä¸‹ï¼Œéœ€è¦çš„æœ€å¤šçš„å­å¼¹æ•°ä¸ºå¤šå°‘ã€‚</p><a id="more"></a><p>æœ‰å‡ ç‚¹éœ€è¦æ˜ç¡®:</p><ul><li>å¦‚æœæ€ªç‰©ä¹‹é—´æœ‰å¤šå‡ºçš„æ—¶é—´ï¼Œé‚£ä¹ˆæˆ‘å¯ä»¥é€‰æ‹©æ¢å¼¹æ¥è¾¾åˆ°æœ€ä¼˜çš„çŠ¶æ€ã€‚</li><li>å¯¹äºä¸€æ³¢æ€ªç‰©ä½ æœ€å¤šå¯ä»¥æ‰“å‡º=$èµ·å§‹å­å¼¹+k(r[i]-l[i])$ã€‚</li><li>æœ€ä¼˜ä¸€å®šæ˜¯ä¸€æ¬¡ä¸æ¢å¼¹ï¼Œæˆ‘ä»¬åªéœ€è¦å‡å°‘æ¢å¼¹æ¬¡æ•°å³å¯ã€‚</li><li>å› ä¸ºåé¢å¦‚æœç‰¹åˆ«ç´§ï¼Œè¿™ä¸ªæ—¶å€™å°±å¿…é¡»æ¢ï¼Œè¿™æ ·ä¹Ÿå¯è®©åé¢æ›´è½»æ¾ã€‚</li></ul><p>æˆ‘ä»¬å°±å¯ä»¥é¢„å¤„ç†å‡ºæ¯æ³¢è¿›åœºéœ€è¦çš„æœ€å°‘çš„å­å¼¹ã€‚è€ƒè™‘è¿åœ¨ä¸€èµ·çš„æ€ªç‰©æ³¢ï¼Œç›´æ¥ä»åå¾€å‰$dp$å³å¯ã€‚(æŠŠåä¸€æ¬¡éœ€è¦çš„å­å¼¹å½“æˆå¤šå‡ºçš„æ€ªç‰©)ã€‚</p><p>ç„¶åå°±æ˜¯è´ªå¿ƒçš„è¦æ¢å­å¼¹ï¼Œå°±å¯ä»¥æ¢å­å¼¹ã€‚</p><ul><li>å½“æˆ‘å¸¦ç€$tmp$å­å¼¹è¿›åœºã€‚åœ¨æˆ‘ä¸æµªè´¹å­å¼¹å¹¶ä¸”å¯ä»¥æ€å®Œæ‰€æœ‰æ€ªç‰©çš„æƒ…å†µä¸‹ï¼Œæˆ‘æœ€åå‰©ä½™çš„å­å¼¹åº”è¯¥æ˜¯$(k - (a[i] - tmp) \mod k) \mod k$</li></ul><p>ç„¶åè´ªå¿ƒçš„æ¨¡æ‹Ÿä¸€éå³å¯ã€‚ï¼ˆè¿ç»­éƒ¨åˆ†å¯ä»¥é€‰æ‹©åˆå¹¶èµ·æ¥æ¨¡æ‹Ÿï¼Œä¹Ÿå¯ä»¥ä¸åˆå¹¶ï¼‰</p><details>  <summary>ä»£ç </summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pii pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk make_pair</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">0</span>, f = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">char</span> c = getchar();</span><br><span class="line">    <span class="keyword">while</span> (c &lt; <span class="string">'0'</span> || c &gt; <span class="string">'9'</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="string">'-'</span>)</span><br><span class="line">            f = <span class="number">-1</span>;</span><br><span class="line">        c = getchar();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>)</span><br><span class="line">        x = (x &lt;&lt; <span class="number">1</span>) + (x &lt;&lt; <span class="number">3</span>) + c - <span class="string">'0'</span>, c = getchar();</span><br><span class="line">    <span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = <span class="built_in">read</span>(), k = <span class="built_in">read</span>();</span><br><span class="line">    vector&lt;ll&gt; l(n + 1), r(n + 1), a(n + 1), f(n + 1);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        l[i] = <span class="built_in">read</span>(), r[i] = <span class="built_in">read</span>(), a[i] = <span class="built_in">read</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">1</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (r[i] == l[i + <span class="number">1</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            f[i] = <span class="built_in">max</span>(<span class="number">0l</span>l, f[i + <span class="number">1</span>] + a[i] - (r[i] - l[i]) * k);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            f[i] = <span class="built_in">max</span>(<span class="number">0l</span>l, a[i] - (r[i] - l[i]) * k);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (f[i] &gt; k)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"-1"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ll tmp = k, ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ans += a[i];</span><br><span class="line">        <span class="keyword">if</span> (f[i] &gt; tmp)</span><br><span class="line">        &#123;</span><br><span class="line">            ans += tmp;</span><br><span class="line">            tmp = k;</span><br><span class="line">        &#125;</span><br><span class="line">        tmp = (k - (a[i] - tmp) % k) % k;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>  </details>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ‰$n$æ³¢æ€ªç‰©ï¼Œä½ æœ‰ä¸€æŠŠæªï¼Œæªçš„å¼¹å¤¹é‡ä¸º$k$ï¼Œç¬¬$i,[l_i,r_i]$æ³¢æ€ªç‰©æ•°é‡ä¸º$a_i$ï¼Œä½¿ç”¨å­å¼¹ä¸è´¹æ—¶é—´ï¼Œä½†æ˜¯ä½ æ¯æ¬¡æ¢å¼¹éƒ½éœ€è¦å°†å¼¹å¤¹ï¼ˆåŒ…æ‹¬é‡Œé¢çš„å­å¼¹ï¼‰æ‰”æ‰ï¼Œåœ¨å°½é‡ä¿è¯é€šå…³çš„æƒ…å†µä¸‹ï¼Œéœ€è¦çš„æœ€å¤šçš„å­å¼¹æ•°ä¸ºå¤šå°‘ã€‚&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="æ€ç»´" scheme="http://yoursite.com/tags/%E6%80%9D%E7%BB%B4/"/>
    
  </entry>
  
  <entry>
    <title>2019 ICPCå—æ˜Œ J.Summon</title>
    <link href="http://yoursite.com/2020/10/30/ICPCNCJ/"/>
    <id>http://yoursite.com/2020/10/30/ICPCNCJ/</id>
    <published>2020-10-30T02:47:00.000Z</published>
    <updated>2020-11-04T05:21:54.709Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ç¯ä¸Šæ¶‚é¢œè‰²ï¼Œä¸èƒ½å‡ºç°ç»™å®šé¢œè‰²çš„é¡ºæ—¶é’ˆé¡ºåºã€‚ï¼ˆé•¿åº¦ä¸º=4)ã€‚<br><a id="more"></a></p><script type="math/tex; mode=display">\frac{1}{|G|}\sum_{f\in G}m^{m(f)}</script><p>å˜æ¢ä¸€ä¸‹å°±æ˜¯</p><script type="math/tex; mode=display">    \frac{1}{n}\sum_{d|n}\phi(\frac{n}{d})f(d)</script><p>ç„¶å$f(d)$å°±è¡¨ç¤ºï¼Œé•¿åº¦$d$çš„ç¯ç¬¦åˆ è¦æ±‚æœ‰å‡ ä¸ªï¼ˆä¸ç”¨è€ƒè™‘é€‰æ‹©ï¼‰<br>åˆšå¼€å§‹è§‰å¾—è¿™é¢˜ï¼Œç”¨å¿«é€Ÿå¹‚æŒºç‚«é…·çš„ï¼Œå‘ç°å°±æ˜¯å¥—è·¯ã€‚è½¬åŒ–æˆä»æŸä¸ªçŠ¶æ€èµ°$d$æ­¥åˆ°æŸä¸ªçŠ¶æ€çš„æ­¥æ•°ç§ç±»ã€‚</p><p>è·Ÿ$POJ2888$ä¸€æ‘¸ä¸€æ ·ã€‚</p><p>å˜æˆå››è¿›åˆ¶ã€‚ç„¶åçŸ©é˜µå¿«é€Ÿå¹‚æ²¡äº†ã€‚</p><ul><li>æ³¨æ„é¢„å¤„ç†å¯ä»¥è½¬ç§»çš„è¿›åˆ¶ã€‚</li><li>å¸¸æ•°ä¼˜åŒ–ã€‚</li></ul><details>  <summary>ä»£ç </summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pii pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk make_pair</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">998244353</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Z = <span class="number">64</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Matrix</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> row, col;</span><br><span class="line">    <span class="keyword">int</span> s[Z][Z];</span><br><span class="line">    Matrix()</span><br><span class="line">    &#123; <span class="comment">//æ— å‚æ•°æ„é€ å‡½æ•°</span></span><br><span class="line">        row = col = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="keyword">sizeof</span>(s));</span><br><span class="line">    &#125;</span><br><span class="line">    Matrix(<span class="keyword">int</span> n, <span class="keyword">int</span> m, <span class="keyword">int</span> x = <span class="number">0</span>) : row(n), col(m)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="keyword">sizeof</span>(s));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; m; j++)</span><br><span class="line">                s[i][j] = x;</span><br><span class="line">    &#125; <span class="comment">//é‡è½½æ„é€ å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">printp</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123; <span class="comment">//è¾“å‡ºä¸€ä¸ªçŸ©é˜µ</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; row; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; col; j++)</span><br><span class="line">                <span class="built_in">cout</span> &lt;&lt; s[i][j] &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// void transpose()</span></span><br><span class="line">    <span class="comment">// &#123; //çŸ©é˜µçš„è½¬ç½®</span></span><br><span class="line">    <span class="comment">//     Matrix y(col, row);</span></span><br><span class="line">    <span class="comment">//     for (int i = 1; i &lt;= row; i++)</span></span><br><span class="line">    <span class="comment">//     &#123;</span></span><br><span class="line">    <span class="comment">//         for (int j = 1; j &lt;= col; j++)</span></span><br><span class="line">    <span class="comment">//             y.s[j][i] = s[i][j];</span></span><br><span class="line">    <span class="comment">//     &#125;</span></span><br><span class="line">    <span class="comment">//     *this = y;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">identity</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123; <span class="comment">//å°†è¯¥çŸ©é˜µæ”¹æˆå•ä½çŸ©é˜µ</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; row; i++)</span><br><span class="line">            s[i][i] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Matrix operator+(Matrix x)</span></span><br><span class="line">    <span class="comment">// &#123; //é‡è½½+</span></span><br><span class="line">    <span class="comment">//     Matrix y(row, col);</span></span><br><span class="line">    <span class="comment">//     for (int i = 0; i &lt;row; i++)</span></span><br><span class="line">    <span class="comment">//     &#123;</span></span><br><span class="line">    <span class="comment">//         for (int j = 0; j &lt; col; j++)</span></span><br><span class="line">    <span class="comment">//             y.s[i][j] += s[i][j] + x.s[i][j], y.s[i][j] %= mod;</span></span><br><span class="line">    <span class="comment">//     &#125;</span></span><br><span class="line">    <span class="comment">//     return y;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    Matrix <span class="keyword">operator</span>*(Matrix x)</span><br><span class="line">    &#123; <span class="comment">//é‡è½½*</span></span><br><span class="line">        <span class="function">Matrix <span class="title">y</span><span class="params">(row, x.col)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; row; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; x.col; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; col; k++)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (!s[i][k] || !x.s[k][j])</span><br><span class="line">                        <span class="keyword">continue</span>;</span><br><span class="line">                    y.s[i][j] = (y.s[i][j] + <span class="number">1l</span>l * s[i][k] * x.s[k][j] % mod) % mod;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> y;</span><br><span class="line">    &#125;</span><br><span class="line">    Matrix <span class="keyword">operator</span>*=(Matrix x)</span><br><span class="line">    &#123; <span class="comment">//é‡è½½*=</span></span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span> = *<span class="keyword">this</span> * x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; z[<span class="number">40</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> x, <span class="keyword">int</span> mo)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (x)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (x &amp; <span class="number">1</span>)</span><br><span class="line">            res = <span class="number">1l</span>l * res * a % mod;</span><br><span class="line">        a = <span class="number">1l</span>l * a * a % mod;</span><br><span class="line">        x &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Matrix <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">Matrix <span class="title">res</span><span class="params">(z[<span class="number">0</span>].row, z[<span class="number">0</span>].col)</span></span>;</span><br><span class="line">    res.identity();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; (<span class="number">1</span> &lt;&lt; i) &lt;= x; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="number">1</span> &lt;&lt; i) &amp; x)</span><br><span class="line">        &#123;</span><br><span class="line">            res = res * z[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Polya</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">mult</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1l</span>l * x * y % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//  dt.printp();</span></span><br><span class="line">        Matrix res = qpow(x);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i++)</span><br><span class="line">            ans = (ans + res.s[i][i]) % mod;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> p[N], e[N];</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> now, <span class="keyword">int</span> phi, <span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x &gt; cnt)</span><br><span class="line">        &#123;</span><br><span class="line">            ans = (ans + mult(phi % mod, calc(n / now))) % mod;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        dfs(x + <span class="number">1</span>, now, phi, n);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= e[x]; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            phi *= (p[x] - (i == <span class="number">1</span>));</span><br><span class="line">            now *= p[x];</span><br><span class="line">            dfs(x + <span class="number">1</span>, now, phi, n);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cnt = <span class="number">0</span>;</span><br><span class="line">        ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> tmp = n;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i * i &lt;= n; i++)</span><br><span class="line">            <span class="keyword">if</span> (n % i == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                p[++cnt] = i;</span><br><span class="line">                e[cnt] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">while</span> (n % i == <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    n /= i;</span><br><span class="line">                    e[cnt]++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">if</span> (n &gt; <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            p[++cnt] = n;</span><br><span class="line">            e[cnt] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        dfs(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, tmp);</span><br><span class="line">        <span class="comment">//cout &lt;&lt; ans &lt;&lt; endl;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1l</span>l * ans * qpow(tmp % mod, mod - <span class="number">2</span>, mod) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="comment">// namespace Polya</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">0</span>, f = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">char</span> c = getchar();</span><br><span class="line">    <span class="keyword">while</span> (c &lt; <span class="string">'0'</span> || c &gt; <span class="string">'9'</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="string">'-'</span>)</span><br><span class="line">            f = <span class="number">-1</span>;</span><br><span class="line">        c = getchar();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>)</span><br><span class="line">        x = (x &lt;&lt; <span class="number">1</span>) + (x &lt;&lt; <span class="number">3</span>) + c - <span class="string">'0'</span>, c = getchar();</span><br><span class="line">    <span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = <span class="built_in">read</span>(), m = <span class="built_in">read</span>();</span><br><span class="line">    <span class="function">Matrix <span class="title">tmp</span><span class="params">(<span class="number">64</span>, <span class="number">64</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">64</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (((j &lt;&lt; <span class="number">2</span>) &amp; <span class="number">63</span>) == ((i &gt;&gt; <span class="number">2</span>) &lt;&lt; <span class="number">2</span>))</span><br><span class="line">                tmp.s[i][j] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(<span class="number">4</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            a[j] = <span class="built_in">read</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        tmp.s[a[<span class="number">0</span>] + (a[<span class="number">1</span>] &lt;&lt; <span class="number">2</span>) + (a[<span class="number">2</span>] &lt;&lt; <span class="number">4</span>)][a[<span class="number">1</span>] + (a[<span class="number">2</span>] &lt;&lt; <span class="number">2</span>) + (a[<span class="number">3</span>] &lt;&lt; <span class="number">4</span>)] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    z[<span class="number">0</span>] = tmp;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; (<span class="number">1</span> &lt;&lt; i) &lt;= n; i++)</span><br><span class="line">        z[i] = z[i - <span class="number">1</span>] * z[i - <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; Polya::solve(n) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>  </details>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨ç¯ä¸Šæ¶‚é¢œè‰²ï¼Œä¸èƒ½å‡ºç°ç»™å®šé¢œè‰²çš„é¡ºæ—¶é’ˆé¡ºåºã€‚ï¼ˆé•¿åº¦ä¸º=4)ã€‚&lt;br&gt;
    
    </summary>
    
    
    
      <category term="ç½®æ¢ç¾¤" scheme="http://yoursite.com/tags/%E7%BD%AE%E6%8D%A2%E7%BE%A4/"/>
    
  </entry>
  
  <entry>
    <title>P3307 [SDOI2013]é¡¹é“¾</title>
    <link href="http://yoursite.com/2020/10/30/P3307/"/>
    <id>http://yoursite.com/2020/10/30/P3307/</id>
    <published>2020-10-30T02:47:00.000Z</published>
    <updated>2020-11-04T05:10:09.563Z</updated>
    
    <content type="html"><![CDATA[<ul><li><p>ç å­=æ­£ä¸‰è±æŸ±,ä¸‰ä¸ªé¢ä¸Šé¢çš„æ•°å­—$x$,å¿…é¡»æ»¡è¶³$x\in [1,a]$ï¼Œä¸”ç å­ä¸Šé¢çš„æ•°å­—çš„æœ€å¤§å…¬çº¦æ•°è¦æ°å¥½ä¸º1ã€‚ä¸‰æ£±æŸ±å¯ä»¥é€‰æ‹©ç¿»è½¬.</p></li><li><p>ç›¸é‚»çš„ä¸¤ä¸ªç å­å¿…é¡»ä¸åŒã€‚</p></li><li><p>ä¸¤ä¸²é¡¹é“¾å¦‚æœèƒ½å¤Ÿç»è¿‡æ—‹è½¬å˜æˆä¸€æ ·çš„ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸²é¡¹é“¾å°±æ˜¯ç›¸åŒçš„</p></li></ul><p>$n&lt;=10^{14}ï¼Œa&lt;=10^7ï¼ŒT&lt;=10$<br><a id="more"></a></p><p>å¥½é¢˜ï¼</p><p>é¦–å…ˆç®—ç å­ç§ç±»ï¼Œ$s3$è¡¨ç¤º$3$ä¸ª$\gcd=1$çš„ä¸ªæ•°ï¼ŒåŒç†$s2,s1$ã€‚</p><p>$Burnsideå¼•ç†$</p><script type="math/tex; mode=display">    res=\frac{1}{3+3}(s3+3s2+2s1)</script><hr><p>ç„¶åä¹‹å$Polya$é‡Œçš„$m=res$</p><script type="math/tex; mode=display"> \frac{1}{n}\sum_{d|n}\varphi(\frac{n}{d})f(d)</script><p>è¿™é‡ŒçŸ©é˜µå¿«é€Ÿå¹‚å°±å¤ªå¤§äº†ã€‚</p><ul><li><p>å¦‚æœ$i-1$ä¸$1$ä¸åŒåˆ™$f(i)=f(i-1)(m-2)$</p></li><li><p>å¦‚æœ$i-1$ä¸$1$ç›¸åŒåˆ™$i-2$ä¸$1$ä¸åŒã€‚ $f(i)=f(i-2)(m-1)$</p></li></ul><p>$x^2-(m-1)x-(m-2)=(x+1)(x-(m-1))=0$</p><p>$f(i)=a(-1)^i+b(m-1)^i,f(1)=0,f(2)=m(m-1)$</p><p>$f(1)$ç”±äº$1$ä¸$1$ç›¸é‚»ã€‚æ‰€ä»¥ä¸º$0$ã€‚</p><script type="math/tex; mode=display">f(i)=(m-1)^i+(-1)^i(m-1)</script><hr><p>ç„¶å$dfs$ä¸€éæœå› æ•°å¹¶ä¸”ä¸€éå¤„ç†æ¬§æ‹‰å‡½æ•°ã€‚</p><p>BZOJä¸Šçš„æ•°æ®ç»è¿‡åŠ å¼ºï¼Œ n å¯èƒ½æ˜¯ $10^9+7$ çš„å€æ•°ï¼ˆæ²¡æœ‰é€†å…ƒï¼‰ï¼Œè€Œæœ€åè¦é™¤ä»¥ $n$ ï¼Œæ‰€ä»¥éœ€è¦ä¸€äº›ç‰¹æ®Šçš„æŠ€å·§ã€‚</p><ul><li>$MOD=(1e9+7)^2$</li><li>æ­¤æ—¶è¦ç”¨å¿«é€Ÿä¹˜</li><li>ç­”æ¡ˆç­‰äºåœ¨æ¨¡ $10^9+7$ æ„ä¹‰ä¸‹ $\frac{sum}{1e9+7}$ é™¤ä»¥ $\frac{n}{1e9+7}$ çš„ç»“æœã€‚</li><li>éœ€è¦$exgcd$æ±‚$6$åœ¨$(1e9+7)^2$çš„é€†å…ƒã€‚</li></ul><details>  <summary>ä»£ç </summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pii pair<span class="meta-string">&lt;ll, ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk make_pair</span></span><br><span class="line"><span class="keyword">const</span> ll N = <span class="number">1e7</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> ll MOD = <span class="number">1000000007l</span>l;</span><br><span class="line"><span class="keyword">const</span> ll Inv61 = <span class="number">166666668l</span>l;</span><br><span class="line"><span class="keyword">const</span> ll Inv62 = <span class="number">833333345000000041l</span>l;</span><br><span class="line"></span><br><span class="line">ll mod;</span><br><span class="line">ll Inv6;</span><br><span class="line">ll O;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">mult</span><span class="params">(ll x, ll y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!O)</span><br><span class="line">        <span class="keyword">return</span> x * y % mod;</span><br><span class="line">    <span class="keyword">return</span> (x * y - (ll)((<span class="keyword">long</span> <span class="keyword">double</span>)x / mod * y) * mod + mod) % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> pcnt, pr[N], npr[N];</span><br><span class="line"><span class="keyword">int</span> mu[N], usum[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Prime_init</span><span class="params">(ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    npr[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!npr[i])</span><br><span class="line">            pr[++pcnt] = i, mu[i] = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span> (ll j = <span class="number">1</span>; j &lt;= pcnt &amp;&amp; pr[j] * i &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            npr[pr[j] * i] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (i % pr[j] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                mu[pr[j] * i] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                mu[pr[j] * i] = mu[i] * (<span class="number">-1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        usum[i] = usum[i - <span class="number">1</span>] + mu[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll k;</span><br><span class="line">ll p[<span class="number">100</span>], e[<span class="number">100</span>];</span><br><span class="line">ll cnt;</span><br><span class="line">ll ans;</span><br><span class="line"><span class="function">ll <span class="title">qpow</span><span class="params">(ll a, ll x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (x)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (x &amp; <span class="number">1</span>)</span><br><span class="line">            res = mult(res, a);</span><br><span class="line">        a = mult(a, a);</span><br><span class="line">        x &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">calc</span><span class="params">(ll x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (qpow(k - <span class="number">1</span>, x) + mult((x &amp; <span class="number">1</span> ? mod - <span class="number">1</span> : <span class="number">1</span>), (k - <span class="number">1</span>))) % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(ll x, ll now, ll phi, ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; cnt)</span><br><span class="line">    &#123;</span><br><span class="line">        ans = (ans + mult(phi % mod, calc(n / now))) % mod;</span><br><span class="line">        <span class="comment">//cout &lt;&lt; phi &lt;&lt; " " &lt;&lt; calc(n / now) &lt;&lt; endl;</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(x + <span class="number">1</span>, now, phi, n);</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= e[x]; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        phi *= (p[x] - (i == <span class="number">1</span>));</span><br><span class="line">        now *= p[x];</span><br><span class="line">        dfs(x + <span class="number">1</span>, now, phi, n);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cnt = <span class="number">0</span>;</span><br><span class="line">    ll tmp = n;</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">2</span>; i * i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (n % i == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            ll o = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (n % i == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                n /= i;</span><br><span class="line">                o++;</span><br><span class="line">            &#125;</span><br><span class="line">            p[++cnt] = i;</span><br><span class="line">            e[cnt] = o;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        p[++cnt] = n;</span><br><span class="line">        e[cnt] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, tmp);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    k = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">1</span>, j; i &lt;= n; i = j + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        j = n / (n / i);</span><br><span class="line">        k = (k + mult(mult(mult(n / i, n / i), n / i + <span class="number">3</span>), (usum[j] - usum[i - <span class="number">1</span>] + mod) % mod)) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    k = mult(Inv6, k);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll T;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">    Prime_init(<span class="number">1e7</span>);</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        ll n, a;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; a;</span><br><span class="line">        ans = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        O = n % MOD ? <span class="number">0</span> : <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (O)</span><br><span class="line">            mod = MOD * MOD, Inv6 = Inv62;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            mod = MOD, Inv6 = Inv61;</span><br><span class="line"></span><br><span class="line">        init(a);</span><br><span class="line">        solve(n);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (O)</span><br><span class="line">            ans = mult(ans / MOD, qpow(n / MOD, MOD - <span class="number">2</span>)) % MOD;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            ans = mult(ans, qpow(n % MOD, MOD - <span class="number">2</span>));</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>  </details>]]></content>
    
    <summary type="html">
    
      &lt;ul&gt;
&lt;li&gt;&lt;p&gt;ç å­=æ­£ä¸‰è±æŸ±,ä¸‰ä¸ªé¢ä¸Šé¢çš„æ•°å­—$x$,å¿…é¡»æ»¡è¶³$x\in [1,a]$ï¼Œä¸”ç å­ä¸Šé¢çš„æ•°å­—çš„æœ€å¤§å…¬çº¦æ•°è¦æ°å¥½ä¸º1ã€‚ä¸‰æ£±æŸ±å¯ä»¥é€‰æ‹©ç¿»è½¬.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç›¸é‚»çš„ä¸¤ä¸ªç å­å¿…é¡»ä¸åŒã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä¸¤ä¸²é¡¹é“¾å¦‚æœèƒ½å¤Ÿç»è¿‡æ—‹è½¬å˜æˆä¸€æ ·çš„ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸²é¡¹é“¾å°±æ˜¯ç›¸åŒçš„&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;$n&amp;lt;=10^{14}ï¼Œa&amp;lt;=10^7ï¼ŒT&amp;lt;=10$&lt;br&gt;
    
    </summary>
    
    
    
      <category term="ç½®æ¢ç¾¤" scheme="http://yoursite.com/tags/%E7%BD%AE%E6%8D%A2%E7%BE%A4/"/>
    
  </entry>
  
  <entry>
    <title>CF455D.Serega and Fun</title>
    <link href="http://yoursite.com/2020/10/28/CF455D/"/>
    <id>http://yoursite.com/2020/10/28/CF455D/</id>
    <published>2020-10-28T02:47:00.000Z</published>
    <updated>2020-11-28T07:44:29.121Z</updated>
    
    <content type="html"><![CDATA[<p>ç»™ä½ ä¸€ä¸ªåºåˆ—ï¼Œåœ¨çº¿åœ°æ”¯æŒä¸¤ä¸ªæ“ä½œï¼š</p><ul><li><p>å°†ä¸€ä¸ªåŒºé—´å¾ªç¯ç§»ä½ã€‚</p></li><li><p>æŸ¥è¯¢ä¸€ä¸ªåŒºé—´ä¸­æŸä¸ªæ•°å‡ºç°çš„æ¬¡æ•°ã€‚</p></li></ul><a id="more"></a><p>ä¸¤ä¸ªæ–¹æ³•</p><ul><li>åˆ†å— ç»´æŠ¤å—å†…å…ƒç´ å‡ºç°æ¬¡æ•°ï¼Œä¿®æ”¹å’Œæ›´æ–°ç”¨åŒå‘é˜Ÿåˆ—éƒ½å¾ˆæ˜¾ç„¶ã€‚$O((n+m)\sqrt{n})=1700ms$</li><li>å¹³è¡¡æ ‘ï¼Œç¬¬ä¸€ä¸ªæ“ä½œå¾ˆå¥½è§£å†³ï¼Œå¯¹äºç¬¬äºŒä¸ªæ“ä½œï¼Œé¦–å…ˆæˆ‘ä»¬åªèƒ½ç»´æŠ¤$t_i$è¿™ä¸ªæ•°å­—å¹³è¡¡æ ‘å‡ºç°çš„ç›¸å¯¹ä½ç½®ï¼Œè€Œ<strong>ä¸èƒ½ç»´æŠ¤ç»å¯¹ä½ç½®</strong>ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€å¼€å§‹æ„é€ åŸåºåˆ—çš„å¹³è¡¡æ ‘çš„æ˜ å°„ï¼Œå°±å¯ä»¥çŸ¥é“æŸä¸ªå€¼åœ¨åŸåºåˆ—ç¬¬å‡ ä¸ªä½ç½®ï¼Œè¿™é‡Œéœ€è¦$O(\log n)$ã€‚æˆ‘æƒ³çŸ¥é“$[1,r]$ä¹‹é—´$i$å‡ºç°äº†å‡ æ¬¡ï¼Œå¹³è¡¡æ ‘ä¸Šé€šè¿‡è¿™ä¸ªæŸ¥è¯¢äºŒåˆ†å³å¯ã€‚æ€»å¤æ‚åº¦$O(n+m\log^2 n)=300ms$</li></ul><details>  <summary>å¹³è¡¡æ ‘</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pii pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">0</span>, f = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">char</span> c = getchar();</span><br><span class="line">    <span class="keyword">while</span> (c &lt; <span class="string">'0'</span> || c &gt; <span class="string">'9'</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="string">'-'</span>)</span><br><span class="line">            f = <span class="number">-1</span>;</span><br><span class="line">        c = getchar();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>)</span><br><span class="line">        x = (x &lt;&lt; <span class="number">1</span>) + (x &lt;&lt; <span class="number">3</span>) + c - <span class="string">'0'</span>, c = getchar();</span><br><span class="line">    <span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="built_in">std</span>::mt19937 <span class="title">rnd</span><span class="params">(<span class="built_in">std</span>::chrono::steady_clock::now().time_since_epoch().count())</span></span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">FHQ</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> ls[N], rs[N];</span><br><span class="line">    <span class="keyword">int</span> siz[N], key[N], val[N];</span><br><span class="line">    <span class="keyword">int</span> fa[N];</span><br><span class="line">    <span class="keyword">int</span> cor[N];</span><br><span class="line">    <span class="comment">// ll sum[N];</span></span><br><span class="line">    <span class="keyword">int</span> tcnt;</span><br><span class="line">    <span class="keyword">int</span> root;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">Newnode</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        siz[++tcnt] = <span class="number">1</span>;</span><br><span class="line">        val[tcnt] = x;</span><br><span class="line">        key[tcnt] = rnd(); <span class="comment">//ç²¾é«“æ‰€åœ¨</span></span><br><span class="line"></span><br><span class="line">        fa[tcnt] = tcnt;</span><br><span class="line">        ls[tcnt] = rs[tcnt] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> tcnt;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> pos)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        siz[pos] = siz[ls[pos]] + siz[rs[pos]] + <span class="number">1</span>;</span><br><span class="line">        <span class="comment">// sum[pos] = sum[ls[pos]] + sum[rs[pos]] + val[pos];</span></span><br><span class="line">        ls[pos] ? (fa[ls[pos]] = pos) : <span class="number">0</span>;</span><br><span class="line">        rs[pos] ? (fa[rs[pos]] = pos) : <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">split</span><span class="params">(<span class="keyword">int</span> pos, <span class="keyword">int</span> v, <span class="keyword">int</span> &amp;ll, <span class="keyword">int</span> &amp;rr)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!pos)</span><br><span class="line">        &#123;</span><br><span class="line">            ll = <span class="number">0</span>, rr = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (siz[ls[pos]] + <span class="number">1</span> &lt;= v)</span><br><span class="line">        &#123;</span><br><span class="line">            ll = pos;</span><br><span class="line">            split(rs[pos], v - siz[ls[pos]] - <span class="number">1</span>, rs[pos], rr);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            rr = pos;</span><br><span class="line">            split(ls[pos], v, ll, ls[pos]);</span><br><span class="line">        &#125;</span><br><span class="line">        fa[ll] = ll, fa[rr] = rr; <span class="comment">//ä¿è¯å¤´èŠ‚ç‚¹</span></span><br><span class="line">        pushup(pos);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!l || !r)</span><br><span class="line">            <span class="keyword">return</span> l + r;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (key[l] &lt; key[r])</span><br><span class="line">        &#123;</span><br><span class="line">            rs[l] = merge(rs[l], r);</span><br><span class="line">            pushup(l);</span><br><span class="line">            <span class="keyword">return</span> l;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            ls[r] = merge(l, ls[r]);</span><br><span class="line">            pushup(r);</span><br><span class="line">            <span class="keyword">return</span> r;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// int find(int x)</span></span><br><span class="line">    <span class="comment">// &#123;</span></span><br><span class="line">    <span class="comment">//     return fa[x] == x ? x : find(fa[x]);</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> &amp;rt, <span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> pos = Newnode(x);</span><br><span class="line">        rt = merge(rt, pos);</span><br><span class="line">        <span class="keyword">return</span> pos;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">kth</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> res = siz[ls[x]] + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (fa[x] != x)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (rs[fa[x]] == x)</span><br><span class="line">            &#123;</span><br><span class="line">                res += siz[ls[fa[x]]] + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            x = fa[x];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; t;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> rt[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> o = rt[k];</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (o)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (t.kth(t.cor[o]) &lt;= r)</span><br><span class="line">        &#123;</span><br><span class="line">            res += t.siz[t.ls[o]] + <span class="number">1</span>;</span><br><span class="line">            o = t.rs[o];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            o = t.ls[o];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> calc(k, r) - calc(k, l - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a, b, c, d;</span><br><span class="line">    t.split(rt[<span class="number">0</span>], l - <span class="number">1</span>, a, b);</span><br><span class="line">    t.split(b, r - l + <span class="number">1</span>, b, d);</span><br><span class="line">    t.split(b, r - l, b, c);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> k = t.val[c];</span><br><span class="line">    rt[<span class="number">0</span>] = t.merge(a, t.merge(c, t.merge(b, d)));</span><br><span class="line">    <span class="keyword">int</span> ls = calc(k, l - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> rs = calc(k, r);</span><br><span class="line">    <span class="comment">//cout &lt;&lt; k &lt;&lt; " " &lt;&lt; ls &lt;&lt; " " &lt;&lt; rs &lt;&lt; endl;</span></span><br><span class="line"></span><br><span class="line">    t.split(rt[k], ls, a, b);</span><br><span class="line">    t.split(b, rs - ls, b, d);</span><br><span class="line">    t.split(b, rs - ls - <span class="number">1</span>, b, c);</span><br><span class="line"></span><br><span class="line">    rt[k] = t.merge(a, t.merge(c, t.merge(b, d)));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//freopen("1", "r", stdin);</span></span><br><span class="line">    <span class="keyword">int</span> n = <span class="built_in">read</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        a[i] = <span class="built_in">read</span>();</span><br><span class="line">        <span class="keyword">int</span> x = t.insert(rt[<span class="number">0</span>], a[i]);</span><br><span class="line">        <span class="keyword">int</span> y = t.insert(rt[a[i]], a[i]);</span><br><span class="line">        t.cor[x] = y;</span><br><span class="line">        t.cor[y] = x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> lst = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> q = <span class="built_in">read</span>();</span><br><span class="line">    <span class="keyword">while</span> (q--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> op = <span class="built_in">read</span>(), l = <span class="built_in">read</span>(), r = <span class="built_in">read</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            l = (l + lst - <span class="number">1</span>) % n + <span class="number">1</span>, r = (r + lst - <span class="number">1</span>) % n + <span class="number">1</span>;</span><br><span class="line">            <span class="comment">//cout &lt;&lt; op &lt;&lt; " " &lt;&lt; l &lt;&lt; " " &lt;&lt; r &lt;&lt; " " &lt;&lt; endl;</span></span><br><span class="line">            <span class="keyword">if</span> (l &gt; r)</span><br><span class="line">                swap(l, r);</span><br><span class="line">            <span class="keyword">if</span> (l == r)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            update(l, r);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> k = <span class="built_in">read</span>();</span><br><span class="line">            l = (l + lst - <span class="number">1</span>) % n + <span class="number">1</span>, r = (r + lst - <span class="number">1</span>) % n + <span class="number">1</span>, k = (k + lst - <span class="number">1</span>) % n + <span class="number">1</span>;</span><br><span class="line">            <span class="comment">// cout &lt;&lt; op &lt;&lt; " " &lt;&lt; l &lt;&lt; " " &lt;&lt; r &lt;&lt; " "</span></span><br><span class="line">            <span class="comment">//      &lt;&lt; " " &lt;&lt; k &lt;&lt; endl;</span></span><br><span class="line">            <span class="keyword">if</span> (l &gt; r)</span><br><span class="line">                swap(l, r);</span><br><span class="line"></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, lst = query(l, r, k));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>  </details><details>  <summary>åˆ†å—</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pii pair<span class="meta-string">&lt;ll, int&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">400</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">0</span>, f = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">char</span> c = getchar();</span><br><span class="line">    <span class="keyword">while</span> (c &lt; <span class="string">'0'</span> || c &gt; <span class="string">'9'</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="string">'-'</span>)</span><br><span class="line">            f = <span class="number">-1</span>;</span><br><span class="line">        c = getchar();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>)</span><br><span class="line">        x = (x &lt;&lt; <span class="number">1</span>) + (x &lt;&lt; <span class="number">3</span>) + c - <span class="string">'0'</span>, c = getchar();</span><br><span class="line">    <span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Bo</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> block, tot, bl[N], br[N], fa[N];</span><br><span class="line">    <span class="keyword">int</span> cnt[M][N];</span><br><span class="line">    <span class="keyword">int</span> a[N];</span><br><span class="line">    <span class="built_in">deque</span>&lt;<span class="keyword">int</span>&gt; q[M];</span><br><span class="line">    ll tag[N];</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">replace</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> w)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cnt[x][y] += w;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        block = <span class="built_in">sqrt</span>(n);</span><br><span class="line">        tot = n / block + (n % block != <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= tot; i++)</span><br><span class="line">            bl[i] = (i - <span class="number">1</span>) * block + <span class="number">1</span>, br[i] = i * block;</span><br><span class="line"></span><br><span class="line">        br[tot] = n;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            fa[i] = (i - <span class="number">1</span>) / (block) + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= tot; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = bl[i]; j &lt;= br[i]; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                q[i].push_back(a[j]);</span><br><span class="line">                replace(i, a[j], <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">(<span class="keyword">int</span> lx, <span class="keyword">int</span> rx, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt; le, ri;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= l - bl[lx]; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            le.push(q[lx].front());</span><br><span class="line">            q[lx].pop_front();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= br[rx] - r; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            ri.push(q[rx].back());</span><br><span class="line">            q[rx].pop_back();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> u = q[rx].back();</span><br><span class="line">        replace(rx, u, <span class="number">-1</span>);</span><br><span class="line">        q[rx].pop_back();</span><br><span class="line">        replace(lx, u, <span class="number">1</span>);</span><br><span class="line">        q[lx].push_front(u);</span><br><span class="line">        <span class="keyword">while</span> (!le.empty())</span><br><span class="line">        &#123;</span><br><span class="line">            q[lx].push_front(le.top());</span><br><span class="line">            le.pop();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (!ri.empty())</span><br><span class="line">        &#123;</span><br><span class="line">            q[rx].push_back(ri.top());</span><br><span class="line">            ri.pop();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> lx, <span class="keyword">int</span> rx, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt; le, ri;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= l - bl[lx]; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            le.push(q[lx].front());</span><br><span class="line">            q[lx].pop_front();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= br[rx] - r; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            ri.push(q[rx].back());</span><br><span class="line">            q[rx].pop_back();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> x : q[lx])</span><br><span class="line">            <span class="keyword">if</span> (x == k)</span><br><span class="line">                res++;</span><br><span class="line">        <span class="keyword">if</span> (lx != rx)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> x : q[rx])</span><br><span class="line">                <span class="keyword">if</span> (x == k)</span><br><span class="line">                    res++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (!le.empty())</span><br><span class="line">        &#123;</span><br><span class="line">            q[lx].push_front(le.top());</span><br><span class="line">            le.pop();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (!ri.empty())</span><br><span class="line">        &#123;</span><br><span class="line">            q[rx].push_back(ri.top());</span><br><span class="line">            ri.pop();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (fa[l] == fa[r])</span><br><span class="line">        &#123;</span><br><span class="line">            work(fa[l], fa[l], l, r);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> lx = fa[l], rx = fa[r];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = lx; i &lt; rx; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> x = q[i].back();</span><br><span class="line">            q[i].pop_back();</span><br><span class="line">            replace(i, x, <span class="number">-1</span>);</span><br><span class="line">            q[i + <span class="number">1</span>].push_front(x);</span><br><span class="line">            replace(i + <span class="number">1</span>, x, <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        work(lx, rx, l, r);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (fa[l] == fa[r])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> calc(fa[l], fa[l], l, r, k);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> lx = fa[l], rx = fa[r];</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = lx + <span class="number">1</span>; i &lt; rx; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            res += cnt[i][k];</span><br><span class="line">        &#125;</span><br><span class="line">        res += calc(lx, rx, l, r, k);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; t;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// freopen("1", "r", stdin);</span></span><br><span class="line">    <span class="keyword">int</span> n = <span class="built_in">read</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        t.a[i] = <span class="built_in">read</span>();</span><br><span class="line">    t.build(n);</span><br><span class="line">    <span class="keyword">int</span> q = <span class="built_in">read</span>();</span><br><span class="line">    <span class="keyword">int</span> lst = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (q--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> op = <span class="built_in">read</span>(), l = <span class="built_in">read</span>(), r = <span class="built_in">read</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            l = (l + lst - <span class="number">1</span>) % n + <span class="number">1</span>, r = (r + lst - <span class="number">1</span>) % n + <span class="number">1</span>;</span><br><span class="line">            <span class="comment">//cout &lt;&lt; op &lt;&lt; " " &lt;&lt; l &lt;&lt; " " &lt;&lt; r &lt;&lt; " " &lt;&lt; endl;</span></span><br><span class="line">            <span class="keyword">if</span> (l &gt; r)</span><br><span class="line">                swap(l, r);</span><br><span class="line">            <span class="keyword">if</span> (l == r)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            t.update(l, r);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> k = <span class="built_in">read</span>();</span><br><span class="line">            l = (l + lst - <span class="number">1</span>) % n + <span class="number">1</span>, r = (r + lst - <span class="number">1</span>) % n + <span class="number">1</span>, k = (k + lst - <span class="number">1</span>) % n + <span class="number">1</span>;</span><br><span class="line">            <span class="comment">// cout &lt;&lt; op &lt;&lt; " " &lt;&lt; l &lt;&lt; " " &lt;&lt; r &lt;&lt; " "</span></span><br><span class="line">            <span class="comment">//      &lt;&lt; " " &lt;&lt; k &lt;&lt; endl;</span></span><br><span class="line">            <span class="keyword">if</span> (l &gt; r)</span><br><span class="line">                swap(l, r);</span><br><span class="line"></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, lst = t.query(l, r, k));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>  </details>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç»™ä½ ä¸€ä¸ªåºåˆ—ï¼Œåœ¨çº¿åœ°æ”¯æŒä¸¤ä¸ªæ“ä½œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;å°†ä¸€ä¸ªåŒºé—´å¾ªç¯ç§»ä½ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æŸ¥è¯¢ä¸€ä¸ªåŒºé—´ä¸­æŸä¸ªæ•°å‡ºç°çš„æ¬¡æ•°ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
    
      <category term="å¹³è¡¡æ ‘" scheme="http://yoursite.com/tags/%E5%B9%B3%E8%A1%A1%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>CF1437F. Emotional Fishermen</title>
    <link href="http://yoursite.com/2020/10/25/CF1437F/"/>
    <id>http://yoursite.com/2020/10/25/CF1437F/</id>
    <published>2020-10-25T02:47:00.000Z</published>
    <updated>2020-10-31T03:11:47.197Z</updated>
    
    <content type="html"><![CDATA[<p>å°†å…ƒç´ é‡æ–°æ’åˆ—ï¼Œè¯¢é—®ä¸å‡ºç°$y\leq 2x\leq 4y$, $y$=ä¹‹å‰æœ€å¤§å€¼ã€‚</p><a id="more"></a><p>æ˜¾æ’ä¸ªåºï¼Œå‡è®¾ç¡®å®šä¸€ä¸ªæœ€å¤§å…ƒç´ çš„æ—¶å€™ï¼Œ$\leq \frac{a_i}{2}$å·²ç»å¯ä»¥éšä¾¿é€‰æ‹©äº†ï¼Œå› ä¸ºèŒƒå›´$[L,R]$åªä¼šå¾€å·¦è¾¹ç§»åŠ¨ã€‚</p><p>$dp[i]$è¡¨ç¤ºé€‰æ‹©$a_i$çš„æ–¹æ¡ˆæ•°ã€‚</p><p>è½¬ç§»çš„æ—¶å€™<br>$dp[i]=\sum dp[j]\times A_{n - 2 - mx[j]}^{mx[i] - mx[j] - 1}$</p><p>$mx[i]$è¡¨ç¤ºæœ€å¤§çš„$j$æ»¡è¶³$2\times a[j]\leq a[i]$</p><p>æ€è€ƒè¿™ä¸ª$DP$,å½“$dp[j]$,æœ‰$mx[j]+1$ä¸ªå…ƒç´ å·²ç»æ’å¥½çš„æ—¶å€™ï¼Œå°†$a_i$æ”¾åœ¨$a_j$çš„ä¸‹ä¸€ä¸ªä½ç½®ã€‚é‚£ä¹ˆå‰©ä¸‹å°±æ˜¯$(n-2-mx[j])$ä¸ªä½ç½®ï¼Œéšæœºæ”¾ç½®$mx[i] - mx[j] - 1$ã€‚</p><p>ç”±äºè¿™æ ·$dp$,å‰ç¼€æœ€å¤§å€¼çš„é¡ºåºæ˜¯ä¸€å®šï¼Œå°±å¯ä»¥ä¿è¯ä¸é‡ä¸æ¼äº†ã€‚</p><details>  <summary>ä»£ç </summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pii pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk make_pair</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">998244353</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> math</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">inc</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123; <span class="keyword">return</span> (x + y &gt;= mod) ? (x + y - mod) : (x + y); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123; <span class="keyword">return</span> (x - y &lt; <span class="number">0</span>) ? (x - y + mod) : (x - y); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> b == <span class="number">0</span> ? a : gcd(b, a % b);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> x, <span class="keyword">int</span> mo)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (x)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (x &amp; <span class="number">1</span>)</span><br><span class="line">                res = <span class="number">1l</span>l * res * a % mod;</span><br><span class="line">            a = <span class="number">1l</span>l * a * a % mod;</span><br><span class="line">            x &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> Fac[N], invFac[N];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Finit</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        invFac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            Fac[i] = <span class="number">1l</span>l * Fac[i - <span class="number">1</span>] * i % mod;</span><br><span class="line">        invFac[n] = qpow(Fac[n], mod - <span class="number">2</span>, mod);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">1</span>; i--)</span><br><span class="line">            invFac[i] = <span class="number">1l</span>l * invFac[i + <span class="number">1</span>] * (i + <span class="number">1</span>) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">C</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (m == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (n &lt; m || m &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">int</span>)(<span class="number">1l</span>l * Fac[n] * invFac[m] % mod * invFac[n - m] % mod);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">A</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// if (m == 0)</span></span><br><span class="line">        <span class="comment">//     return 1;</span></span><br><span class="line">        <span class="keyword">if</span> (n &lt; <span class="number">0</span> || m &lt; <span class="number">0</span> || m &gt; n)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="number">1l</span>l * Fac[n] * invFac[n - m] % mod);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; <span class="comment">// namespace math</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> math;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">0</span>, f = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">char</span> c = getchar();</span><br><span class="line">    <span class="keyword">while</span> (c &lt; <span class="string">'0'</span> || c &gt; <span class="string">'9'</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="string">'-'</span>)</span><br><span class="line">            f = <span class="number">-1</span>;</span><br><span class="line">        c = getchar();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>)</span><br><span class="line">        x = (x &lt;&lt; <span class="number">1</span>) + (x &lt;&lt; <span class="number">3</span>) + c - <span class="string">'0'</span>, c = getchar();</span><br><span class="line">    <span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = <span class="built_in">read</span>();</span><br><span class="line">    Finit(n);</span><br><span class="line">    vector&lt;int&gt; a(n + 1), mx(n + 1, n + 1), dp(n + 1);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        a[i] = <span class="built_in">read</span>();</span><br><span class="line">    sort(<span class="number">1</span> + a.<span class="built_in">begin</span>(), a.<span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">2</span> * a[j] &lt;= a[i])</span><br><span class="line">                mx[i] = j;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    mx[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">    dp[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">2</span> * a[j] &lt;= a[i])</span><br><span class="line">                dp[i] = inc(dp[i], <span class="number">1l</span>l * dp[j] * A(n - <span class="number">2</span> - mx[j], mx[i] - mx[j] - <span class="number">1</span>) % mod);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; (mx[n] == n - <span class="number">1</span> ? dp[n] : <span class="number">0</span>) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>  </details>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å°†å…ƒç´ é‡æ–°æ’åˆ—ï¼Œè¯¢é—®ä¸å‡ºç°$y\leq 2x\leq 4y$, $y$=ä¹‹å‰æœ€å¤§å€¼ã€‚&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="dp" scheme="http://yoursite.com/tags/dp/"/>
    
  </entry>
  
  <entry>
    <title>CF1436E Complicated Computations</title>
    <link href="http://yoursite.com/2020/10/25/CF1436E/"/>
    <id>http://yoursite.com/2020/10/25/CF1436E/</id>
    <published>2020-10-25T02:47:00.000Z</published>
    <updated>2020-10-31T03:11:46.871Z</updated>
    
    <content type="html"><![CDATA[<p>ç»™å®šä¸€ä¸ª$n$ä¸ªå…ƒç´ çš„æ•°åˆ— $a$ï¼Œæ±‚ $a$ æ‰€æœ‰éç©ºå­åºåˆ—çš„ $MEX$ æ‰€æ„æˆçš„æ•°åˆ—çš„ $MEX$ã€‚<br><a id="more"></a><br>é¦–å…ˆå¯¹äº$[1,n]$çš„æ•°åˆ—æ¥è¯´å‡ºç°çš„$mex$ä¸º$x$ã€‚</p><p>ä¹‹åæ‰€æœ‰åŒºé—´å‡ºç°çš„$mex\leq x$ï¼Œå¹¶ä¸”éƒ½æ˜¯$mex&lt; x,mex=a_t$ã€‚ï¼ˆå¦‚æœå‡ºç°åˆ«çš„æ•°åˆå°ï¼Œé‚£ä¹ˆä¸€å®š$=x$ã€‚</p><p>åªéœ€è¦åˆ¤æ–­$a_i$ï¼Œæ˜¯å¦æ˜¯åŒºé—´$mex$ï¼Œæ˜¾ç„¶$(pre[i],i]$ï¼Œæ‰€æœ‰$a_j<a_i$æœ€å¤§çš„ä¸‹æ ‡çš„æœ€å°å€¼$>pre[i]$å³å¯ã€‚è¿™ä¸ªçº¿æ®µæ ‘æˆ–è€…æ ‘çŠ¶æ•°ç»„å³å¯ã€‚</p><ul><li>é¦–å…ˆéœ€è¦åˆ¤æ–­æ•´ä½“çš„$mex$</li><li>ç”±äºä¸å¯æè¿°åŸå› $1$éœ€è¦ç‰¹åˆ¤ã€‚</li></ul><details>  <summary>ä»£ç </summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pii pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk make_pair</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">0</span>, f = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">char</span> c = getchar();</span><br><span class="line">    <span class="keyword">while</span> (c &lt; <span class="string">'0'</span> || c &gt; <span class="string">'9'</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="string">'-'</span>)</span><br><span class="line">            f = <span class="number">-1</span>;</span><br><span class="line">        c = getchar();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>)</span><br><span class="line">        x = (x &lt;&lt; <span class="number">1</span>) + (x &lt;&lt; <span class="number">3</span>) + c - <span class="string">'0'</span>, c = getchar();</span><br><span class="line">    <span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Fenwick</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; a;</span><br><span class="line">    Fenwick(<span class="keyword">int</span> c)</span><br><span class="line">    &#123;</span><br><span class="line">        n = c - <span class="number">1</span>;</span><br><span class="line">        a.resize(n + <span class="number">1</span>, n);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> v)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x &lt;= <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = x; i &lt;= n; i += i &amp; -i)</span><br><span class="line">            <span class="keyword">if</span> (v &lt; a[i])</span><br><span class="line">                a[i] = v;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> res = n;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = x; i; i &amp;= i - <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">if</span> (a[i] &lt; res)</span><br><span class="line">                res = a[i];</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = <span class="built_in">read</span>();</span><br><span class="line">    <span class="function">Fenwick <span class="title">t</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">    vector&lt;int&gt; a(n + 2), pre(n + 2), lst(n + 2), vis(n + 3);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        a[i] = <span class="built_in">read</span>();</span><br><span class="line">        <span class="keyword">if</span> (a[i] != <span class="number">1</span>)</span><br><span class="line">            vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        lst[i] = pre[a[i]];</span><br><span class="line">        pre[a[i]] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        t.update(i, pre[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n + <span class="number">1</span>; i++)</span><br><span class="line">        <span class="keyword">if</span> (t.query(i - <span class="number">1</span>) &gt; pre[i])</span><br><span class="line">            vis[i] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">1</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (a[i] != <span class="number">1</span> &amp;&amp; t.query(a[i] - <span class="number">1</span>) &gt; lst[i])</span><br><span class="line">        &#123;</span><br><span class="line">            vis[a[i]] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        t.update(a[i], lst[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n + <span class="number">2</span>; i++)</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; i &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>  </details>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç»™å®šä¸€ä¸ª$n$ä¸ªå…ƒç´ çš„æ•°åˆ— $a$ï¼Œæ±‚ $a$ æ‰€æœ‰éç©ºå­åºåˆ—çš„ $MEX$ æ‰€æ„æˆçš„æ•°åˆ—çš„ $MEX$ã€‚&lt;br&gt;
    
    </summary>
    
    
    
      <category term="çº¿æ®µæ ‘" scheme="http://yoursite.com/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>CF1038F Wrap Around</title>
    <link href="http://yoursite.com/2020/10/25/CF1038F/"/>
    <id>http://yoursite.com/2020/10/25/CF1038F/</id>
    <published>2020-10-25T02:47:00.000Z</published>
    <updated>2020-11-28T07:44:35.218Z</updated>
    
    <content type="html"><![CDATA[<p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²$S$ï¼ŒåªåŒ…å«$â€™0â€™$å’Œ$â€™1â€™$ä¸¤ä¸ªå­—ç¬¦ï¼Œæ±‚æœ‰å¤šå°‘é•¿åº¦ä¸º$n$çš„å­—ç¬¦ä¸²$T$ï¼Œæ»¡è¶³ä»¥$T$ä¸ºå¾ªç¯èŠ‚çš„æ— é™å¾ªç¯å­—ç¬¦ä¸²åŒ…å«$S$ã€‚ æ³¨æ„ï¼Œå“ªæ€•åœ¨å¾ªç¯åç›¸åŒï¼Œå†™å‡ºæ¥ä¸åŒçš„å­—ç¬¦ä¸²$T$ä»ç®—ä¸åŒçš„å­—ç¬¦ä¸²$T$ã€‚ä¾‹å¦‚$10$å’Œ$01$ç®—ä¸åŒçš„å­—ç¬¦ä¸²$T$ã€‚</p><a id="more"></a><p>æ­£ç€è¦è€ƒè™‘å¾ªç¯å¥½å‡ æ¬¡ï¼Œå°±å¾ˆéº»çƒ¦ã€‚</p><p>æ­£éš¾åˆ™åï¼Œæˆ‘ä»¬éœ€è¦çš„ä¸åŒ…å«ï¼Œåªéœ€è¦å¤´å°¾ç›¸è¿ä¸åŒ…å«å³å¯ä¸åŒ…å«ã€‚</p><p>æšä¸¾å‰ç¼€å·²ç»åŒ¹é…åˆ°äº†$S$çš„å‰$[0,|S|),suf$,$dp[k][i][j]$è¡¨ç¤ºä»å·²ç»æ„é€ åˆ°åœ°$k$ä¸ªå•è¯ï¼Œå¹¶ä¸”ä»å·²ç»æœ‰çš„å‰ç¼€åŒ¹é…åˆ°$j$,åŸæœ¬åŒ¹é…åˆ°äº†$i$ã€‚æœ€åæˆ‘è¦ä¿è¯åŒ¹é…åˆ°åŸæœ¬åŒ¹é…åˆ°äº†$suf$å³åç¼€æœ‰$suf$,ç­”æ¡ˆæ˜¯$\sum_{i} dp[n][suf][i]$ã€‚</p><ul><li>è¿™é‡Œé—®é¢˜å°±æ˜¯æ­£éš¾åˆ™åã€‚ä¸èƒ½åŒ¹é…æ”¾åˆ°ACè‡ªåŠ¨æœºä¸Šå°±æ˜¯ä¸è·‘æœ€åé‚£ä¸ªç‚¹ï¼Œåˆå› ä¸ºæ˜¯å¾ªç¯ï¼Œæˆ‘ä»¬ä¸ºäº†ä¿è¯è¿èµ·æ¥ä¸æåˆ°ï¼Œæ‰€ä»¥å°±éœ€è¦é™åˆ¶å‰åç¼€ï¼Œä¸ç„¶éš¾ä»¥ç»Ÿè®¡ã€‚</li></ul><details>  <summary>ä»£ç </summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pii pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">40</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N_AC = <span class="number">2e3</span>;</span><br><span class="line"></span><br><span class="line">ll dp[N][N][N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ACAM</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> scnt;</span><br><span class="line">    <span class="keyword">int</span> nxt[N_AC][<span class="number">2</span>], fail[N_AC];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> root;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">Newnode</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> pos = ++scnt;</span><br><span class="line">        fail[pos] = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">memset</span>(nxt[pos], <span class="number">0</span>, <span class="keyword">sizeof</span>(nxt[pos]));</span><br><span class="line">        <span class="keyword">return</span> pos;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">char</span> *t)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> len = <span class="built_in">strlen</span>(t);</span><br><span class="line">        <span class="keyword">int</span> tmp = root;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> id = t[i] - <span class="string">'0'</span>;</span><br><span class="line">            <span class="keyword">if</span> (!nxt[tmp][id])</span><br><span class="line">                nxt[tmp][id] = Newnode();</span><br><span class="line">            tmp = nxt[tmp][id];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> tmp = nxt[root][i];</span><br><span class="line">            <span class="keyword">if</span> (tmp)</span><br><span class="line">            &#123;</span><br><span class="line">                q.push(tmp);</span><br><span class="line">                fail[tmp] = root;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (!q.empty())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> x = q.front();</span><br><span class="line">            q.pop();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">int</span> tmp = nxt[x][i];</span><br><span class="line">                <span class="keyword">if</span> (tmp)</span><br><span class="line">                &#123;</span><br><span class="line">                    q.push(tmp);</span><br><span class="line">                    fail[tmp] = nxt[fail[x]][i];</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    nxt[x][i] = nxt[fail[x]][i];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">solve</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ll ans = <span class="number">1l</span>l &lt;&lt; n;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; scnt; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">memset</span>(dp, <span class="number">0</span>, <span class="keyword">sizeof</span>(dp));</span><br><span class="line">            dp[<span class="number">0</span>][<span class="number">0</span>][i] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">0</span>; x &lt; scnt; x++)</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> y = <span class="number">0</span>; y &lt; scnt; y++)</span><br><span class="line">                        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">2</span>; k++)</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="keyword">int</span> a = nxt[x][k], b = nxt[y][k];</span><br><span class="line">                            <span class="keyword">if</span> (a == scnt || b == scnt)</span><br><span class="line">                                <span class="keyword">continue</span>;</span><br><span class="line">                            dp[j + <span class="number">1</span>][a][b] += dp[j][x][y];</span><br><span class="line">                        &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; scnt; j++)</span><br><span class="line">                ans -= dp[n][i][j];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; t;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> s[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);</span><br><span class="line">    t.insert(s);</span><br><span class="line">    t.build();</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; t.solve(n) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>  </details>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²$S$ï¼ŒåªåŒ…å«$â€™0â€™$å’Œ$â€™1â€™$ä¸¤ä¸ªå­—ç¬¦ï¼Œæ±‚æœ‰å¤šå°‘é•¿åº¦ä¸º$n$çš„å­—ç¬¦ä¸²$T$ï¼Œæ»¡è¶³ä»¥$T$ä¸ºå¾ªç¯èŠ‚çš„æ— é™å¾ªç¯å­—ç¬¦ä¸²åŒ…å«$S$ã€‚ æ³¨æ„ï¼Œå“ªæ€•åœ¨å¾ªç¯åç›¸åŒï¼Œå†™å‡ºæ¥ä¸åŒçš„å­—ç¬¦ä¸²$T$ä»ç®—ä¸åŒçš„å­—ç¬¦ä¸²$T$ã€‚ä¾‹å¦‚$10$å’Œ$01$ç®—ä¸åŒçš„å­—ç¬¦ä¸²$T$ã€‚&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="ACè‡ªåŠ¨æœº" scheme="http://yoursite.com/tags/AC%E8%87%AA%E5%8A%A8%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>CF1065E Side Transmutations</title>
    <link href="http://yoursite.com/2020/10/24/CF1065E/"/>
    <id>http://yoursite.com/2020/10/24/CF1065E/</id>
    <published>2020-10-24T02:47:00.000Z</published>
    <updated>2020-11-01T16:18:14.725Z</updated>
    
    <content type="html"><![CDATA[<p>ç»™ä¸ªå­—ç¬¦ä¸²å¯ä»¥$b_i$çš„å‰åç¼€å€’ç½®å¹¶äº¤æ¢ï¼Œå¦‚æœç›¸åŒè¡¨ç¤ºæœ¬è´¨ä¸€æ ·ã€‚è¯¢é—®æœ‰å¤šå°‘æœ¬è´¨ä¸åŒçš„ä¸²ã€‚</p><a id="more"></a><p>å·®åˆ†ä¸€ä¸‹å‘ç°å¯ä»¥ç»„æˆ$2^m$ç§å˜æ¢çš„æ–¹æ³•ã€‚</p><p>æ ¹æ®Burnsideå¼•ç†ï¼Œç­‰ä»·ç±»çš„ä¸ªæ•°ç­‰äºæ‰€æœ‰ç½®æ¢ä¸åŠ¨ç‚¹ä¸ªæ•°çš„å¹³å‡å€¼</p><script type="math/tex; mode=display">ans= \frac{1}{âˆ£Gâˆ£}\sum_{gâˆˆG} A_g</script><p>æ¯”å¦‚$1,3,5$ï¼Œå…¶å®å°±æ˜¯$[0,1],[2.3],[4,5]$è¿™ä¸‰ä¸ªçš„ç»„åˆã€‚</p><p>å¯¹äºæ€»é•¿åº¦ä¸º$len$çš„å˜æ¢ï¼Œåº”è¯¥æ˜¯$A^{n-len}$,$len$éƒ¨åˆ†å¯¹åº”çš„æ¯ä¸€ä½ä¸å˜ã€‚</p><p>ç­”æ¡ˆå°±æ˜¯$\frac{1}{2^m}\sum A^n(\frac{1}{A^{len_1}}+\frac{1}{A^{len_2}}â€¦)$</p><p>æ‹¬å·ç›´æ¥å¥—è·¯ç”Ÿæˆå‡½æ•°$\prod (1+\frac{1}{A^{d_i}})$</p><p><details><br>  <summary>ä»£ç </summary></p><p>```c++</p><h1 id="include"><a href="#include" class="headerlink" title="include "></a>include <bits/stdc++.h></h1><p>using namespace std;<br>typedef long long ll;</p><h1 id="define-pii-pair"><a href="#define-pii-pair" class="headerlink" title="define pii pair"></a>define pii pair<int, int></h1><h1 id="define-mk-make-pair"><a href="#define-mk-make-pair" class="headerlink" title="define mk make_pair"></a>define mk make_pair</h1><p>const int N = 1e6 + 10;<br>const int mod = 998244353;<br>namespace math<br>{<br>    int inc(int x, int y) { return (x + y &gt;= mod) ? (x + y - mod) : (x + y); }<br>    int del(int x, int y) { return (x - y &lt; 0) ? (x - y + mod) : (x - y); }<br>    int gcd(int a, int b)<br>    {<br>        return b == 0 ? a : gcd(b, a % b);<br>    }<br>    int qpow(int a, int x, int mo)<br>    {<br>        int res = 1;<br>        while (x)<br>        {<br>            if (x &amp; 1)<br>                res = 1ll <em> res </em> a % mod;<br>            a = 1ll <em> a </em> a % mod;<br>            x &gt;&gt;= 1;<br>        }<br>        return res;<br>    }<br>    int Fac[N], invFac[N];<br>    void Finit(int n)<br>    {<br>        Fac[0] = 1;<br>        invFac[0] = 1;<br>        for (int i = 1; i &lt;= n; i++)<br>            Fac[i] = 1ll <em> Fac[i - 1] </em> i % mod;<br>        invFac[n] = qpow(Fac[n], mod - 2, mod);<br>        for (int i = n - 1; i &gt;= 1; iâ€”)<br>            invFac[i] = 1ll <em> invFac[i + 1] </em> (i + 1) % mod;<br>    }<br>    int C(int n, int m)<br>    {<br>        if (m == 0)<br>            return 1;<br>        if (n &lt; m || m &lt; 0)<br>            return 0;</p><pre><code>    return (int)(1ll * Fac[n] * invFac[m] % mod * invFac[n - m] % mod);}</code></pre><p>} // namespace math</p><p>using namespace math;</p><p>int read()<br>{<br>    int x = 0, f = 1;<br>    char c = getchar();<br>    while (c &lt; â€˜0â€™ || c &gt; â€˜9â€™)<br>    {<br>        if (c == â€˜-â€˜)<br>            f = -1;<br>        c = getchar();<br>    }<br>    while (c &gt;= â€˜0â€™ &amp;&amp; c &lt;= â€˜9â€™)<br>        x = (x &lt;&lt; 1) + (x &lt;&lt; 3) + c - â€˜0â€™, c = getchar();<br>    return x * f;<br>}<br>int main()<br>{</p><pre><code>int n = read(), m = read(), A = read();int invA = qpow(A, mod - 2, mod);int inv2 = qpow(2, mod - 2, mod);int res = 1;vector&lt;int&gt; a(m + 1);for (int i = 1; i &lt;= m; i++)    a[i] = read();for (int i = 1; i &lt;= m; i++){    res = 1ll * res * (1 + qpow(invA, a[i] - a[i - 1], mod)) % mod;}cout    &lt;&lt; 1ll * res * qpow(inv2, m, mod) % mod * qpow(A, n, mod) % mod &lt;&lt; endl;</code></pre><p>}</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç»™ä¸ªå­—ç¬¦ä¸²å¯ä»¥$b_i$çš„å‰åç¼€å€’ç½®å¹¶äº¤æ¢ï¼Œå¦‚æœç›¸åŒè¡¨ç¤ºæœ¬è´¨ä¸€æ ·ã€‚è¯¢é—®æœ‰å¤šå°‘æœ¬è´¨ä¸åŒçš„ä¸²ã€‚&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="ç½®æ¢ç¾¤" scheme="http://yoursite.com/tags/%E7%BD%AE%E6%8D%A2%E7%BE%A4/"/>
    
  </entry>
  
  <entry>
    <title>2019ICPCå—äº¬ç°åœºèµ› I. Washing clothes ï¼ˆè´ªå¿ƒï¼‰</title>
    <link href="http://yoursite.com/2020/10/20/Nanjing2019I/"/>
    <id>http://yoursite.com/2020/10/20/Nanjing2019I/</id>
    <published>2020-10-20T02:47:00.000Z</published>
    <updated>2020-10-21T06:42:36.653Z</updated>
    
    <content type="html"><![CDATA[<p>$n&lt;=10^6$ä¸ªäººæ´—è¡£æœï¼Œç¬¬$i$ä¸ªäººçš„åˆ°è¾¾æ—¶é—´ä¸º$(0\leq t\leq 10^9)$ï¼Œ</p><p>æœ‰ä¸€å°æ´—è¡£æœºï¼ŒåŒæ—¶åªèƒ½æ´—ä¸€ä»¶è¡£æœï¼ŒèŠ±è´¹çš„æ—¶é—´ä¸º$x$ï¼Œ</p><p>æ¯ä¸ªäººéƒ½å¯ä»¥æ‰‹æ´—è¡£æœï¼Œå¤šä¸ªäººå¯ä»¥åŒæ—¶æ‰‹æ´—è¡£æœï¼ŒèŠ±è´¹çš„æ—¶é—´ä¸º$y$ï¼Œ</p><p>å¯¹äº$x\in[1,y]$çš„æ¯ä¸ª$x$ï¼Œè¾“å‡ºèƒ½è®©$n$ä¸ªäººéƒ½èƒ½æ´—å®Œè¡£æœæ‰€éœ€èŠ±è´¹çš„æœ€å°æ—¶é—´<br><a id="more"></a></p><p>æ‰¾è§„å¾‹ï¼Œå¯ä»¥çŸ¥é“ä¸€å®šæ˜¯å‰ä¸€æ®µæ—¶é—´æ‰‹æ´—ï¼Œåä¸€æ®µæœºå™¨æ´—ã€‚</p><p>$ans_x=\min\sum_{i}^n \max (t_i+y,\max \sum(t_{j}+(n-j+1)x))$</p><p>å¦‚æœè¿™æ ·ç»´æŠ¤å°±æˆäº†$O(n^2\log n)$</p><p>å•ç‹¬çœ‹ä¸€ä¸ª$ans_x$ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯ä¸ªå‡¸å‡½æ•°ã€‚ä¸€ä¸ªå¢ï¼Œä¸€ä¸ªå‡ã€‚</p><p>$ans_y$æ˜¯æœ€ä¼˜è§£æ˜¯$i=y$æ—¶ï¼Œéšç€$x$å‡å°ï¼Œæœ€ä¼˜$i$åœ¨å‡å°ï¼Œæ­¤æ—¶å»ºè®®ç”»å‡½æ•°å›¾å¯ä»¥æ¸…æ¥šçŸ¥é“ä¸ºå•¥ã€‚</p><details>  <summary>ä»£ç </summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pii pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk make_pair</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">0</span>, f = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">char</span> c = getchar();</span><br><span class="line">    <span class="keyword">while</span> (c &lt; <span class="string">'0'</span> || c &gt; <span class="string">'9'</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="string">'-'</span>)</span><br><span class="line">            f = <span class="number">-1</span>;</span><br><span class="line">        c = getchar();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>)</span><br><span class="line">        x = (x &lt;&lt; <span class="number">1</span>) + (x &lt;&lt; <span class="number">3</span>) + c - <span class="string">'0'</span>, c = getchar();</span><br><span class="line">    <span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">lcTree</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"></span><br><span class="line">    ll k[N], b[N];</span><br><span class="line">    <span class="keyword">int</span> tag[N &lt;&lt; <span class="number">2</span>], scnt;</span><br><span class="line">    <span class="keyword">int</span> MAX;</span><br><span class="line">    <span class="function">ll <span class="title">f</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> id)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x * k[id] + b[id];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> pos, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        tag[pos] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (l == r)</span><br><span class="line">        &#123;</span><br><span class="line">            scnt = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        build(pos &lt;&lt; <span class="number">1</span>, l, mid);</span><br><span class="line">        build(pos &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// void insertLine(int x0, int y0, int x1, int y1)</span></span><br><span class="line">    <span class="comment">// &#123;</span></span><br><span class="line">    <span class="comment">//     if (x0 &gt; x1)</span></span><br><span class="line">    <span class="comment">//         swap(x0, x1), swap(y0, y1);</span></span><br><span class="line">    <span class="comment">//     if (x0 == x1 &amp;&amp; y0 &gt; y1)</span></span><br><span class="line">    <span class="comment">//         swap(y0, y1);</span></span><br><span class="line">    <span class="comment">//     ++scnt;</span></span><br><span class="line">    <span class="comment">//     if (x0 == x1)</span></span><br><span class="line">    <span class="comment">//     &#123;</span></span><br><span class="line">    <span class="comment">//         k[scnt] = 0;</span></span><br><span class="line">    <span class="comment">//         b[scnt] = y1;</span></span><br><span class="line">    <span class="comment">//     &#125;</span></span><br><span class="line">    <span class="comment">//     else</span></span><br><span class="line">    <span class="comment">//     &#123;</span></span><br><span class="line">    <span class="comment">//         k[scnt] = 1.00 * (y1 - y0) / (x1 - x0);</span></span><br><span class="line">    <span class="comment">//         b[scnt] = (int)(y1) - (int)(x1)*k[scnt];</span></span><br><span class="line">    <span class="comment">//     &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//     update(scnt, x0, x1, 1, 1, N);</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insertKB</span><span class="params">(ll kt, ll bt)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ++scnt;</span><br><span class="line">        k[scnt] = kt;</span><br><span class="line">        b[scnt] = bt;</span><br><span class="line">        <span class="comment">//cout &lt;&lt; x0 &lt;&lt; " " &lt;&lt; x1 &lt;&lt; "----" &lt;&lt; k[scnt] &lt;&lt; " " &lt;&lt; b[scnt] &lt;&lt; endl;</span></span><br><span class="line">        update(scnt, <span class="number">1</span>, MAX, <span class="number">1</span>, <span class="number">1</span>, MAX);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> ql, <span class="keyword">int</span> qr, <span class="keyword">int</span> pos, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr)</span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (!tag[pos])</span><br><span class="line">            &#123;</span><br><span class="line">                tag[pos] = id;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            ll vl = f(l, tag[pos]), vr = f(r, tag[pos]);</span><br><span class="line">            ll nl = f(l, id), nr = f(r, id);</span><br><span class="line">            <span class="keyword">if</span> (vl &gt;= nl &amp;&amp; vr &gt;= nr)</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (vl &lt;= nl &amp;&amp; vr &lt;= nr)</span><br><span class="line">            &#123;</span><br><span class="line">                tag[pos] = id;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (ql &lt;= mid)</span><br><span class="line">            update(id, ql, qr, pos &lt;&lt; <span class="number">1</span>, l, mid);</span><br><span class="line">        <span class="keyword">if</span> (qr &gt; mid)</span><br><span class="line">            update(id, ql, qr, pos &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">query</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> pos, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ll res = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (tag[pos])</span><br><span class="line">            res = <span class="built_in">max</span>(res, f(x, tag[pos]));</span><br><span class="line">        <span class="keyword">if</span> (l == r)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> res;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (x &lt;= mid)</span><br><span class="line">            res = <span class="built_in">max</span>(res, query(x, pos &lt;&lt; <span class="number">1</span>, l, mid));</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            res = <span class="built_in">max</span>(res, query(x, pos &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r));</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; t;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, y;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;n, &amp;y) != EOF)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="built_in">vector</span>&lt;ll&gt; <span class="title">ti</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">        <span class="function"><span class="built_in">vector</span>&lt;ll&gt; <span class="title">ans</span><span class="params">(y + <span class="number">1</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            ti[i] = <span class="built_in">read</span>();</span><br><span class="line">        ti[<span class="number">0</span>] = -y;</span><br><span class="line">        sort(ti.<span class="built_in">begin</span>() + <span class="number">1</span>, ti.<span class="built_in">end</span>());</span><br><span class="line">        t.MAX = y;</span><br><span class="line"></span><br><span class="line">        t.build(<span class="number">1</span>, <span class="number">1</span>, y);</span><br><span class="line">        <span class="keyword">int</span> pos = n;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> x = y; x &gt;= <span class="number">1</span>; x--)</span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (pos &gt;= <span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                ll curval = <span class="built_in">max</span>(ti[pos] + y, t.query(x, <span class="number">1</span>, <span class="number">1</span>, y));</span><br><span class="line">                ll nxtval = <span class="built_in">max</span>(ti[pos - <span class="number">1</span>] + y, <span class="built_in">max</span>(t.query(x, <span class="number">1</span>, <span class="number">1</span>, y), ti[pos] + <span class="number">1l</span>l * x * (n - pos + <span class="number">1</span>)));</span><br><span class="line">                <span class="keyword">if</span> (nxtval &lt;= curval)</span><br><span class="line">                &#123;</span><br><span class="line">                    t.insertKB((n - pos + <span class="number">1</span>), ti[pos]);</span><br><span class="line">                    pos--;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//cout &lt;&lt; pos &lt;&lt; endl;</span></span><br><span class="line">            ans[x] = <span class="built_in">max</span>(ti[pos] + y, t.query(x, <span class="number">1</span>, <span class="number">1</span>, y));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= y; i++)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%lld%s"</span>, ans[i], i == y ? <span class="string">"\n"</span> : <span class="string">" "</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>  </details>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;$n&amp;lt;=10^6$ä¸ªäººæ´—è¡£æœï¼Œç¬¬$i$ä¸ªäººçš„åˆ°è¾¾æ—¶é—´ä¸º$(0\leq t\leq 10^9)$ï¼Œ&lt;/p&gt;
&lt;p&gt;æœ‰ä¸€å°æ´—è¡£æœºï¼ŒåŒæ—¶åªèƒ½æ´—ä¸€ä»¶è¡£æœï¼ŒèŠ±è´¹çš„æ—¶é—´ä¸º$x$ï¼Œ&lt;/p&gt;
&lt;p&gt;æ¯ä¸ªäººéƒ½å¯ä»¥æ‰‹æ´—è¡£æœï¼Œå¤šä¸ªäººå¯ä»¥åŒæ—¶æ‰‹æ´—è¡£æœï¼ŒèŠ±è´¹çš„æ—¶é—´ä¸º$y$ï¼Œ&lt;/p&gt;
&lt;p&gt;å¯¹äº$x\in[1,y]$çš„æ¯ä¸ª$x$ï¼Œè¾“å‡ºèƒ½è®©$n$ä¸ªäººéƒ½èƒ½æ´—å®Œè¡£æœæ‰€éœ€èŠ±è´¹çš„æœ€å°æ—¶é—´&lt;br&gt;
    
    </summary>
    
    
    
      <category term="æè¶…çº¿æ®µæ ‘" scheme="http://yoursite.com/tags/%E6%9D%8E%E8%B6%85%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>P2423 [HEOI2012]æœ‹å‹åœˆ</title>
    <link href="http://yoursite.com/2020/10/15/P2423/"/>
    <id>http://yoursite.com/2020/10/15/P2423/</id>
    <published>2020-10-15T02:47:00.000Z</published>
    <updated>2020-10-20T08:54:39.245Z</updated>
    
    <content type="html"><![CDATA[<p>Aå›½ï¼šæ¯ä¸ªäººéƒ½æœ‰ä¸€ä¸ªå‹å–„å€¼ï¼Œå½“ä¸¤ä¸ªAå›½äººçš„å‹å–„å€¼ $a,b$ï¼Œå¦‚æœ $a\text{ xor}\text{ }b \bmod 2=1$ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªäººéƒ½æ˜¯æœ‹å‹ï¼Œå¦åˆ™ä¸æ˜¯ï¼›</p><p>Bå›½ï¼šæ¯ä¸ªäººéƒ½æœ‰ä¸€ä¸ªå‹å–„å€¼ï¼Œå½“ä¸¤ä¸ªBå›½äººçš„å‹å–„å€¼ $a,b$ï¼Œå¦‚æœ $a\text{ xor}\text{ }b \bmod 2=0$ æˆ–è€…$a\text{ }or\text{ }b$ åŒ–æˆäºŒè¿›åˆ¶æœ‰å¥‡æ•°ä¸ª $1$ï¼Œé‚£ä¹ˆä¸¤ä¸ªäººæ˜¯æœ‹å‹ï¼Œå¦åˆ™ä¸æ˜¯æœ‹å‹ã€‚</p><p>æ±‚æœ€å¤§å›¢ï¼Œç»™$A,B$çš„å…³ç³»ã€‚<br><a id="more"></a></p><p>$A$å›½æ˜¾ç„¶$0,1,2$äººã€‚</p><p>ç„¶åè€ƒè™‘å¦‚ä½•è®¡ç®—æšä¸¾åˆ°çš„$B$å›½çš„æœ€å¤§å›¢ã€‚</p><p>å¯ä»¥çœ‹å‡º$B$çš„è¡¥å›¾å°±æ˜¯ä¸€ä¸ªåˆ†å¥‡å¶çš„äºŒåˆ†å›¾ã€‚</p><p>äºŒåˆ†å›¾çš„æœ€å¤§å›¢=è¡¥å›¾çš„æœ€å¤§ç‹¬ç«‹é›†ã€‚ï¼Œæœ€å¤§ç‹¬ç«‹é›†=æ‰€æœ‰é¡¶ç‚¹æ•°-æœ€å°é¡¶ç‚¹è¦†ç›–ï¼Œ</p><p>è·‘ä¸ªæœ€å¤§æµå³å¯ã€‚æˆ–è€…æ—¶é—´æˆ³åŒˆç‰™åˆ©ã€‚å„ç§å‰ªæåŠ ä¸€åŠ å¾ˆå¿«çš„ã€‚</p><details>  <summary>ä»£ç </summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pii pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk make_pair</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">1e9</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to, w, nxt;</span><br><span class="line">    Edge() &#123;&#125;</span><br><span class="line">    Edge(<span class="keyword">int</span> v, <span class="keyword">int</span> c, <span class="keyword">int</span> t) : to(v), w(c), nxt(t) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> EN = <span class="number">2e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> EM = <span class="number">2e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Dinic</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"></span><br><span class="line">    Edge e[EM &lt;&lt; <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">int</span> head[EN], scnt, d[EN], cur[EN];</span><br><span class="line">    pii pre[EN];</span><br><span class="line">    <span class="keyword">int</span> maxn;</span><br><span class="line">    Dinic() &#123; scnt = <span class="number">1</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        e[++scnt] = Edge(v, w, head[u]);</span><br><span class="line">        head[u] = scnt;</span><br><span class="line">        e[++scnt] = Edge(u, <span class="number">0</span>, head[v]);</span><br><span class="line">        head[v] = scnt;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        maxn = n;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// memset(head, 0, sizeof(head));</span></span><br><span class="line">        <span class="comment">// memset(d, 0, sizeof(d));</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= maxn; i++)</span><br><span class="line">            head[i] = d[i] = cur[i] = <span class="number">0</span>, pre[i] = mk(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        scnt = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">bfs</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= maxn; i++)</span><br><span class="line">            d[i] = <span class="number">0</span>;</span><br><span class="line">        q.push(s);</span><br><span class="line">        d[s] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (!q.empty())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> x = q.front();</span><br><span class="line">            q.pop();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = head[x]; i; i = e[i].nxt)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">int</span> to = e[i].to;</span><br><span class="line">                <span class="keyword">if</span> (!d[to] &amp;&amp; e[i].w)</span><br><span class="line">                &#123;</span><br><span class="line">                    d[to] = d[x] + <span class="number">1</span>;</span><br><span class="line">                    q.push(to);</span><br><span class="line">                    <span class="keyword">if</span> (to == t)</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> t, <span class="keyword">int</span> flow)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x == t)</span><br><span class="line">            <span class="keyword">return</span> flow;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = cur[x]; i; i = e[i].nxt)</span><br><span class="line">        &#123;</span><br><span class="line">            cur[x] = i;</span><br><span class="line">            <span class="keyword">int</span> to = e[i].to;</span><br><span class="line">            <span class="keyword">if</span> (d[to] == d[x] + <span class="number">1</span> &amp;&amp; e[i].w)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">int</span> dis = dfs(to, t, <span class="built_in">min</span>(flow, e[i].w));</span><br><span class="line">                <span class="keyword">if</span> (dis)</span><br><span class="line">                &#123;</span><br><span class="line">                    e[i].w -= dis;</span><br><span class="line">                    e[i ^ <span class="number">1</span>].w += dis;</span><br><span class="line">                    flow -= dis;</span><br><span class="line">                    res += dis;</span><br><span class="line">                    <span class="keyword">if</span> (!flow)</span><br><span class="line">                        <span class="keyword">return</span> res;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">Maxflow</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (bfs(s, t))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">memcpy</span>(cur, head, <span class="keyword">sizeof</span>(head));</span><br><span class="line">            ans += dfs(s, t, INF);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; dc;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">0</span>, f = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">char</span> c = getchar();</span><br><span class="line">    <span class="keyword">while</span> (c &lt; <span class="string">'0'</span> || c &gt; <span class="string">'9'</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="string">'-'</span>)</span><br><span class="line">            f = <span class="number">-1</span>;</span><br><span class="line">        c = getchar();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>)</span><br><span class="line">        x = (x &lt;&lt; <span class="number">1</span>) + (x &lt;&lt; <span class="number">3</span>) + c - <span class="string">'0'</span>, c = getchar();</span><br><span class="line">    <span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> a[N], b[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; p[<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> vis[N], id[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;pii&gt; e;</span><br><span class="line"><span class="keyword">int</span> A, B, M, ans;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= B; i++)</span><br><span class="line">        vis[i] = id[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> o : g[x])</span><br><span class="line">        vis[o]++;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> o : g[y])</span><br><span class="line">        vis[o]++;</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= B; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (vis[i] == z)</span><br><span class="line">            id[i] = ++cnt;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//cout &lt;&lt; x &lt;&lt; " " &lt;&lt; y &lt;&lt; " " &lt;&lt; cnt &lt;&lt; endl;</span></span><br><span class="line">    <span class="keyword">if</span> (cnt + z &lt;= ans)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> s = ++cnt, t = ++cnt;</span><br><span class="line">    <span class="comment">//cout &lt;&lt; cnt &lt;&lt; endl;</span></span><br><span class="line">    dc.init(cnt);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> x : p[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">if</span> (id[x])</span><br><span class="line">            dc.addEdge(s, id[x], <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> x : p[<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">if</span> (id[x])</span><br><span class="line">            dc.addEdge(id[x], t, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (pii now : e)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> x = now.first, y = now.second;</span><br><span class="line">        <span class="keyword">if</span> (id[x] == <span class="number">0</span> || id[y] == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        dc.addEdge(id[x], id[y], <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ans = <span class="built_in">max</span>(ans, cnt - <span class="number">2</span> - dc.Maxflow(s, t) + z);</span><br><span class="line">    dc.<span class="built_in">clear</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T = <span class="built_in">read</span>();</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        A = <span class="built_in">read</span>(), B = <span class="built_in">read</span>(), M = <span class="built_in">read</span>();</span><br><span class="line">        ans = <span class="number">0</span>;</span><br><span class="line">        p[<span class="number">0</span>].<span class="built_in">clear</span>(), p[<span class="number">1</span>].<span class="built_in">clear</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= A; i++)</span><br><span class="line">            a[i] = <span class="built_in">read</span>(), g[i].<span class="built_in">clear</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= B; i++)</span><br><span class="line">            b[i] = <span class="built_in">read</span>(), p[b[i] &amp; <span class="number">1</span>].push_back(i);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> x = <span class="built_in">read</span>(), y = <span class="built_in">read</span>();</span><br><span class="line">            g[x].push_back(y);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i : p[<span class="number">0</span>])</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j : p[<span class="number">1</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (!((__builtin_popcount((b[i] | b[j]))) &amp; <span class="number">1</span>))</span><br><span class="line">                    e.push_back(mk(i, j));</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="comment">//solve(1, 2, 2);</span></span><br><span class="line">        solve(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= A; i++)</span><br><span class="line">            solve(i, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= A; i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt;= A; j++)</span><br><span class="line">                <span class="keyword">if</span> ((a[i] ^ a[j]) &amp; <span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line"></span><br><span class="line">                    solve(i, j, <span class="number">2</span>);</span><br><span class="line">                &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>  </details>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Aå›½ï¼šæ¯ä¸ªäººéƒ½æœ‰ä¸€ä¸ªå‹å–„å€¼ï¼Œå½“ä¸¤ä¸ªAå›½äººçš„å‹å–„å€¼ $a,b$ï¼Œå¦‚æœ $a\text{ xor}\text{ }b \bmod 2=1$ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªäººéƒ½æ˜¯æœ‹å‹ï¼Œå¦åˆ™ä¸æ˜¯ï¼›&lt;/p&gt;
&lt;p&gt;Bå›½ï¼šæ¯ä¸ªäººéƒ½æœ‰ä¸€ä¸ªå‹å–„å€¼ï¼Œå½“ä¸¤ä¸ªBå›½äººçš„å‹å–„å€¼ $a,b$ï¼Œå¦‚æœ $a\text{ xor}\text{ }b \bmod 2=0$ æˆ–è€…$a\text{ }or\text{ }b$ åŒ–æˆäºŒè¿›åˆ¶æœ‰å¥‡æ•°ä¸ª $1$ï¼Œé‚£ä¹ˆä¸¤ä¸ªäººæ˜¯æœ‹å‹ï¼Œå¦åˆ™ä¸æ˜¯æœ‹å‹ã€‚&lt;/p&gt;
&lt;p&gt;æ±‚æœ€å¤§å›¢ï¼Œç»™$A,B$çš„å…³ç³»ã€‚&lt;br&gt;
    
    </summary>
    
    
    
      <category term="äºŒåˆ†å›¾" scheme="http://yoursite.com/tags/%E4%BA%8C%E5%88%86%E5%9B%BE/"/>
    
  </entry>
  
  <entry>
    <title>P3731 [HAOI2017]æ–°å‹åŸå¸‚åŒ–</title>
    <link href="http://yoursite.com/2020/10/15/P3731/"/>
    <id>http://yoursite.com/2020/10/15/P3731/</id>
    <published>2020-10-15T02:47:00.000Z</published>
    <updated>2020-10-21T05:15:46.898Z</updated>
    
    <content type="html"><![CDATA[<p>ä¿è¯åŸå›¾è¡¥å›¾æ˜¯ä¸ªäºŒåˆ†å›¾ï¼Œåœ¨åŸå›¾ä¸­åŠ å…¥ä¸€æ¡è¾¹èƒ½ä½¿åŸå›¾æœ€å¤§å›¢æ•°è‡³å°‘åŠ ä¸€çš„è¾¹æœ‰å“ªäº›ã€‚<br><a id="more"></a></p><p>å°±æ˜¯å¯»æ‰¾äºŒåˆ†å›¾å¿…é¡»è¾¹ã€‚</p><p>å¯¹äºè¡¥å›¾ç”¨ç½‘ç»œæµè·‘æœ€å¤§åŒ¹é…ï¼Œæ®‹ä½™ç½‘ç»œå†è·‘$tarjan$ï¼ˆå³æ»¡æµçš„è¾¹ä¸èƒ½èµ°ï¼Œ$tarjan$å¯èµ°åè¾¹ï¼‰</p><ul><li>å¦‚æœå‡ºç°å¢å¹¿ç¯ï¼Œæ˜¾ç„¶å¯ä»¥å°†æµé‡é€‰æ‹©ä¸€ä¸‹ï¼Œå‡ºç°æ–°çš„åŒ¹é…</li></ul><p>å¯¹äºè¡¥å›¾çš„æŸæ¡è¾¹ï¼Œå®ƒæ˜¯å¿…é¡»è¾¹çš„æ¡ä»¶æ˜¯</p><ul><li>ä¸¤ä¸ªç«¯ç‚¹åœ¨ä¸åŒçš„å¼ºè¿é€šåˆ†é‡é‡Œ</li><li>ç½‘ç»œæµçš„æ®‹ä½™ç½‘ç»œé‡Œæ­£è¾¹æµæ»¡</li><li>ä¸æ˜¯æºç‚¹å’Œæ±‡ç‚¹ã€‚</li></ul><details>  <summary>ä»£ç </summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pii pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk make_pair</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">1e9</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">0</span>, f = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">char</span> c = getchar();</span><br><span class="line">    <span class="keyword">while</span> (c &lt; <span class="string">'0'</span> || c &gt; <span class="string">'9'</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="string">'-'</span>)</span><br><span class="line">            f = <span class="number">-1</span>;</span><br><span class="line">        c = getchar();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>)</span><br><span class="line">        x = (x &lt;&lt; <span class="number">1</span>) + (x &lt;&lt; <span class="number">3</span>) + c - <span class="string">'0'</span>, c = getchar();</span><br><span class="line">    <span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to, w, nxt;</span><br><span class="line">    Edge() &#123;&#125;</span><br><span class="line">    Edge(<span class="keyword">int</span> v, <span class="keyword">int</span> c, <span class="keyword">int</span> t) : to(v), w(c), nxt(t) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> EN = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> EM = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Dinic</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"></span><br><span class="line">    Edge e[EM &lt;&lt; <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">int</span> head[EN], scnt, d[EN], cur[EN];</span><br><span class="line">    pii pre[EN];</span><br><span class="line">    Dinic() &#123; scnt = <span class="number">1</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        e[++scnt] = Edge(v, w, head[u]);</span><br><span class="line">        head[u] = scnt;</span><br><span class="line">        e[++scnt] = Edge(u, <span class="number">0</span>, head[v]);</span><br><span class="line">        head[v] = scnt;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">bfs</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">        <span class="built_in">memset</span>(d, <span class="number">0</span>, <span class="keyword">sizeof</span>(d));</span><br><span class="line">        q.push(s);</span><br><span class="line">        d[s] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (!q.empty())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> x = q.front();</span><br><span class="line">            q.pop();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = head[x]; i; i = e[i].nxt)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">int</span> to = e[i].to;</span><br><span class="line">                <span class="keyword">if</span> (!d[to] &amp;&amp; e[i].w)</span><br><span class="line">                &#123;</span><br><span class="line">                    d[to] = d[x] + <span class="number">1</span>;</span><br><span class="line">                    q.push(to);</span><br><span class="line">                    <span class="keyword">if</span> (to == t)</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> t, <span class="keyword">int</span> flow)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x == t)</span><br><span class="line">            <span class="keyword">return</span> flow;</span><br><span class="line">        ll res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = cur[x]; i; i = e[i].nxt)</span><br><span class="line">        &#123;</span><br><span class="line">            cur[x] = i;</span><br><span class="line">            <span class="keyword">int</span> to = e[i].to;</span><br><span class="line">            <span class="keyword">if</span> (d[to] == d[x] + <span class="number">1</span> &amp;&amp; e[i].w)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">int</span> dis = dfs(to, t, <span class="built_in">min</span>(flow, e[i].w));</span><br><span class="line">                <span class="keyword">if</span> (dis)</span><br><span class="line">                &#123;</span><br><span class="line">                    e[i].w -= dis;</span><br><span class="line">                    e[i ^ <span class="number">1</span>].w += dis;</span><br><span class="line">                    flow -= dis;</span><br><span class="line">                    res += dis;</span><br><span class="line">                    <span class="keyword">if</span> (!flow)</span><br><span class="line">                        <span class="keyword">return</span> res;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">Maxflow</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ll ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (bfs(s, t))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">memcpy</span>(cur, head, <span class="keyword">sizeof</span>(head));</span><br><span class="line">            ans += dfs(s, t, INF);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; dc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> tarjan</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g[N];</span><br><span class="line">    <span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt; s;</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    <span class="keyword">int</span> dfn[N], be[N], low[N], ln, vis[N], gcnt;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        g[u].push_back(v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        dfn[x] = low[x] = ++gcnt;</span><br><span class="line">        vis[x] = <span class="number">1</span>;</span><br><span class="line">        s.push(x);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; g[x].<span class="built_in">size</span>(); i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> to = g[x][i];</span><br><span class="line">            <span class="keyword">if</span> (!dfn[to])</span><br><span class="line">            &#123;</span><br><span class="line">                dfs(to);</span><br><span class="line">                low[x] = <span class="built_in">min</span>(low[x], low[to]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (vis[to])</span><br><span class="line">            &#123;</span><br><span class="line">                low[x] = <span class="built_in">min</span>(low[x], dfn[to]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> cur;</span><br><span class="line">        <span class="keyword">if</span> (dfn[x] == low[x])</span><br><span class="line">        &#123;</span><br><span class="line">            ln++;</span><br><span class="line">            <span class="keyword">do</span></span><br><span class="line">            &#123;</span><br><span class="line">                cur = s.top();</span><br><span class="line">                s.pop();</span><br><span class="line">                vis[cur] = <span class="number">0</span>;</span><br><span class="line">                be[cur] = ln;</span><br><span class="line">            &#125; <span class="keyword">while</span> (cur != x);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            <span class="keyword">if</span> (!dfn[i])</span><br><span class="line">                dfs(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="comment">// namespace tarjan</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g[N];</span><br><span class="line"><span class="keyword">int</span> vis[N], col[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> co)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    col[x] = co;</span><br><span class="line">    vis[x] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> to : g[x])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[to])</span><br><span class="line">            dfs(to, co ^ <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = <span class="built_in">read</span>(), m = <span class="built_in">read</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> u = <span class="built_in">read</span>(), v = <span class="built_in">read</span>();</span><br><span class="line">        g[u].push_back(v);</span><br><span class="line">        g[v].push_back(u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])</span><br><span class="line">            dfs(i, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">int</span> s = n + <span class="number">1</span>, t = n + <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!col[i])</span><br><span class="line">            dc.addEdge(s, i, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            dc.addEdge(i, t, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!col[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> to : g[i])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (col[to])</span><br><span class="line">                &#123;</span><br><span class="line"></span><br><span class="line">                    dc.addEdge(i, to, <span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    dc.Maxflow(s, t);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n + <span class="number">2</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = dc.head[i]; j; j = dc.e[j].nxt)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//if (dc.e[j].w == 0)</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (dc.e[j].w == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            tarjan::addEdge(i, dc.e[j].to);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    tarjan::solve(n + <span class="number">2</span>);</span><br><span class="line">    <span class="built_in">vector</span>&lt;pii&gt; ans;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = dc.head[i]; j; j = dc.e[j].nxt)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (dc.e[j].w == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">int</span> to = dc.e[j].to;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (tarjan::be[i] != tarjan::be[to] &amp;&amp; (j % <span class="number">2</span> == <span class="number">0</span>))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (i != s &amp;&amp; to != t &amp;&amp; to != s &amp;&amp; i != t)</span><br><span class="line">                        ans.push_back(&#123;<span class="built_in">min</span>(i, to), <span class="built_in">max</span>(i, to)&#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(ans.<span class="built_in">begin</span>(), ans.<span class="built_in">end</span>());</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans.<span class="built_in">size</span>());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (pii now : ans)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>, now.first, now.second);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>  </details>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¿è¯åŸå›¾è¡¥å›¾æ˜¯ä¸ªäºŒåˆ†å›¾ï¼Œåœ¨åŸå›¾ä¸­åŠ å…¥ä¸€æ¡è¾¹èƒ½ä½¿åŸå›¾æœ€å¤§å›¢æ•°è‡³å°‘åŠ ä¸€çš„è¾¹æœ‰å“ªäº›ã€‚&lt;br&gt;
    
    </summary>
    
    
    
      <category term="äºŒåˆ†å›¾" scheme="http://yoursite.com/tags/%E4%BA%8C%E5%88%86%E5%9B%BE/"/>
    
  </entry>
  
  <entry>
    <title>CF1139E Maximize Mex</title>
    <link href="http://yoursite.com/2020/10/10/CF1139E/"/>
    <id>http://yoursite.com/2020/10/10/CF1139E/</id>
    <published>2020-10-10T02:47:00.000Z</published>
    <updated>2020-10-20T06:50:37.167Z</updated>
    
    <content type="html"><![CDATA[<p>$n$åå­¦ç”Ÿï¼Œ$m$ä¸ªç¤¾å›¢ï¼Œæ¯ä¸ªå­¦ç”Ÿ$i$å±äºç¤¾å›¢$c_i$èƒ½åŠ›å€¼ä¸º$p_i$<br>â€‹    </p><p>æ¯ä¸€å¤©å­¦æ ¡éƒ½è¦ä»å„ç¤¾å›¢é€‰å‡ºä¸€ä¸ªäººç»„æˆé˜Ÿä¼ä½¿æ‰€æœ‰äººçš„$mex$çš„èƒ½åŠ›å€¼æœ€å¤§ï¼Œæ±‚æ¯ä¸€å¤©çš„èƒ½åŠ›å€¼ã€‚</p><p>æ¯å¤©ä¼šæœ‰äººèµ°ã€‚</p><a id="more"></a><p>è€ƒè™‘åŒˆç‰™åˆ©ç®—æ³•ï¼Œå¾—$mex$,ç›¸å½“äºä»$[0,\infty)$å»åŒ¹é…å³å¯ã€‚</p><p>è€ƒè™‘åè¿‡æ¥åŠ ç‚¹ï¼Œåˆ™ç­”æ¡ˆæ˜¯å•è°ƒé€’å¢çš„ï¼Œä¿æŒä¸Šä¸€æ¬¡çš„ç­”æ¡ˆï¼Œä»ä¸Šä¸€æ¬¡å¼€å§‹å³å¯ã€‚</p><p>æ³¨æ„ä½¿ç”¨æ—¶é—´æˆ³ï¼</p><details>  <summary>ä»£ç </summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pii pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk make_pair</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">0</span>, f = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">char</span> c = getchar();</span><br><span class="line">    <span class="keyword">while</span> (c &lt; <span class="string">'0'</span> || c &gt; <span class="string">'9'</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="string">'-'</span>)</span><br><span class="line">            f = <span class="number">-1</span>;</span><br><span class="line">        c = getchar();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>)</span><br><span class="line">        x = (x &lt;&lt; <span class="number">1</span>) + (x &lt;&lt; <span class="number">3</span>) + c - <span class="string">'0'</span>, c = getchar();</span><br><span class="line">    <span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> vis[N], match[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g[N];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> o)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (vis[x] == o)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    vis[x] = o;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> to : g[x])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (match[to] == <span class="number">-1</span> || dfs(match[to], o))</span><br><span class="line">        &#123;</span><br><span class="line">            match[to] = x;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    g[u].push_back(v);</span><br><span class="line">    g[v].push_back(u);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> p[N], c[N], op[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = <span class="built_in">read</span>(), m = <span class="built_in">read</span>();</span><br><span class="line">    <span class="keyword">int</span> M = <span class="number">5000</span>;</span><br><span class="line">    <span class="built_in">memset</span>(match, <span class="number">-1</span>, <span class="keyword">sizeof</span>(match));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        p[i] = <span class="built_in">read</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        c[i] = <span class="built_in">read</span>();</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">v</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="keyword">int</span> d = <span class="built_in">read</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= d; i++)</span><br><span class="line">        op[i] = <span class="built_in">read</span>(),</span><br><span class="line">        v[op[i]] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">if</span> (!v[i])</span><br><span class="line">        &#123;</span><br><span class="line">            addEdge(c[i] + M, p[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">ans</span><span class="params">(d + <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = d; i &gt;= <span class="number">1</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = l; j &lt;= M; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (!dfs(j, ++cnt))</span><br><span class="line">            &#123;</span><br><span class="line">                l = j;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        addEdge(c[op[i]] + M, p[op[i]]);</span><br><span class="line">        ans[i] = l;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= d; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>  </details>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;$n$åå­¦ç”Ÿï¼Œ$m$ä¸ªç¤¾å›¢ï¼Œæ¯ä¸ªå­¦ç”Ÿ$i$å±äºç¤¾å›¢$c_i$èƒ½åŠ›å€¼ä¸º$p_i$&lt;br&gt;â€‹    &lt;/p&gt;
&lt;p&gt;æ¯ä¸€å¤©å­¦æ ¡éƒ½è¦ä»å„ç¤¾å›¢é€‰å‡ºä¸€ä¸ªäººç»„æˆé˜Ÿä¼ä½¿æ‰€æœ‰äººçš„$mex$çš„èƒ½åŠ›å€¼æœ€å¤§ï¼Œæ±‚æ¯ä¸€å¤©çš„èƒ½åŠ›å€¼ã€‚&lt;/p&gt;
&lt;p&gt;æ¯å¤©ä¼šæœ‰äººèµ°ã€‚&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="äºŒåˆ†å›¾" scheme="http://yoursite.com/tags/%E4%BA%8C%E5%88%86%E5%9B%BE/"/>
    
  </entry>
  
  <entry>
    <title>CF1422E Minlexes</title>
    <link href="http://yoursite.com/2020/10/10/CF1422E/"/>
    <id>http://yoursite.com/2020/10/10/CF1422E/</id>
    <published>2020-10-10T02:47:00.000Z</published>
    <updated>2020-10-20T08:30:02.770Z</updated>
    
    <content type="html"><![CDATA[<p>å¯ä»¥åˆ é™¤ç›¸é‚»çš„å…ƒç´ ï¼Œæ±‚æ¯ä¸ªåç¼€çš„å­—å…¸åºæœ€å°<br><a id="more"></a></p><p>éœ€è¦è€å¿ƒåˆ†æã€‚</p><ul><li>aabbï¼Œæ˜¾ç„¶ä¸åˆ </li><li>bbaaï¼Œæ˜¾ç„¶åˆ </li><li>aaabbï¼Œæ˜¾ç„¶ä¸åˆ </li><li>bbbaaï¼Œæ˜¾ç„¶åˆ </li></ul><p>æˆ‘ä»¬éœ€è¦å€’è¿‡æ¥åˆ†æã€‚</p><p>å½’ç±»$s[i]==s[i+1]$</p><ul><li>$s[i]&gt;s[i+1]$ä»¥åŠ$s[i]&lt;s[i+1]$ </li><li>$s[i]=s[i+1]$å°±æ˜¯ç¬¬ä¸€ä¸ªä¸åŒçš„$ch$ä¸$s[i]$çš„å¤§å°ã€‚æ³¨æ„$aaaaabbb$æ˜¯ä¸åˆ ï¼Œ$bbbbbaa$æ˜¯åˆ ã€‚</li><li>æ¯æ¬¡å…ˆç»§æ‰¿ä¸Šä¸€ä¸ªçš„ç¬¬ä¸€ä¸ªä¸åŒçš„$ch$ä¸$s[i]$çš„å¤§å°ï¼Œåªæœ‰æ’å…¥ä¸ç­‰çš„æ—¶å€™å†å»åˆ¤æ–­ï¼Œç¬¬ä¸€ä¸ªä¸åŒçš„$ch$ä¸$s[i]$çš„å¤§å°å…³ç³»ï¼ï¼Œ<strong>ç›¸ç­‰çš„æ—¶å€™å§‹ç»ˆç»§æ‰¿ä¹‹å‰çš„åˆ¤æ–­</strong>ã€‚</li></ul><details>  <summary>ä»£ç </summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pii pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk make_pair</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> s[N];</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> ans[N], suf[N];</span><br><span class="line"><span class="keyword">int</span> le[N];</span><br><span class="line"><span class="keyword">bool</span> z[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">char</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (le[x] == <span class="number">0</span>)</span><br><span class="line">        z[x] = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (c &lt; ans[x][<span class="number">0</span>])</span><br><span class="line">        z[x] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (c &gt; ans[x][<span class="number">0</span>])</span><br><span class="line">        z[x] = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (suf[x].<span class="built_in">size</span>() &lt; <span class="number">2</span>)</span><br><span class="line">        suf[x] = c + suf[x];</span><br><span class="line">    ans[x] = c + ans[x];</span><br><span class="line">    <span class="keyword">if</span> (ans[x].<span class="built_in">size</span>() &gt; <span class="number">10</span>)</span><br><span class="line">        ans[x].pop_back();</span><br><span class="line">    le[x]++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> len = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">    s[len + <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &gt;= <span class="number">1</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (s[i + <span class="number">1</span>] == s[i])</span><br><span class="line">        &#123;</span><br><span class="line">            ans[i] = ans[i + <span class="number">2</span>];</span><br><span class="line">            suf[i] = suf[i + <span class="number">2</span>];</span><br><span class="line">            le[i] = le[i + <span class="number">2</span>];</span><br><span class="line">            z[i] = z[i + <span class="number">2</span>];</span><br><span class="line">            <span class="keyword">if</span> (ans[i].<span class="built_in">size</span>() != <span class="number">0</span> &amp;&amp; ((ans[i][<span class="number">0</span>] &gt; s[i]) || (ans[i][<span class="number">0</span>] == s[i] &amp;&amp; z[i])))</span><br><span class="line">            &#123;</span><br><span class="line"></span><br><span class="line">                add(i, s[i]);</span><br><span class="line">                add(i, s[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            suf[i] = suf[i + <span class="number">1</span>];</span><br><span class="line">            ans[i] = ans[i + <span class="number">1</span>];</span><br><span class="line">            le[i] = le[i + <span class="number">1</span>];</span><br><span class="line">            z[i] = z[i + <span class="number">1</span>];</span><br><span class="line">            add(i, s[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= len; i++)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; le[i] &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">        <span class="keyword">if</span> (le[i] &gt; <span class="number">10</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; ans[i].substr(<span class="number">0</span>, <span class="number">5</span>) &lt;&lt; <span class="string">"..."</span> &lt;&lt; suf[i] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; ans[i] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>  </details>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¯ä»¥åˆ é™¤ç›¸é‚»çš„å…ƒç´ ï¼Œæ±‚æ¯ä¸ªåç¼€çš„å­—å…¸åºæœ€å°&lt;br&gt;
    
    </summary>
    
    
    
      <category term="è´ªå¿ƒ" scheme="http://yoursite.com/tags/%E8%B4%AA%E5%BF%83/"/>
    
  </entry>
  
</feed>
